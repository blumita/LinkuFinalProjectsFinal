import{k as F,a as N,r as m,c as p,o as O,b as l,f as t,e as o,g as f,h as R,t as c,d as S,S as V,V as D,Z as E,P as w,Q as h,x as Q,i as d,O as z}from"#entry";import{u as A}from"./DyClqVU4.js";const I={class:"min-h-screen bg-background"},T={class:"fixed top-0 left-0 right-0 z-40 bg-card border-b border-border"},Z={class:"flex items-center h-12 lg:h-14 px-4 lg:px-8"},G={class:"hidden lg:flex items-center gap-3"},H={class:"bg-primary/10 text-primary px-3 py-1.5 rounded-lg"},J={class:"text-sm font-medium"},K=["disabled"],W={class:"pt-16 lg:pt-20 pb-24 px-4 lg:px-8"},X={class:"max-w-2xl lg:max-w-none mx-auto"},Y={class:"hidden lg:flex items-center gap-3 mb-6"},ee={class:"flex-1 relative"},te={class:"lg:hidden flex items-center justify-between mb-6 bg-card rounded-xl border border-border p-4"},se={class:"flex items-center gap-3"},oe={class:"text-foreground font-bold text-lg"},re=["disabled"],ne={key:0,class:"bg-card rounded-xl border border-border overflow-hidden"},le={class:"divide-y divide-border"},de={key:1,class:"bg-card rounded-xl border border-border overflow-hidden"},ie={class:"divide-y divide-border"},ae={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 items-center"},ue={class:"text-foreground font-medium"},ge={class:"lg:col-span-2"},me={class:"text-foreground font-medium"},ce={class:"text-muted-foreground text-sm font-mono mt-1",dir:"ltr"},ve={class:"hidden lg:flex items-center justify-end gap-2"},pe=["onClick"],fe={key:2,class:"flex items-center justify-center gap-2 mt-6"},xe=["onClick"],be={key:3,class:"text-center py-12"},k=10,ke=F({__name:"QuestionBoxPage",setup(ye){const _=Q(),C=A(),{$axios:j}=N(),u=m(!0),x=m(1),a=m([]),b=m(0),v=m(""),g=m("newest"),$=p(()=>{let r=[...a.value];if(v.value.trim()){const e=v.value.toLowerCase();r=r.filter(s=>s.name.toLowerCase().includes(e)||s.mobile.includes(e))}return g.value==="newest"?r.sort((e,s)=>s.id-e.id):g.value==="oldest"?r.sort((e,s)=>e.id-s.id):g.value==="name"&&r.sort((e,s)=>e.name.localeCompare(s.name,"fa")),r}),M=p(()=>$.value.length),B=p(()=>Math.ceil(M.value/k)),L=p(()=>{const r=(x.value-1)*k,e=r+k;return $.value.slice(r,e)}),U=async()=>{const r=C.defaultCard?.id;if(r){u.value=!0;try{const n=(await j.get(`/card/${r}/questions`,{params:{page:1,perPage:1e3}})).data?.data;n?.items&&(a.value=n.items.map(i=>({id:i.id,name:i.name||i.full_name||"",mobile:i.mobile||i.phone||""})),b.value=n.pagination?.total||a.value.length)}catch{}finally{u.value=!1}}},P=()=>{if(a.value.length===0)return;const e="\uFEFF"+["شناسه,نام,شماره موبایل",...a.value.map(y=>`${y.id},"${y.name}",${y.mobile}`)].join(`
`),s=new Blob([e],{type:"text/csv;charset=utf-8"}),n=window.URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download="جعبه-سوالات.csv",i.click(),window.URL.revokeObjectURL(n)},q=async r=>{if(!confirm("آیا از حذف این پیام اطمینان دارید؟"))return;const e=C.defaultCard?.id;if(e)try{await j.delete(`/card/${e}/questions/${r}`),a.value=a.value.filter(n=>n.id!==r),b.value=a.value.length}catch{alert("خطا در حذف پیام")}};return O(()=>{U()}),(r,e)=>(d(),l("div",I,[t("div",T,[t("div",Z,[t("button",{onClick:e[0]||(e[0]=s=>R(_).back()),class:"flex items-center justify-center w-10 h-10 rounded-lg text-foreground hover:bg-accent transition-colors"},[...e[4]||(e[4]=[t("i",{class:"ti ti-arrow-right text-xl"},null,-1)])]),e[7]||(e[7]=f(' <div class="flex-1 flex items-center justify-center lg:justify-start mr-2 lg:mr-4"><div class="flex items-center gap-3"><div class="w-10 h-10 lg:w-12 lg:h-12 rounded-xl bg-primary/10 flex items-center justify-center"><i class="ti ti-message-question text-primary text-lg lg:text-xl"></i></div> <h1 class="text-lg lg:text-2xl font-semibold lg:font-bold text-foreground">جعبه سوالات</h1></div></div> ',3)),t("div",G,[t("div",H,[t("span",J,c(b.value)+" پیام",1)]),e[6]||(e[6]=o()),t("button",{onClick:P,disabled:u.value,class:"px-3 py-1.5 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors flex items-center gap-2 disabled:opacity-50"},[...e[5]||(e[5]=[t("i",{class:"ti ti-download text-lg"},null,-1),o(),t("span",null,"خروجی",-1)])],8,K)])])]),e[29]||(e[29]=o()),t("div",W,[t("div",X,[t("div",Y,[t("div",ee,[e[8]||(e[8]=t("i",{class:"ti ti-search absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground"},null,-1)),e[9]||(e[9]=o()),V(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),type:"text",placeholder:"جستجو بر اساس نام یا شماره موبایل...",class:"w-full h-10 pr-10 pl-4 bg-card border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[D,v.value]])]),e[12]||(e[12]=o()),V(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>g.value=s),class:"h-10 px-4 bg-card border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary/20"},[...e[10]||(e[10]=[t("option",{value:"newest"},"جدیدترین",-1),o(),t("option",{value:"oldest"},"قدیمی‌ترین",-1),o(),t("option",{value:"name"},"نام (الف-ی)",-1)])],512),[[E,g.value]]),e[13]||(e[13]=o()),t("button",{onClick:e[3]||(e[3]=s=>{v.value="",g.value="newest"}),class:"h-10 px-4 bg-muted/50 hover:bg-muted text-foreground rounded-lg transition-colors flex items-center gap-2"},[...e[11]||(e[11]=[t("i",{class:"ti ti-filter-off text-lg"},null,-1),o(),t("span",null,"پاک کردن",-1)])])]),e[25]||(e[25]=o()),t("div",te,[t("div",se,[e[14]||(e[14]=t("span",{class:"text-muted-foreground text-sm"},"تعداد پیام‌ها:",-1)),e[15]||(e[15]=o()),t("span",oe,c(M.value),1)]),e[16]||(e[16]=o()),t("button",{onClick:P,disabled:u.value,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors text-sm disabled:opacity-50"},`\r
          خروجی\r
        `,8,re)]),e[26]||(e[26]=o()),u.value?(d(),l("div",ne,[e[18]||(e[18]=f('<div class="bg-muted/20 px-4 py-3 border-b border-border"><div class="grid grid-cols-2 lg:grid-cols-4 gap-4"><span class="font-medium text-foreground text-sm">شناسه</span> <span class="font-medium text-foreground text-sm lg:col-span-2">فرستنده</span> <span class="hidden lg:block font-medium text-foreground text-sm text-left">عملیات</span></div></div> ',2)),t("div",le,[(d(),l(w,null,h(5,s=>t("div",{key:s,class:"px-4 py-3"},[...e[17]||(e[17]=[f('<div class="grid grid-cols-2 lg:grid-cols-4 gap-4 items-center"><div class="h-5 bg-muted/30 rounded animate-pulse"></div> <div class="h-5 bg-muted/30 rounded animate-pulse lg:col-span-2"></div> <div class="hidden lg:flex items-center justify-end gap-2"><div class="w-8 h-8 bg-muted/30 rounded animate-pulse"></div> <div class="w-8 h-8 bg-muted/30 rounded animate-pulse"></div></div></div>',1)])])),64))])])):(d(),l("div",de,[e[23]||(e[23]=f('<div class="bg-muted/20 px-4 py-3 border-b border-border"><div class="grid grid-cols-2 lg:grid-cols-4 gap-4"><span class="font-medium text-foreground text-sm">شناسه</span> <span class="font-medium text-foreground text-sm lg:col-span-2">فرستنده</span> <span class="hidden lg:block font-medium text-foreground text-sm text-left">عملیات</span></div></div> ',2)),t("div",ie,[(d(!0),l(w,null,h(L.value,s=>(d(),l("div",{key:s.id,class:"px-4 py-3 hover:bg-accent/5 transition-colors"},[t("div",ae,[t("span",ue,"#"+c(s.id),1),e[21]||(e[21]=o()),t("div",ge,[t("div",me,c(s.name||"بدون نام"),1),e[19]||(e[19]=o()),t("div",ce,c(s.mobile),1)]),e[22]||(e[22]=o()),t("div",ve,[t("button",{onClick:n=>q(s.id),class:"p-2 hover:bg-destructive/10 rounded-lg transition-colors group",title:"حذف"},[...e[20]||(e[20]=[t("i",{class:"ti ti-trash text-muted-foreground group-hover:text-destructive text-lg"},null,-1)])],8,pe)])])]))),128))])])),e[27]||(e[27]=o()),!u.value&&B.value>1?(d(),l("div",fe,[(d(!0),l(w,null,h(B.value,s=>(d(),l("button",{key:s,onClick:n=>x.value=s,class:z(["w-8 h-8 rounded-lg flex items-center justify-center text-sm font-medium transition-colors",x.value===s?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted/30"])},c(s),11,xe))),128))])):S("",!0),e[28]||(e[28]=o()),!u.value&&L.value.length===0?(d(),l("div",be,[...e[24]||(e[24]=[t("div",{class:"w-16 h-16 rounded-xl bg-primary/10 flex items-center justify-center mx-auto mb-4"},[t("i",{class:"ti ti-message-question text-primary text-2xl opacity-50"})],-1),o(),t("h3",{class:"text-foreground font-medium mb-2"},"هیچ پیامی وجود ندارد",-1),o(),t("p",{class:"text-muted-foreground text-sm"},"هنوز هیچ پیامی از جعبه سوالات دریافت نشده است",-1)])])):S("",!0)])])]))}});export{ke as default};
