const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bw9k-xBj.js","./CE1G-McA.js"])))=>i.map(i=>d[i]);
import{_ as ke}from"./CgleJCdt.js";import{a as ie,e as Ce,n as H,i as he,u as Ae,_ as Te}from"#entry";import{r as M,w as oe,H as Z,x as l,F as V,I as Q,k as a,l as C,O as $e,q as e,p as t,u as N,N as de,V as ue,Q as Y,R as F,a0 as Be,T as Se,X as Ne,n as ae,j as ce,K as Re,M as W,d as I,a1 as je,v as O,aw as we,ax as qe,a3 as ye,G as be,E as ze,y as ve,z as Ie,S as Le,m as Ue,D as Ee,a6 as Oe}from"./Ct89Yiyn.js";import{Q as xe}from"./Bw9k-xBj.js";import{u as Ve,_ as De}from"./C1aQa-TZ.js";import{_ as fe}from"./DlAUqK2U.js";import{_ as J}from"./DUksgA9l.js";import{u as Qe}from"./D-Ev5PMd.js";import{u as re}from"./lVmvsOkf.js";import{useUserStore as pe}from"./BRBG3GYJ.js";import{u as We}from"./Drvv-Qqv.js";import{u as Xe}from"./AuYbrIUI.js";import"./CU4qPF7-.js";import"./ngrFHoWO.js";import"./CE1G-McA.js";const Ye={class:"bg-white rounded-2xl w-96 shadow-xl p-6 scale-100"},He={class:"flex items-center gap-2 mb-4 text-black"},Fe={class:"text-lg font-bold"},Ke={key:0,class:"mb-4"},Ze={key:1,class:"mb-4"},Ge={class:"flex justify-center gap-2 ltr"},Je=["onUpdate:modelValue","onInput","onKeydown"],_e={key:0,class:"text-xs text-red-600"},et={key:1,class:"text-xs text-green-600"},tt={class:"text-xs text-gray-500 mt-2"},st={class:"font-medium"},ot={class:"flex justify-end gap-2 mt-6"},rt={__name:"EditPhoneModal",props:{visible:Boolean,modelValue:String},emits:["close","update"],setup(P,{emit:v}){const{error:x}=Ve(),w=P,k=v,d=M(w.modelValue||"");oe(()=>w.modelValue,b=>{d.value=b||""});const j=M(!1),T=M(!1),B=M(1),$=M(["","","",""]),i=M([]),A=M(!1),c=M(""),r=M("ti-alert-triangle"),g=(b,u="ti-lock")=>{c.value=b,r.value=u,A.value=!0,setTimeout(()=>A.value=!1,3e3)};function h(b){return b.replace(/[۰-۹]/g,u=>"۰۱۲۳۴۵۶۷۸۹".indexOf(u)).replace(/[^\d]/g,"")}function p(b){const u=$.value[b];if(!/^\d$/.test(u)){$.value[b]="";return}b<$.value.length-1&&i.value[b+1]?.focus()}function o(b){$.value[b]===""&&b>0&&i.value[b-1]?.focus()}const m=async()=>{if(!d.value||d.value.length<10){x("شماره نامعتبر","لطفاً شماره موبایل معتبر وارد کنید");return}const{$axios:b}=ie(),u=h(d.value||"");try{const R=await b.post("auth/sendOtpCode",{phone:u.replace(/^0/,""),countryCode:"98"});R.data&&R.data.success===!0?($.value=["","","",""],j.value=!1,T.value=!1,await ae(()=>i.value[0]?.focus())):g(R.data.message||"ارسال کد با مشکل مواجه شد.","ti-alert-triangle")}catch(R){R.response?.data?.message?g(R.response.data.message,"ti-alert-triangle"):g("مشکلی در ارتباط با سرور وجود دارد.","ti-alert-triangle")}B.value=2};async function f(){const{$axios:b}=ie(),u=$.value.join(""),R=h(d.value||"").replace(/^0/,"");try{const L=await b.post("auth/verifyPhoneChange",{code:u,phone:R,countryCode:"98"});L.data?.success===!0?(T.value=!0,j.value=!1,g("شماره با موفقیت تأیید شد.","ti-check"),B.value=1,k("update",d.value),k("close")):(T.value=!1,j.value=!0,g(L.data.message||"کد وارد شده نادرست است.","ti-alert-triangle"))}catch(L){T.value=!1,j.value=!0;const E=L.response?.data?.message||"خطایی در بررسی کد تأیید رخ داد.";g(E,"ti-alert-triangle")}}function S(b){let u=b.target.value.replace(/[^\d۰-۹]/g,"");u=u.replace(/[۰-۹]/g,R=>String("۰۱۲۳۴۵۶۷۸۹".indexOf(R))),u.startsWith("0")||(u="0"+u),u.length>11&&(u=u.slice(0,11)),d.value=u}return(b,u)=>(l(),Z(Ne,{to:"body"},[V(Se,{name:"fade-scale"},{default:Q(()=>[P.visible?(l(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:u[2]||(u[2]=$e(R=>b.$emit("close"),["self"]))},[e("div",Ye,[e("div",He,[u[3]||(u[3]=e("i",{class:"ti ti-device-mobile text-2xl"},null,-1)),u[4]||(u[4]=t()),e("h2",Fe,N(B.value===1?"ویرایش شماره موبایل":"تایید کد"),1)]),u[13]||(u[13]=t()),B.value===1?(l(),a("div",Ke,[u[5]||(u[5]=e("label",{class:"block text-sm text-gray-600 mb-1"},"شماره جدید",-1)),u[6]||(u[6]=t()),de(e("input",{type:"tel","onUpdate:modelValue":u[0]||(u[0]=R=>d.value=R),onInput:S,placeholder:"مثلاً 09123456789",class:"w-full px-3 py-2 rounded-md border border-gray-300 focus:ring-2 focus:ring-black focus:outline-none text-sm text-gray-700"},null,544),[[ue,d.value]])])):(l(),a("div",Ze,[e("div",Ge,[(l(!0),a(Y,null,F($.value.length,(R,L)=>de((l(),a("input",{key:L,ref_for:!0,ref:E=>i.value[L]=E,"onUpdate:modelValue":E=>$.value[L]=E,type:"text",inputmode:"numeric",maxlength:"1",pattern:"[0-9]*",class:"w-12 h-12 text-xl text-center border rounded-lg font-bold text-gray-700",dir:"ltr",onInput:E=>p(L),onKeydown:Be(E=>o(L,E),["backspace"])},null,40,Je)),[[ue,$.value[L]]])),128)),u[7]||(u[7]=t()),j.value?(l(),a("p",_e,"کد وارد شده نادرست است.")):C("",!0),u[8]||(u[8]=t()),T.value?(l(),a("p",et,"شماره موبایل تأیید شد.")):C("",!0)]),u[11]||(u[11]=t()),e("p",tt,[u[9]||(u[9]=t(`\r
              کد به شماره `,-1)),e("span",st,N(d.value),1),u[10]||(u[10]=t(` ارسال شد.\r
            `,-1))])])),u[14]||(u[14]=t()),e("div",ot,[e("button",{onClick:u[1]||(u[1]=R=>b.$emit("close")),class:"px-4 py-2 text-sm rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100"},`\r
              لغو\r
            `),u[12]||(u[12]=t()),B.value===1?(l(),a("button",{key:0,onClick:m,class:"px-4 py-2 text-sm rounded-md bg-black text-white hover:bg-gray-900"},`\r
              ارسال کد\r
            `)):(l(),a("button",{key:1,onClick:f,class:"px-4 py-2 text-sm rounded-md bg-black text-white hover:bg-gray-900"},`\r
              تایید\r
            `))])])])):C("",!0)]),_:1})]))}},lt=fe(rt,[["__scopeId","data-v-8ed94b6a"]]),nt={class:"relative min-w-0"},at={key:0,class:"absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg z-50"},it={class:"text-sm p-2 space-y-2"},dt=["onClick"],ut={class:"text-base space-y-1"},ct=["onClick"],ft={__name:"ActionMenu",emits:["action","download-qr","edit-mobile"],setup(P,{emit:v}){const x=M(!1),w=M(!1),k=()=>{w.value=window.innerWidth<768,w.value||(x.value=!1)};ce(()=>{k(),window.addEventListener("resize",k),document.addEventListener("click",d)}),Re(()=>{window.removeEventListener("resize",k),document.removeEventListener("click",d)});const d=$=>{x.value&&($.target.closest(".relative")||(x.value=!1))},j=v,T=[{key:"view",label:"مشاهده پروقایل",icon:"ti-eye"},{key:"share",label:"اشتراک کارت",icon:"ti-share"},{key:"downloadQR",label:"دانلود QR",icon:"ti-download"},{key:"editMobile",label:"ویرایش موبایل",icon:"ti-mail"}],B=$=>{switch($){case"view":j("action","show-profile");break;case"share":j("action","open-share");break;case"downloadQR":j("download-qr");break;case"editMobile":j("edit-mobile");break}x.value=!1};return($,i)=>{const A=J;return l(),a("div",nt,[e("button",{class:"w-10 h-10 border border-gray-300 text-gray-700 rounded-full flex items-center justify-center shrink-0 hover:bg-gray-100 transition",onClick:i[0]||(i[0]=c=>x.value=!x.value),"aria-label":"نمایش منو"},[...i[2]||(i[2]=[e("i",{class:"ti ti-dots"},null,-1)])]),i[3]||(i[3]=t()),x.value&&!w.value?(l(),a("div",at,[e("ul",it,[(l(),a(Y,null,F(T,c=>e("li",{key:c.key,class:"hover:bg-gray-100 p-2 rounded flex items-center gap-2 cursor-pointer text-gray-700",onClick:r=>B(c.key)},[e("i",{class:W(`ti ${c.icon} text-lg`)},null,2),t(" "+N(c.label),1)],8,dt)),64))])])):C("",!0),i[4]||(i[4]=t()),V(A,{visible:x.value&&w.value,title:"منوی عملیات","desktop-centered":!1,"height-class":"max-h-[50vh]","content-padding":"p-4",onClose:i[1]||(i[1]=c=>x.value=!1)},{default:Q(()=>[e("ul",ut,[(l(),a(Y,null,F(T,c=>e("li",{key:c.key,class:"hover:bg-gray-100 p-4 rounded-lg flex items-center gap-3 cursor-pointer text-gray-700",onClick:r=>B(c.key)},[e("i",{class:W(`ti ${c.icon} text-lg`)},null,2),t(" "+N(c.label),1)],8,ct)),64))])]),_:1},8,["visible"])])}}},mt=fe(ft,[["__scopeId","data-v-c9d5f0d2"]]),gt={class:"relative min-w-0"},xt={key:0,class:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"},bt={key:0,class:"absolute left-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 overflow-hidden"},vt={class:"p-4 border-b border-gray-100"},pt={class:"max-h-64 overflow-y-auto"},ht=["onClick"],wt={class:"flex items-start gap-3"},yt={class:"flex-1"},kt={class:"text-sm font-medium text-gray-800"},Ct={class:"text-xs text-gray-600 mt-1"},$t={class:"text-xs text-gray-400"},St={class:"p-3 border-t border-gray-100"},jt={class:"max-h-64 overflow-y-auto"},zt=["onClick"],Pt={class:"flex items-start gap-3"},Mt={class:"flex-1"},At={class:"text-sm font-medium text-gray-800"},Tt={class:"text-xs text-gray-600 mt-1"},Bt={class:"text-xs text-gray-400"},Nt={class:"p-3 border-t border-gray-100"},Rt={__name:"NotificationMenu",setup(P){const v=M(!1),x=M(!1),w=Qe(),k=I(()=>w.notifications?.length?w.notifications.filter($=>!$.read).length:0);ce(()=>{w.fetchNotifications();const $=()=>{x.value=window.innerWidth<768};$(),window.addEventListener("resize",$);const i=A=>{v.value&&!A.target.closest(".relative")&&(v.value=!1)};document.addEventListener("click",i),je(()=>{window.removeEventListener("resize",$),document.removeEventListener("click",i)})});const d=async $=>{await w.markAsRead($)},j=$=>{switch($){case"subscription":return"ti ti-clock text-orange-600";case"payment":return"ti ti-check text-green-600";case"system":return"ti ti-refresh text-blue-600";case"security":return"ti ti-alert-circle text-red-600";case"general":return"ti ti-info-circle text-gray-600";default:return"ti ti-bell text-gray-600"}},T=$=>{switch($){case"subscription":return"bg-orange-100";case"payment":return"bg-green-100";case"system":return"bg-blue-100";case"security":return"bg-red-100";case"general":return"bg-gray-100";default:return"bg-gray-100"}},B=$=>{const i=(Date.now()-$.getTime())/1e3;return i<60?"لحظاتی پیش":i<3600?`${Math.floor(i/60)} دقیقه پیش`:i<86400?`${Math.floor(i/3600)} ساعت پیش`:`${Math.floor(i/86400)} روز پیش`};return($,i)=>{const A=Ce;return l(),a("div",gt,[e("button",{class:"w-10 h-10 flex items-center justify-center text-gray-600 hover:text-black transition-colors rounded-lg hover:bg-gray-100 shrink-0",onClick:i[0]||(i[0]=c=>v.value=!v.value),title:"نوتیفیکیشن‌ها"},[i[5]||(i[5]=e("i",{class:"ti ti-bell text-xl"},null,-1)),i[6]||(i[6]=t()),O(k)>0?(l(),a("span",xt)):C("",!0)]),i[20]||(i[20]=t()),v.value&&!x.value?(l(),a("div",bt,[e("div",vt,[i[7]||(i[7]=e("h3",{class:"font-semibold text-gray-800 flex items-center gap-2"},[e("i",{class:"ti ti-bell text-lg"}),t(`\r
          نوتیفیکیشن‌ها\r
        `)],-1)),i[8]||(i[8]=t()),O(k)>0?(l(),a("button",{key:0,onClick:i[1]||(i[1]=(...c)=>O(w).markAllAsRead&&O(w).markAllAsRead(...c)),class:"text-xs text-blue-600 hover:text-blue-800"},`\r
          علامت‌گذاری همه به عنوان خوانده شده\r
        `)):C("",!0)]),i[13]||(i[13]=t()),e("div",pt,[(l(!0),a(Y,null,F(O(w).notifications,c=>(l(),a("div",{key:c.id,class:W(["p-4 hover:bg-gray-50 border-b border-gray-100 transition-colors cursor-pointer flex items-start gap-3",[c.read?"bg-white":"border-r-4 border-blue-500 bg-blue-50"]]),onClick:r=>O(w).markAsRead(c.id)},[e("div",wt,[e("div",{class:W(["w-8 h-8 rounded-full flex items-center justify-center shrink-0",T(c.type)])},[e("i",{class:W([j(c.type),"text-sm"])},null,2)],2),i[11]||(i[11]=t()),e("div",yt,[e("p",kt,N(c.title),1),i[9]||(i[9]=t()),e("p",Ct,N(c.description),1),i[10]||(i[10]=t()),e("span",$t,N(B(c.createdAt)),1)])])],10,ht))),128))]),i[14]||(i[14]=t()),e("div",St,[V(A,{to:"/dashboard/notifications",onClick:i[2]||(i[2]=c=>v.value=!1),class:"w-full block text-center text-sm text-blue-600 hover:text-blue-800 transition-colors"},{default:Q(()=>[...i[12]||(i[12]=[t(`\r
          مشاهده همه نوتیفیکیشن‌ها\r
        `,-1)])]),_:1})])])):C("",!0),i[21]||(i[21]=t()),V(J,{visible:v.value&&x.value,title:"نوتیفیکیشن‌ها","desktop-centered":!1,"height-class":"max-h-[80vh]","content-padding":"p-0",onClose:i[4]||(i[4]=c=>v.value=!1)},{default:Q(()=>[e("div",jt,[(l(!0),a(Y,null,F(O(w).notifications,c=>(l(),a("div",{key:c.id,class:W(["p-4 hover:bg-gray-50 border-b border-gray-100 transition-colors cursor-pointer",c.read?"bg-white":"border-r-4 border-blue-500"]),onClick:r=>d(c.id)},[e("div",Pt,[e("div",{class:W(["w-8 h-8 rounded-full flex items-center justify-center shrink-0",T(c.type)])},[e("i",{class:W([j(c.type),"text-sm"])},null,2)],2),i[17]||(i[17]=t()),e("div",Mt,[e("p",At,N(c.title),1),i[15]||(i[15]=t()),e("p",Tt,N(c.description),1),i[16]||(i[16]=t()),e("span",Bt,N(B(c.createdAt)),1)])])],10,zt))),128))]),i[19]||(i[19]=t()),e("div",Nt,[V(A,{to:"/dashboard/notifications",onClick:i[3]||(i[3]=c=>v.value=!1),class:"w-full block text-center text-sm text-blue-600 hover:text-blue-800 transition-colors"},{default:Q(()=>[...i[18]||(i[18]=[t(`\r
          مشاهده همه نوتیفیکیشن‌ها\r
        `,-1)])]),_:1})])]),_:1},8,["visible"])])}}},qt={class:"hidden"},It={class:"flex flex-wrap items-center justify-between gap-4 overflow-x-auto md:overflow-visible min-w-0"},Lt={class:"flex items-center gap-2 flex-shrink-0 min-w-0"},Ut={key:1,class:"items-center gap-2 hidden md:flex min-w-0"},Et={class:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-sm text-white shrink-0"},Ot=["src"],Vt={key:1,class:"ti ti-user"},Dt={class:"font-semibold text-sm truncate text-gray-700"},Qt={key:0,class:"flex items-center gap-2 flex-1 min-w-0 sm:text-start text-center"},Wt={class:"text-lg font-bold truncate min-w-0 text-gray-700"},Xt={key:1,class:"relative min-w-0"},Yt={class:"hidden md:block w-full sm:max-w-sm min-w-0"},Ht={class:"flex items-center gap-2 flex-shrink-0 min-w-0"},Ft={key:0,class:"fixed inset-x-0 top-0 z-50 bg-white shadow-lg flex flex-col items-center",style:{height:"96px"}},Kt={class:"flex items-center w-full max-w-md mx-auto px-4 h-full"},Zt={__name:"index",props:we({showBack:Boolean,userName:String,showSearch:Boolean,showMore:Boolean,showNotifications:Boolean,showShare:Boolean,showAddCard:Boolean,title:String,showCardSelect:Boolean,showStateSelect:Boolean,userLogo:String,userPhone:String,cardSlug:String,qrBgColor:String,qrColor:String},{search:{},searchModifiers:{}}),emits:we(["open-share","search","action","add-card","toggle-sidebar"],["update:search"]),setup(P,{emit:v}){const x=P,w=v,k=qe(P,"search"),d=I({get:()=>k.value,set:p=>k.value=p}),j=M(!1),T=M(!1),B=M(x.userPhone),$=M(!1),i=()=>{window.location.pathname.includes("/dashboard/edit-card")?window.location.href="/dashboard/dashboard":window.history.back()},A=p=>{w("action",p),j.value=!1},c=p=>{B.value=p},r=re(),g=I(()=>r.defaultCard),h=async()=>{const o=document.createElement("canvas");o.width=800,o.height=800;const m=o.getContext("2d"),f=`https://linku.im/profile/${x.cardSlug}/share`;await xe.toCanvas(o,f,{errorCorrectionLevel:"H",width:800,margin:2,color:{dark:x.qrColor?x.qrColor:"#000000",light:x.qrBgColor?x.qrBgColor:"#ffffff"}});const S=x.userLogo?.trim()?x.userLogo:new URL(""+new URL("logo.Bw_Da6Fq.png",import.meta.url).href,import.meta.url).href,b=new Image;b.crossOrigin="anonymous",b.src=S,await new Promise((R,L)=>{b.onload=()=>{m.save(),m.beginPath();const D=16;m.moveTo(312+D,312),m.lineTo(488-D,312),m.quadraticCurveTo(488,312,488,312+D),m.lineTo(488,488-D),m.quadraticCurveTo(488,488,488-D,488),m.lineTo(312+D,488),m.quadraticCurveTo(312,488,312,488-D),m.lineTo(312,312+D),m.quadraticCurveTo(312,312,312+D,312),m.closePath(),m.fillStyle="#ffffff",m.fill(),m.clip();const U=176*.12,_=176-U*2,le=176-U*2,ee=Math.min(_/b.width,le/b.height),te=b.width*ee,se=b.height*ee,ne=312+(176-te)/2,me=312+(176-se)/2;m.drawImage(b,ne,me,te,se),m.restore(),R()},b.onerror=L});const u=document.createElement("a");u.href=o.toDataURL("image/png"),u.download=`qr-${B.value}.png`,u.click()};return(p,o)=>{const m=Ce;return l(),a(Y,null,[e("header",qt,[e("div",It,[e("div",Lt,[e("button",{class:"w-10 h-10 bg-white border text-gray-700 rounded-lg md:hidden flex items-center justify-center shrink-0",onClick:o[0]||(o[0]=f=>p.$emit("toggle-sidebar"))},[...o[8]||(o[8]=[e("i",{class:"ti ti-menu text-base"},null,-1)])]),o[11]||(o[11]=t()),P.showBack?(l(),a("button",{key:0,onClick:i,class:"w-10 h-10 flex items-center justify-center text-gray-500 hover:text-black text-xl shrink-0"},[...o[9]||(o[9]=[e("i",{class:"ti ti-chevron-right"},null,-1)])])):C("",!0),o[12]||(o[12]=t()),P.userName?(l(),a("div",Ut,[e("div",Et,[O(r).defaultCard?.avatar?(l(),a("img",{key:0,src:O(r).defaultCard.avatar,alt:"cover_img_card",class:"w-7 h-7 rounded-full object-cover"},null,8,Ot)):(l(),a("i",Vt))]),o[10]||(o[10]=t()),e("span",Dt,N(P.userName),1)])):C("",!0)]),o[24]||(o[24]=t()),P.title?(l(),a("div",Qt,[e("h1",Wt,N(P.title),1),o[14]||(o[14]=t()),P.showAddCard?(l(),Z(m,{key:0,to:"/dashboard/add-card",class:"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-800 flex items-center justify-center text-sm shrink-0 transition-colors",title:"ساخت پروفایل جدید"},{default:Q(()=>[...o[13]||(o[13]=[e("i",{class:"ti ti-plus"},null,-1)])]),_:1})):C("",!0)])):C("",!0),o[25]||(o[25]=t()),P.showSearch?(l(),a("div",Xt,[e("button",{class:"w-10 h-10 md:hidden flex items-center justify-center text-gray-500 hover:text-blue-600 text-xl bg-white border border-gray-200 shadow-sm rounded-full transition",onClick:o[1]||(o[1]=f=>$.value=!0)},[...o[15]||(o[15]=[e("i",{class:"ti ti-search"},null,-1)])]),o[18]||(o[18]=t()),e("div",Yt,[o[16]||(o[16]=e("i",{class:"ti ti-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-base"},null,-1)),o[17]||(o[17]=t()),de(e("input",{type:"text",placeholder:"جستجوی کارت...","onUpdate:modelValue":o[2]||(o[2]=f=>d.value=f),class:"w-full bg-white rounded-full py-3 ltr:pl-10 ltr:pr-4 rtl:pl-4 rtl:pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-black border border-gray-200 min-w-0 text-gray-700"},null,512),[[ue,d.value]])])])):C("",!0),o[26]||(o[26]=t()),e("div",Ht,[P.showCardSelect?ye(p.$slots,"card-select",{key:0},void 0,!0):C("",!0),o[20]||(o[20]=t()),P.showStateSelect?ye(p.$slots,"state-select",{key:1},void 0,!0):C("",!0),o[21]||(o[21]=t()),P.showNotifications?(l(),Z(Rt,{key:2})):C("",!0),o[22]||(o[22]=t()),P.showShare?(l(),a("button",{key:3,class:"w-10 h-10 lg:w-auto px-4 flex items-center justify-center bg-black text-white rounded-full text-sm gap-2 shrink-0",onClick:o[3]||(o[3]=f=>p.$emit("open-share",g.value))},[...o[19]||(o[19]=[e("i",{class:"ti ti-share"},null,-1),t(),e("span",{class:"hidden lg:block"},"اشتراک‌گذاری کارت",-1)])])):C("",!0),o[23]||(o[23]=t()),P.showMore?(l(),Z(mt,{key:4,onAction:A,onDownloadQr:h,onEditMobile:o[4]||(o[4]=f=>T.value=!0)})):C("",!0)])])]),o[29]||(o[29]=t()),V(Se,{name:"slide-down"},{default:Q(()=>[$.value?(l(),a("div",Ft,[e("div",Kt,[e("button",{onClick:o[5]||(o[5]=f=>$.value=!1),class:"w-10 h-10 flex items-center justify-center text-gray-500 mr-2"},[...o[27]||(o[27]=[e("i",{class:"ti ti-x"},null,-1)])]),o[28]||(o[28]=t()),de(e("input",{type:"text",placeholder:"جستجوی کارت...","onUpdate:modelValue":o[6]||(o[6]=f=>d.value=f),class:"flex-1 bg-gray-100 rounded-full py-3 px-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autofocus:""},null,512),[[ue,d.value]])])])):C("",!0)]),_:1}),o[30]||(o[30]=t()),V(lt,{visible:T.value,modelValue:B.value,onUpdate:c,onClose:o[7]||(o[7]=f=>T.value=!1)},null,8,["visible","modelValue"])],64)}}},Gt=fe(Zt,[["__scopeId","data-v-db0bc4b5"]]),Jt={class:"fixed top-0 left-0 right-0 w-full z-50 bg-card/95 backdrop-blur-lg border-b border-border"},_t={class:"flex items-center justify-between px-4 py-3"},es={key:0,class:"flex items-center gap-3"},ts={key:0,class:"text-lg font-semibold text-foreground"},ss={class:"flex items-center gap-2"},os={key:0,class:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-card"},rs={key:0,class:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-card"},ls={class:"px-4 pb-6 pt-2"},ns={class:"space-y-2"},as=["onClick"],is={class:"relative w-11 h-11 rounded-full overflow-hidden ring-2 ring-border bg-white"},ds=["src","alt"],us={class:"flex-1"},cs={class:"flex items-center justify-between mb-0.5"},fs={class:"flex items-center gap-1.5"},ms={class:"text-sm font-semibold text-primary"},gs={key:0,class:"ti ti-rosette-discount-check-filled text-primary text-lg"},xs={key:0,class:"text-xs bg-secondary text-primary border border-border px-2 py-0.5 rounded-full font-medium flex items-center gap-1"},bs={class:"flex flex-wrap items-center gap-1.5 text-xs text-foreground"},vs={key:0,class:"font-medium"},ps={class:"mt-3 pt-3"},hs={class:"w-full flex items-center justify-between gap-2 p-3 rounded-2xl bg-secondary border-2 border-dashed border-border hover:bg-accent-bg/30 transition-colors"},ws={key:1,class:"bg-black dark:bg-white text-white dark:text-black px-3 py-1 rounded-full text-xs font-semibold"},ys={__name:"MobileHeader",setup(P){const v=be(),x=ze(),w=pe(),k=re(),d=M(!1),j=M(!1),T={"/profile":"پروفایل","/settings":"تنظیمات","/settings/account-status":"وضعیت حساب","/dashboard/transactions":"تراکنش‌ها","/dashboard/support":"پشتیبانی","/dashboard/activate":"فعال‌سازی دستگاه","/dashboard/checkout":"خرید اشتراک","/dashboard/notifications":"اعلان‌ها","/dashboard/inbox":"صندوق ورودی"},B=I(()=>{const q=v.path;return q!=="/dashboard"&&q!=="/dashboard/dashboard"}),$=I(()=>{const q=v.path;return q==="/dashboard"||q==="/dashboard/dashboard"||q==="/"}),i=I(()=>T[v.path]||""),A=I(()=>typeof window>"u"?!1:window.innerWidth>=1024),c=I(()=>w.user?.name||"کاربر"),r=I(()=>w.user?.userName||w.user?.username||""),g=I(()=>w.user?.isPro||!1),h=I(()=>k.inboxBadge||0),p=M(!0),o=I(()=>k.defaultCard||k.cards?.[0]||null),m=I(()=>{const q=k.cards||[];return g.value?q.filter(n=>n.isActive!==!1):q.slice(0,1)}),f=()=>{v.path.includes("/dashboard/edit-card")?H("/dashboard"):x.back()},S=q=>{k.setDefaultCard(q.id),d.value=!1},b=()=>{if(d.value=!1,!g.value&&m.value.length>=1){H("/dashboard/checkout");return}g.value&&m.value.length>=5||H("/dashboard/add-card")},u=()=>{d.value=!1,H("/dashboard/checkout")},R=()=>{j.value=!1,H("/dashboard/support/online")},L=()=>{j.value=!1,H("/dashboard/support/faq")},E=()=>{j.value=!1,H("/dashboard/support/ticket")};return(q,n)=>{const D=ke;return l(),a("div",Jt,[e("div",_t,[B.value?(l(),a("div",es,[e("button",{onClick:f,class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200"},[...n[7]||(n[7]=[e("i",{class:"ti ti-arrow-right text-xl"},null,-1)])]),n[8]||(n[8]=t()),i.value?(l(),a("h1",ts,N(i.value),1)):C("",!0)])):C("",!0),n[19]||(n[19]=t()),V(D,null,{default:Q(()=>[B.value?C("",!0):(l(),a("button",{key:0,onClick:n[0]||(n[0]=U=>d.value=!0),class:"flex items-center gap-2 transition-all duration-200 hover:bg-muted rounded-lg px-2 py-1"},[...n[9]||(n[9]=[e("span",{class:"text-lg font-semibold text-foreground"},"پروفایل‌ها",-1),t(),e("i",{class:"ti ti-chevron-down text-muted-foreground text-sm"},null,-1)])]))]),_:1}),n[20]||(n[20]=t()),V(D,null,{default:Q(()=>[e("div",ss,[!B.value&&A.value?(l(),a("button",{key:0,onClick:n[1]||(n[1]=U=>("navigateTo"in q?q.navigateTo:O(H))("/settings")),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200"},[...n[10]||(n[10]=[e("i",{class:"ti ti-settings text-xl"},null,-1)])])):C("",!0),n[16]||(n[16]=t()),$.value?(l(),a("button",{key:1,onClick:n[2]||(n[2]=U=>("navigateTo"in q?q.navigateTo:O(H))("/inbox")),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200 relative"},[n[11]||(n[11]=e("i",{class:"ti ti-inbox text-xl"},null,-1)),n[12]||(n[12]=t()),h.value>0?(l(),a("div",os)):C("",!0)])):C("",!0),n[17]||(n[17]=t()),$.value?(l(),a("button",{key:2,onClick:n[3]||(n[3]=U=>("navigateTo"in q?q.navigateTo:O(H))("/dashboard/notifications")),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200 relative"},[n[13]||(n[13]=e("i",{class:"ti ti-bell text-xl"},null,-1)),n[14]||(n[14]=t()),p.value?(l(),a("div",rs)):C("",!0)])):C("",!0),n[18]||(n[18]=t()),e("button",{onClick:n[4]||(n[4]=U=>j.value=!0),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200"},[...n[15]||(n[15]=[e("i",{class:"ti ti-headset text-xl"},null,-1)])])])]),_:1})]),n[38]||(n[38]=t()),V(J,{modelValue:d.value,"onUpdate:modelValue":n[5]||(n[5]=U=>d.value=U),closable:!0,"close-on-backdrop":!0,title:"انتخاب پروفایل"},{default:Q(()=>[e("div",ls,[n[28]||(n[28]=e("p",{class:"text-sm text-primary opacity-60 text-center mb-4"},"پروفایل مورد نظر خود را انتخاب کنید",-1)),n[29]||(n[29]=t()),e("div",ns,[(l(!0),a(Y,null,F(m.value,U=>(l(),a("div",{key:U.id,onClick:_=>S(U),class:W(["flex items-center gap-3 p-3 rounded-2xl border cursor-pointer transition-colors",U.id===o.value?.id?"bg-primary/5 border-primary":"bg-secondary border-border hover:bg-accent-bg/30"])},[e("div",is,[e("img",{src:U.avatar||"/logo.svg",alt:U.name,class:"w-full h-full object-cover"},null,8,ds)]),n[25]||(n[25]=t()),e("div",us,[e("div",cs,[e("div",fs,[e("h3",ms,N(c.value),1),n[21]||(n[21]=t()),g.value?(l(),a("i",gs)):C("",!0)]),n[23]||(n[23]=t()),U.id===o.value?.id?(l(),a("span",xs,[...n[22]||(n[22]=[e("i",{class:"ti ti-check text-xs"},null,-1),t(`\r
                  پیش‌فرض\r
                `,-1)])])):C("",!0)]),n[24]||(n[24]=t()),e("div",bs,[r.value?(l(),a("span",vs,`\r
                  @`+N(r.value),1)):C("",!0)])])],10,as))),128))]),n[30]||(n[30]=t()),e("div",ps,[e("div",hs,[e("div",{onClick:b,class:"flex items-center gap-2 flex-1 cursor-pointer"},[...n[26]||(n[26]=[e("div",{class:"w-11 h-11 rounded-full bg-accent-bg ring-2 ring-border flex items-center justify-center"},[e("i",{class:"ti ti-plus text-primary text-sm"})],-1),t(),e("span",{class:"text-sm font-medium text-primary"},`\r
                ایجاد پروفایل جدید\r
              `,-1)])]),n[27]||(n[27]=t()),g.value?(l(),a("div",ws,`\r
              کاربر ویژه\r
            `)):(l(),a("div",{key:0,onClick:u,class:"bg-black dark:bg-white text-white dark:text-black px-3 py-1 rounded-full text-xs font-semibold cursor-pointer hover:opacity-90 transition-opacity"},`\r
              خرید اشتراک\r
            `))])])])]),_:1},8,["modelValue"]),n[39]||(n[39]=t()),V(J,{modelValue:j.value,"onUpdate:modelValue":n[6]||(n[6]=U=>j.value=U),closable:!0,"close-on-backdrop":!0,title:"پشتیبانی"},{default:Q(()=>[e("div",{class:"px-4 pb-6 pt-2"},[e("div",{class:"space-y-3"},[e("button",{onClick:R,class:"w-full flex items-center gap-4 p-4 rounded-2xl border border-border bg-card hover:bg-accent transition-colors group"},[...n[31]||(n[31]=[e("div",{class:"w-12 h-12 rounded-xl bg-green-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-green-500/20 transition-colors"},[e("i",{class:"ti ti-message-circle text-green-500 text-2xl"})],-1),t(),e("div",{class:"flex-1 text-right"},[e("h3",{class:"text-sm font-semibold text-foreground mb-0.5"},"پشتیبانی آنلاین"),t(),e("p",{class:"text-xs text-muted-foreground"},"گفتگو با تیم پشتیبانی")],-1),t(),e("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])]),n[34]||(n[34]=t()),e("button",{onClick:L,class:"w-full flex items-center gap-4 p-4 rounded-2xl border border-border bg-card hover:bg-accent transition-colors group"},[...n[32]||(n[32]=[e("div",{class:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-blue-500/20 transition-colors"},[e("i",{class:"ti ti-help text-blue-500 text-2xl"})],-1),t(),e("div",{class:"flex-1 text-right"},[e("h3",{class:"text-sm font-semibold text-foreground mb-0.5"},"سوالات متداول"),t(),e("p",{class:"text-xs text-muted-foreground"},"پاسخ سوالات پرتکرار")],-1),t(),e("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])]),n[35]||(n[35]=t()),e("button",{onClick:E,class:"w-full flex items-center gap-4 p-4 rounded-2xl border border-border bg-card hover:bg-accent transition-colors group"},[...n[33]||(n[33]=[e("div",{class:"w-12 h-12 rounded-xl bg-purple-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-purple-500/20 transition-colors"},[e("i",{class:"ti ti-phone text-purple-500 text-2xl"})],-1),t(),e("div",{class:"flex-1 text-right"},[e("h3",{class:"text-sm font-semibold text-foreground mb-0.5"},"تماس تلفنی"),t(),e("p",{class:"text-xs text-muted-foreground"},"تماس با پشتیبانی")],-1),t(),e("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])])]),n[36]||(n[36]=t()),n[37]||(n[37]=e("div",{class:"mt-6 p-4 rounded-2xl bg-muted/50 border border-border"},[e("p",{class:"text-xs text-muted-foreground text-center mb-2"},[e("i",{class:"ti ti-clock text-sm ml-1"}),t(`\r
            پاسخگویی: شنبه تا چهارشنبه، ۹ صبح تا ۶ عصر\r
          `)]),t(),e("p",{class:"text-xs text-muted-foreground text-center"},[e("i",{class:"ti ti-mail text-sm ml-1"}),t(`\r
            support@linku.im\r
          `)])],-1))])]),_:1},8,["modelValue"])])}}},ks={key:0,class:"fixed bottom-0 left-0 right-0 bg-card border-t border-border z-40"},Cs={class:"flex items-center justify-around h-20 px-6 relative"},$s=["onClick"],Ss=["href","onClick"],js=["src","alt"],zs=["onClick"],Ps={class:"sticky top-0 w-full z-10 bg-background lg:bg-card border-b border-border flex-shrink-0 lg:rounded-t-2xl"},Ms={class:"flex items-center justify-between px-6 py-4 lg:py-3"},As={class:"flex-1 overflow-y-auto lg:overflow-hidden"},Ts={class:"flex flex-col lg:flex-row lg:h-full"},Bs={class:"lg:w-1/2 lg:border-l lg:border-border p-6 lg:flex lg:flex-col lg:justify-center lg:items-center bg-muted/30"},Ns={class:"flex justify-center mb-6"},Rs={class:"w-7 h-7 rounded-full overflow-hidden flex-shrink-0 ring-2 ring-primary/30"},qs=["src","alt"],Is={class:"text-sm font-medium text-foreground truncate flex-1"},Ls={class:"flex flex-col items-center justify-center mb-6"},Us={class:"p-4 rounded-2xl border-2 border-border shadow-lg bg-white"},Es={class:"px-4 pb-6 pt-2"},Os={class:"space-y-2"},Vs=["onClick"],Ds={class:"relative w-11 h-11 rounded-full overflow-hidden ring-2 ring-border bg-white"},Qs=["src","alt"],Ws={class:"flex-1"},Xs={class:"flex items-center justify-between mb-0.5"},Ys={class:"flex items-center gap-1.5"},Hs={class:"text-sm font-semibold text-primary"},Fs={key:0,class:"ti ti-rosette-discount-check-filled text-primary text-lg"},Ks={key:0,class:"text-xs bg-secondary text-primary border border-border px-2 py-0.5 rounded-full font-medium flex items-center gap-1"},Zs={class:"flex flex-wrap items-center gap-1.5 text-xs text-foreground"},Gs={key:0,class:"font-medium"},Js={class:"mt-3 pt-3"},_s={class:"w-full flex items-center justify-between gap-2 p-3 rounded-2xl bg-secondary border-2 border-dashed border-border hover:bg-accent-bg/30 transition-colors"},eo={key:1,class:"bg-primary text-white px-3 py-1 rounded-full text-xs font-semibold"},to=ve({__name:"BottomNavigation",emits:["open-share"],setup(P,{emit:v}){const x=ze(),w=be(),k=re(),d=pe(),j=M(!1),T=Ie(null),B=M(!1),$=M("لینک کپی شد!"),i=M("success"),A=M(!1),c=M(null),r=(z,s="success")=>{$.value=z,i.value=s,B.value=!0},g=I(()=>k.defaultCard||(k.cards||[]).filter(z=>z.isActive!==!1)[0]||null),h=I(()=>{const z=g.value?.avatar;if(z&&typeof z=="string"&&z.trim().length>0)return z;const s=k.safeProfileImage;if(s&&typeof s=="string"&&s.trim().length>0)return s;const y=d.user?.avatar;return y&&typeof y=="string"&&y.trim().length>0?y:"/logo.svg"}),p=I(()=>d.user?.name||"کاربر"),o=I(()=>d.user?.userName||d.user?.username||""),m=I(()=>(k.cards||[]).filter(s=>s.isActive!==!1));oe(()=>g.value,z=>{z&&!c.value&&(c.value=z)},{immediate:!0});const f=I(()=>{if(typeof window>"u")return"https://linku.im";const z=window.location.origin,s=o.value||p.value||"profile";return`${z}/${s}`}),S=I(()=>d.user?.isPro||!1),b=I(()=>[{id:"profile",icon:"ti ti-user",label:"پروفایل",path:"/profile",isActive:w.path.includes("/profile")},{id:"analytics",icon:"ti ti-chart-line",label:"تحلیل‌ها",path:"/dashboard/insights",isActive:w.path.includes("/dashboard/insights")},{id:"share",icon:"ti ti-brand-telegram",label:"",action:"share",isCenter:!0},{id:"search",icon:"ti ti-search",label:"جستجو",path:"/dashboard/search",action:"search"},{id:"dashboard",avatarUrl:h.value,label:"داشبورد",path:"/dashboard",isActive:w.path==="/dashboard"||w.path.startsWith("/dashboard")&&!w.path.includes("/insights")}]),u=z=>{z.path?x.push(z.path):z.action==="share"&&R()},R=()=>{j.value=!0,ae(()=>{L()})},L=async()=>{if(T.value)try{await(await he(async()=>{const{default:G}=await import("./Bw9k-xBj.js").then(K=>K.b);return{default:G}},__vite__mapDeps([0,1]),import.meta.url)).default.toCanvas(T.value,f.value,{width:200,margin:1,color:{dark:"#000000",light:"#ffffff"},errorCorrectionLevel:"H"});const s=T.value.getContext("2d");if(!s)return;const y=c.value?.avatar||c.value?.logo||h.value,X=new Image;X.crossOrigin="anonymous",X.onload=()=>{s.fillStyle="#ffffff",s.beginPath(),s.arc(100,100,50/2+4,0,2*Math.PI),s.fill(),s.save(),s.beginPath(),s.arc(100,100,50/2,0,2*Math.PI),s.clip(),s.drawImage(X,100-50/2,100-50/2,50,50),s.restore(),S.value&&c.value?.avatar&&(s.strokeStyle="#ffd700",s.lineWidth=2,s.beginPath(),s.arc(100,100,50/2,0,2*Math.PI),s.stroke())},X.onerror=()=>{},X.src=y}catch{}},E=async()=>{try{await navigator.clipboard.writeText(f.value),r("لینک کپی شد!","success")}catch{}},q=async()=>{try{const z=(await he(async()=>{const{default:G}=await import("./Bw9k-xBj.js").then(K=>K.b);return{default:G}},__vite__mapDeps([0,1]),import.meta.url)).default,s=document.createElement("canvas");s.width=1e3,s.height=1e3,await z.toCanvas(s,f.value,{width:1e3,margin:2,color:{dark:"#000000",light:"#ffffff"},errorCorrectionLevel:"H"});const y=s.getContext("2d");if(y){const G=c.value?.avatar||c.value?.logo||h.value;if(G&&G!=="/logo.svg"){const K=new Image;K.crossOrigin="anonymous",await new Promise(ge=>{K.onload=()=>{y.fillStyle="#ffffff",y.beginPath(),y.arc(500,500,250/2+20,0,2*Math.PI),y.fill(),y.save(),y.beginPath(),y.arc(500,500,250/2,0,2*Math.PI),y.clip(),y.drawImage(K,500-250/2,500-250/2,250,250),y.restore(),S.value&&c.value?.avatar&&(y.strokeStyle="#ffd700",y.lineWidth=8,y.beginPath(),y.arc(500,500,250/2+4,0,2*Math.PI),y.stroke()),ge()},K.onerror=()=>ge(),K.src=G})}}const X=document.createElement("a");X.href=s.toDataURL("image/png",1),X.download=`qr-${c.value?.slug||"profile"}-1000x1000.png`,X.click(),r("کیوآر کد با کیفیت بالا ذخیره شد!","success")}catch(z){console.error("Error downloading QR:",z),r("خطا در ذخیره کیوآر کد","error")}},n=async()=>{if(navigator.share)try{await navigator.share({title:`پروفایل ${c.value?.name||"من"}`,text:"پروفایل من را در لینکو ببینید!",url:f.value})}catch(z){z?.name!=="AbortError"&&E()}else E()},D=()=>{x.push("/profile/customize-link"),j.value=!1},U=()=>{x.push("/QR"),j.value=!1},_=()=>{const z=`پروفایل من را ببینید: ${f.value}`,s=/iPad|iPhone|iPod/.test(navigator.userAgent);window.location.href=s?`sms:&body=${encodeURIComponent(z)}`:`sms:?body=${encodeURIComponent(z)}`},le=()=>{const z=`پروفایل ${c.value?.name||"من"}`,s=`سلام،

پروفایل من را در لینکو ببینید:
${f.value}`;window.location.href=`mailto:?subject=${encodeURIComponent(z)}&body=${encodeURIComponent(s)}`},ee=()=>{const z=`پروفایل من را ببینید: ${f.value}`;window.open(`https://wa.me/?text=${encodeURIComponent(z)}`,"_blank")},te=()=>{const z=`پروفایل من را ببینید: ${f.value}`;window.open(`https://t.me/share/url?url=${encodeURIComponent(f.value)}&text=${encodeURIComponent(z)}`,"_blank")},se=async()=>{await E();const z=/iPad|iPhone|iPod/.test(navigator.userAgent),s=/Android/.test(navigator.userAgent);z?window.location.href="instagram://app":s?window.location.href="intent://instagram.com/#Intent;package=com.instagram.android;scheme=https;end":window.open("https://www.instagram.com/","_blank")},ne=()=>{n()},me=z=>{c.value=z,A.value=!1,ae(()=>L())},Pe=()=>{if(A.value=!1,!S.value){x.push("/dashboard/checkout");return}if(m.value.length>=5){r("حداکثر 5 پروفایل مجاز است","warning");return}x.push("/dashboard/add-card")},Me=()=>{x.push("/dashboard/checkout")};return oe(j,z=>{z&&ae(()=>L())}),(z,s)=>(l(),a("div",null,[j.value?C("",!0):(l(),a("div",ks,[e("div",Cs,[(l(!0),a(Y,null,F(b.value,y=>(l(),a(Y,{key:y.id},[y.isCenter?(l(),a("button",{key:0,onClick:X=>u(y),class:"w-16 h-16 bg-primary rounded-3xl flex items-center justify-center shadow-xl -mt-10 transition-all duration-200 hover:scale-105 hover:shadow-2xl"},[e("i",{class:W([y.icon,"text-primary-foreground font-bold text-4xl"])},null,2)],8,$s)):y.avatarUrl?(l(),a("a",{key:1,href:y.path,onClick:$e(X=>u(y),["prevent"]),class:"flex flex-col items-center justify-center p-3 transition-all duration-200 min-w-12"},[e("div",{class:W(["w-7 h-7 rounded-full overflow-hidden transition-all duration-200 border-2",y.isActive?"border-primary scale-110 ring-2 ring-primary/20":"border-muted-foreground/30 hover:border-primary/50"])},[e("img",{src:y.avatarUrl,alt:y.label,class:"w-full h-full object-cover"},null,8,js)],2)],8,Ss)):(l(),a("div",{key:2,onClick:X=>u(y),class:W(["flex flex-col items-center justify-center p-3 transition-all duration-200 min-w-12 relative cursor-pointer",y.isActive?"text-primary":"text-muted-foreground hover:text-foreground"])},[e("i",{class:W([y.icon,"text-2xl"])},null,2)],10,zs))],64))),128))])])),s[67]||(s[67]=t()),V(J,{modelValue:j.value,"onUpdate:modelValue":s[2]||(s[2]=y=>j.value=y),size:"full",closable:!1,"close-on-backdrop":!0},{default:Q(()=>[e("div",Ps,[e("div",Ms,[s[6]||(s[6]=e("h3",{class:"text-lg font-semibold text-foreground"},"اشتراک‌گذاری",-1)),s[7]||(s[7]=t()),e("button",{onClick:s[0]||(s[0]=y=>j.value=!1),class:"w-8 h-8 rounded-full bg-muted hover:bg-muted/80 flex items-center justify-center transition-colors"},[...s[5]||(s[5]=[e("i",{class:"ti ti-x text-foreground text-base"},null,-1)])])])]),s[56]||(s[56]=t()),e("div",As,[e("div",Ts,[e("div",Bs,[e("div",Ns,[e("button",{onClick:s[1]||(s[1]=y=>A.value=!0),class:"flex items-center gap-2 p-3 bg-background hover:bg-muted/80 rounded-full border border-border min-w-[164px] transition-colors"},[e("div",Rs,[e("img",{src:c.value?.avatar||h.value,alt:p.value,class:"w-full h-full object-cover"},null,8,qs)]),s[8]||(s[8]=t()),e("span",Is,N(p.value),1),s[9]||(s[9]=t()),s[10]||(s[10]=e("i",{class:"ti ti-chevron-down text-muted-foreground flex-shrink-0"},null,-1))])]),s[12]||(s[12]=t()),e("div",Ls,[e("div",Us,[e("canvas",{ref_key:"qrCanvas",ref:T,width:"200",height:"200",class:"rounded-lg"},null,512)])]),s[13]||(s[13]=t()),e("div",{class:"flex justify-center"},[e("button",{onClick:n,class:"flex items-center gap-3 px-10 py-3 bg-primary text-primary-foreground rounded-full font-semibold text-base hover:opacity-90 transition-opacity shadow-lg"},[...s[11]||(s[11]=[e("i",{class:"ti ti-share-2 text-lg"},null,-1),t(`\r
                اشتراک‌گذاری\r
              `,-1)])])])]),s[55]||(s[55]=t()),e("div",{class:"lg:w-1/2 p-6 lg:overflow-y-auto"},[e("div",{class:"lg:hidden space-y-0 bg-card rounded-2xl overflow-hidden border border-border shadow-sm"},[e("button",{onClick:E,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[14]||(s[14]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-link text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"کپی لینک",-1)])]),s[24]||(s[24]=t()),e("button",{onClick:D,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[15]||(s[15]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-edit text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"سفارشی‌سازی لینک",-1)])]),s[25]||(s[25]=t()),e("button",{onClick:U,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[16]||(s[16]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-qrcode text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"سفارشی‌سازی کیوآر کد",-1)])]),s[26]||(s[26]=t()),e("button",{onClick:q,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[17]||(s[17]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-photo text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"ذخیره در گالری",-1)])]),s[27]||(s[27]=t()),e("button",{onClick:_,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[18]||(s[18]=[e("div",{class:"w-9 h-9 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-message text-blue-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"ارسال پیامک",-1)])]),s[28]||(s[28]=t()),e("button",{onClick:le,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[19]||(s[19]=[e("div",{class:"w-9 h-9 rounded-xl bg-red-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-mail text-red-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"ارسال ایمیل",-1)])]),s[29]||(s[29]=t()),e("button",{onClick:ee,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[20]||(s[20]=[e("div",{class:"w-9 h-9 rounded-xl bg-green-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-whatsapp text-green-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"اشتراک در واتساپ",-1)])]),s[30]||(s[30]=t()),e("button",{onClick:se,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[21]||(s[21]=[e("div",{class:"w-9 h-9 rounded-xl bg-pink-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-instagram text-pink-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"اشتراک در اینستاگرام",-1)])]),s[31]||(s[31]=t()),e("button",{onClick:te,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[22]||(s[22]=[e("div",{class:"w-9 h-9 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-telegram text-blue-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"اشتراک در تلگرام",-1)])]),s[32]||(s[32]=t()),e("button",{onClick:ne,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all"},[...s[23]||(s[23]=[e("div",{class:"w-9 h-9 rounded-xl bg-muted flex items-center justify-center"},[e("i",{class:"ti ti-dots text-muted-foreground text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"روش‌های دیگر",-1)])])]),s[54]||(s[54]=t()),e("div",{class:"hidden lg:block"},[s[52]||(s[52]=e("h4",{class:"text-sm font-semibold text-muted-foreground mb-4"},"روش‌های اشتراک‌گذاری",-1)),s[53]||(s[53]=t()),e("div",{class:"grid grid-cols-4 gap-3"},[e("button",{onClick:E,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[33]||(s[33]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-link text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"کپی لینک",-1)])]),s[43]||(s[43]=t()),e("button",{onClick:D,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[34]||(s[34]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-edit text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"سفارشی لینک",-1)])]),s[44]||(s[44]=t()),e("button",{onClick:U,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[35]||(s[35]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-qrcode text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"سفارشی QR",-1)])]),s[45]||(s[45]=t()),e("button",{onClick:q,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[36]||(s[36]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-photo text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"ذخیره QR",-1)])]),s[46]||(s[46]=t()),e("button",{onClick:_,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[37]||(s[37]=[e("div",{class:"w-11 h-11 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-message text-blue-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"پیامک",-1)])]),s[47]||(s[47]=t()),e("button",{onClick:le,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[38]||(s[38]=[e("div",{class:"w-11 h-11 rounded-xl bg-red-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-mail text-red-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"ایمیل",-1)])]),s[48]||(s[48]=t()),e("button",{onClick:ee,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[39]||(s[39]=[e("div",{class:"w-11 h-11 rounded-xl bg-green-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-whatsapp text-green-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"واتساپ",-1)])]),s[49]||(s[49]=t()),e("button",{onClick:se,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[40]||(s[40]=[e("div",{class:"w-11 h-11 rounded-xl bg-pink-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-instagram text-pink-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"اینستاگرام",-1)])]),s[50]||(s[50]=t()),e("button",{onClick:te,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[41]||(s[41]=[e("div",{class:"w-11 h-11 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-telegram text-blue-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"تلگرام",-1)])]),s[51]||(s[51]=t()),e("button",{onClick:ne,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[42]||(s[42]=[e("div",{class:"w-11 h-11 rounded-xl bg-muted flex items-center justify-center"},[e("i",{class:"ti ti-dots text-muted-foreground text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"بیشتر",-1)])])])])])])])]),_:1},8,["modelValue"]),s[68]||(s[68]=t()),B.value?(l(),Z(De,{key:1,title:$.value,type:i.value,onClose:s[3]||(s[3]=y=>B.value=!1)},null,8,["title","type"])):C("",!0),s[69]||(s[69]=t()),V(J,{modelValue:A.value,"onUpdate:modelValue":s[4]||(s[4]=y=>A.value=y),closable:!0,"close-on-backdrop":!0,title:"انتخاب پروفایل"},{default:Q(()=>[e("div",Es,[s[64]||(s[64]=e("p",{class:"text-sm text-primary opacity-60 text-center mb-4"},"پروفایل مورد نظر خود را انتخاب کنید",-1)),s[65]||(s[65]=t()),e("div",Os,[(l(!0),a(Y,null,F(m.value,y=>(l(),a("div",{key:y.id,onClick:X=>me(y),class:W(["flex items-center gap-3 p-3 rounded-2xl border cursor-pointer transition-colors",c.value?.id===y.id?"bg-primary/5 border-primary":"bg-secondary border-border hover:bg-accent-bg/30"])},[e("div",Ds,[e("img",{src:y.avatar||"/logo.svg",alt:y.name,class:"w-full h-full object-cover"},null,8,Qs)]),s[61]||(s[61]=t()),e("div",Ws,[e("div",Xs,[e("div",Ys,[e("h3",Hs,N(p.value),1),s[57]||(s[57]=t()),S.value?(l(),a("i",Fs)):C("",!0)]),s[59]||(s[59]=t()),c.value?.id===y.id?(l(),a("span",Ks,[...s[58]||(s[58]=[e("i",{class:"ti ti-check text-xs"},null,-1),t(`\r
                  پیش‌فرض\r
                `,-1)])])):C("",!0)]),s[60]||(s[60]=t()),e("div",Zs,[o.value?(l(),a("span",Gs,`\r
                  @`+N(o.value),1)):C("",!0)])])],10,Vs))),128))]),s[66]||(s[66]=t()),e("div",Js,[e("div",_s,[e("div",{onClick:Pe,class:"flex items-center gap-2 flex-1 cursor-pointer"},[...s[62]||(s[62]=[e("div",{class:"w-11 h-11 rounded-full bg-accent-bg ring-2 ring-border flex items-center justify-center"},[e("i",{class:"ti ti-plus text-primary text-sm"})],-1),t(),e("span",{class:"text-sm font-medium text-primary"},`\r
                ایجاد پروفایل جدید\r
              `,-1)])]),s[63]||(s[63]=t()),S.value?(l(),a("div",eo,`\r
              کاربر ویژه\r
            `)):(l(),a("div",{key:0,onClick:Me,class:"bg-primary text-white px-3 py-1 rounded-full text-xs font-semibold cursor-pointer"},`\r
              خرید اشتراک\r
            `))])])])]),_:1},8,["modelValue"])]))}}),so=fe(to,[["__scopeId","data-v-8a5f6fd5"]]),oo={class:"flex flex-col items-center gap-4 mb-8 border-b border-gray-100 pb-4"},ro={class:"my-16"},lo={class:"relative flex justify-between gap-4"},no=["value"],ao={key:0,class:"text-xs text-blue-500 mt-1"},io={class:"mt-6"},uo={class:"grid grid-cols-2 gap-y-4 gap-x-4 pr-1"},co=["href"],fo={class:"flex items-center gap-2"},mo={class:"text-sm font-medium"},go={__name:"ShareModal",props:{visible:Boolean,card:Object},emits:["close"],setup(P,{emit:v}){const x=P,{getIconComponent:w}=We(),k=M(""),d=M("/logo/logo.png"),j=M(!1),T=M(null);oe(()=>x.card,r=>{r!=null?(d.value=r.qrLogo??"/logo/logo.png",k.value=r.slug?`https://linku.im/profile/${r.slug}/share`:"https://linku.im/profile/MA5PZ1jq/share"):(d.value="/logo/logo.png",k.value="https://linku.im/profile/MA5PZ1jq/share")});const B=()=>{navigator.clipboard.writeText(k.value),j.value=!0,setTimeout(()=>j.value=!1,2e3)},$=async(r,g)=>{if(!T.value||!k.value)return;await xe.toCanvas(T.value,k.value,{width:160,margin:1,errorCorrectionLevel:"H",color:{dark:g,light:r}});const h=T.value.getContext("2d"),p=new Image;p.src=d.value,p.crossOrigin="anonymous",await p.decode();const o=160,m=o*.35,f=(o-m)/2,S=(o-m)/2;h.save(),h.beginPath();const b=8;h.moveTo(f+b,S),h.lineTo(f+m-b,S),h.quadraticCurveTo(f+m,S,f+m,S+b),h.lineTo(f+m,S+m-b),h.quadraticCurveTo(f+m,S+m,f+m-b,S+m),h.lineTo(f+b,S+m),h.quadraticCurveTo(f,S+m,f,S+m-b),h.lineTo(f,S+b),h.quadraticCurveTo(f,S,f+b,S),h.closePath(),h.fillStyle="#ffffff",h.fill(),h.clip();const u=m*.15,R=Math.min((m-2*u)/p.width,(m-2*u)/p.height),L=p.width*R,E=p.height*R,q=f+(m-L)/2,n=S+(m-E)/2;h.drawImage(p,q,n,L,E),h.restore()},i=async(r,g)=>{const p=document.createElement("canvas");p.width=800,p.height=800;const o=p.getContext("2d");await xe.toCanvas(p,k.value,{errorCorrectionLevel:"H",width:800,margin:2,color:{dark:g,light:r}});const m=new Image;m.src=d.value,m.crossOrigin="anonymous",await m.decode();const f=800*.35,S=(800-f)/2,b=(800-f)/2;o.save(),o.beginPath();const u=24;o.moveTo(S+u,b),o.lineTo(S+f-u,b),o.quadraticCurveTo(S+f,b,S+f,b+u),o.lineTo(S+f,b+f-u),o.quadraticCurveTo(S+f,b+f,S+f-u,b+f),o.lineTo(S+u,b+f),o.quadraticCurveTo(S,b+f,S,b+f-u),o.lineTo(S,b+u),o.quadraticCurveTo(S,b,S+u,b),o.closePath(),o.fillStyle="#ffffff",o.fill(),o.clip();const R=f*.12,L=Math.min((f-2*R)/m.width,(f-2*R)/m.height),E=m.width*L,q=m.height*L,n=S+(f-E)/2,D=b+(f-q)/2;o.drawImage(m,n,D,E,q),o.restore();const U=document.createElement("a");U.href=p.toDataURL("image/png"),U.download="qr-high-quality.png",U.click()},A=Xe();oe(()=>x.visible,async r=>{r&&(await A.fetchCard(x.card.id),d.value=A.activeCard?.qrLogo??"/logo/logo.png",k.value=`https://linku.im/profile/${A.activeCard?.slug}/share`,r&&setTimeout(()=>{$(A.activeCard.qrColor?A.activeCard.qrColor:"#000000",A.activeCard.qrBgColor?A.activeCard.qrBgColor:"#ffffff")},50))},{immediate:!0});const c=I(()=>[{name:"ایمیل",iconComponent:w({type:"component",name:"email"}),url:`mailto:?subject=کارت دیجیتال من&body=مشاهده کارت من: ${k.value}`},{name:"لینکدین",iconComponent:w({type:"component",name:"linkedin"}),url:`https://www.linkedin.com/sharing/share-offsite/?url=${k.value}`},{name:"تلگرام",iconComponent:w({type:"component",name:"telegram"}),url:`https://t.me/share/url?url=${k.value}`},{name:"واتساپ",iconComponent:w({type:"component",name:"whatsapp"}),url:`https://api.whatsapp.com/send?text=${encodeURIComponent("مشاهده کارت من: "+k.value)}`}]);return(r,g)=>{const h=J;return l(),Z(h,{visible:P.visible,title:"اشتراک کارت",onClose:g[1]||(g[1]=p=>r.$emit("close"))},{default:Q(()=>[e("div",oo,[e("canvas",{ref_key:"qrCanvas",ref:T,width:"160",height:"160",class:"rounded-lg"},null,512),g[3]||(g[3]=t()),e("button",{onClick:g[0]||(g[0]=p=>i(P.card.qrColor?P.card.qrColor:"#000000",P.card.qrBgColor?P.card.qrBgColor:"#ffffff")),class:"flex items-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-5 py-2 rounded-full font-medium mt-2"},[...g[2]||(g[2]=[e("i",{class:"ti ti-download"},null,-1),t(`\r
        دانلود QR کد\r
      `,-1)])])]),g[14]||(g[14]=t()),e("div",ro,[g[6]||(g[6]=e("p",{class:"text-sm font-semibold mb-4"},"کپی لینک کارت",-1)),g[7]||(g[7]=t()),e("div",lo,[e("input",{readonly:"",value:k.value,class:"w-full bg-gray-100 text-sm text-gray-700 py-4 px-3 rounded-2xl ltr:pr-20 rtl:pl-20"},null,8,no),g[5]||(g[5]=t()),e("button",{onClick:B,class:"text-blue-500 text-sm font-medium flex items-center justify-end gap-1 w-28"},[...g[4]||(g[4]=[e("i",{class:"ti ti-copy text-base"},null,-1),t(` کپی لینک\r
        `,-1)])])]),g[8]||(g[8]=t()),j.value?(l(),a("p",ao,"کپی شد!")):C("",!0)]),g[15]||(g[15]=t()),e("div",io,[g[12]||(g[12]=e("p",{class:"text-sm font-semibold mb-4"},"اشتراک از طریق",-1)),g[13]||(g[13]=t()),e("div",uo,[(l(!0),a(Y,null,F(c.value,p=>(l(),a("a",{key:p.name,href:p.url,target:"_blank",rel:"noreferrer",class:"flex items-center justify-between text-gray-700 rounded-lg px-4 py-3 bg-gray-100 hover:bg-gray-50 transition"},[e("div",fo,[(l(),Z(Le(Ue(p.iconComponent)),{size:24})),g[9]||(g[9]=t()),e("span",mo,N(p.name),1)]),g[10]||(g[10]=t()),g[11]||(g[11]=e("i",{class:"ti ti-external-link opacity-50"},null,-1))],8,co))),128))])])]),_:1},8,["visible"])}}};async function xo(P,v){try{const[x,w]=await Promise.all([v.get(`v1/cards/${P}/leads/leadsCount`),v.get(`v1/cards/${P}/forms/formsCount`)]),k=x.data.data||{},d=w.data.data||{};return{unreadCount:(k.unreadCount??0)+(d.unreadCount??0),totalCount:(k.totalCount??0)+(d.totalCount??0)}}catch{return{unreadCount:0,totalCount:0}}}async function bo(P,v){try{return(await v.get(`v1/cards/${P}/votes`)).data?.total_votes||0}catch{return 0}}async function vo(P,v){try{const x=await v.get(`club/${P}/luckyDice/resultCount`),{totalCount:w,unreadCount:k}=x.data.data||{};return{totalCount:w??0,unreadCount:k??0}}catch{return{totalCount:0,unreadCount:0}}}async function po(P,v){try{const x=await v.get(`club/${P}/luckyEgg/resultCount`),{totalCount:w,unreadCount:k}=x.data.data||{};return{totalCount:w??0,unreadCount:k??0}}catch{return{totalCount:0,unreadCount:0}}}async function ho(P,v){try{const x=await v.get(`club/${P}/luckyWheel/resultCount`),{totalCount:w,unreadCount:k}=x.data.data||{};return{totalCount:w??0,unreadCount:k??0}}catch{return{totalCount:0,unreadCount:0}}}const wo={class:"flex items-center gap-2 overflow-hidden"},yo=["src"],ko={key:1,class:"bg-gray-100 rounded-full w-7 h-7 flex items-center justify-center"},Co={class:"truncate font-medium hidden md:block text-gray-700"},$o={key:2,class:"text-xs font-semibold bg-gray-100 text-black px-2 py-0.5 rounded-full hidden md:inline"},So={key:0,class:"absolute mt-4 left-0 w-72 bg-white border rounded-xl shadow-xl z-50"},jo={key:0,class:"px-4 py-3 border-b"},zo={class:"flex items-center gap-2"},Po=["src"],Mo={class:"font-medium text-gray-700"},Ao={class:"text-xs text-gray-500"},To={class:"px-4 py-3 border-b max-h-40 overflow-y-auto"},Bo={class:"space-y-3"},No=["onClick"],Ro=["src"],qo={class:"flex-1"},Io={class:"font-medium flex items-center gap-1 text-gray-700"},Lo={key:0,class:"text-xs bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full"},Uo={key:0,class:"text-xs text-gray-500"},Eo={key:1,class:"ti ti-check text-green-600"},Oo={key:0,class:"text-xs text-gray-500 text-center py-2"},Vo={key:0,class:"mb-6 transform transition-all duration-200"},Do={class:"flex items-center gap-3 p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors"},Qo=["src"],Wo={key:1,class:"bg-gray-100 rounded-full w-12 h-12 flex items-center justify-center"},Xo={class:"flex-1"},Yo={class:"font-semibold text-base text-gray-800"},Ho={key:0,class:"text-sm text-gray-500"},Fo={key:1,class:"mb-6"},Ko={class:"space-y-2"},Zo=["onClick"],Go=["src"],Jo={key:1,class:"bg-gray-100 rounded-full w-12 h-12 flex items-center justify-center"},_o={class:"flex-1"},er={class:"font-semibold text-base text-gray-800"},tr={key:0,class:"text-sm text-gray-500"},sr={key:2,class:"ti ti-check text-green-600 text-xl"},or={key:2,class:"text-sm text-gray-500 text-center py-4 mb-6"},rr=ve({__name:"CardSelect",setup(P){const v=re(),x=M(!1),w=M(null),k=M(!1),d=I(()=>v.defaultCard||{id:"default",name:"کارت من",avatar:null,isDefault:!1,description:"پیش‌فرض"}),j=I(()=>!v.cards||!d.value?[]:v.cards.filter(c=>c.id!==d.value?.id)),T=c=>{c.stopPropagation(),x.value=!x.value},B=async c=>{v.setDefaultCard(c.id),x.value=!1;const r=v.defaultCard?.id;if(!r)return;const{$axios:g}=ie(),h=await xo(r,g),p=await bo(r,g),o=await vo(r,g),m=await po(r,g),f=await ho(r,g),S=h+p+o+m+f;v.setInboxBadge(S)},$=async()=>{x.value=!1,await H("/dashboard/add-card")},i=c=>{w.value?.contains(c.target)||(x.value=!1)};function A(){k.value=window.innerWidth<768}return ce(()=>{document.addEventListener("click",i),A(),window.addEventListener("resize",A)}),je(()=>{document.removeEventListener("click",i),window.removeEventListener("resize",A)}),(c,r)=>{const g=J;return l(),a("div",{ref_key:"dropdownRef",ref:w,class:"relative z-50 w-20 md:w-72 text-sm text-right rtl"},[e("button",{onClick:T,class:"w-full rounded-full border border-gray-300 px-4 py-1.5 flex items-center justify-between bg-white"},[e("div",wo,[d.value?.avatar?(l(),a("img",{key:0,src:d.value.avatar,class:"w-6 h-6 rounded-full object-cover"},null,8,yo)):(l(),a("span",ko,[...r[1]||(r[1]=[e("i",{class:"ti ti-user text-xl text-gray-400"},null,-1)])])),r[2]||(r[2]=t()),e("span",Co,N(d.value?.name||"کارت من"),1),r[3]||(r[3]=t()),d.value?.isDefault?(l(),a("span",$o,`\r
          پیش‌فرض\r
        `)):C("",!0)]),r[4]||(r[4]=t()),r[5]||(r[5]=e("i",{class:"ti ti-chevron-down text-xs"},null,-1))]),r[33]||(r[33]=t()),x.value&&!k.value?(l(),a("div",So,[d.value?(l(),a("div",jo,[r[8]||(r[8]=e("h3",{class:"text-xs text-gray-500 mb-2 flex items-center gap-1"},[e("i",{class:"ti ti-eye"}),t(` در حال مشاهده\r
        `)],-1)),r[9]||(r[9]=t()),e("div",zo,[d.value.avatar?(l(),a("img",{key:0,src:d.value.avatar,class:"w-8 h-8 rounded-full object-cover"},null,8,Po)):C("",!0),r[7]||(r[7]=t()),e("div",null,[e("p",Mo,N(d.value.name),1),r[6]||(r[6]=t()),e("p",Ao,N(d.value.description),1)])])])):C("",!0),r[17]||(r[17]=t()),e("div",To,[r[13]||(r[13]=e("h3",{class:"text-xs text-gray-500 mb-2 flex items-center gap-1"},[e("i",{class:"ti ti-id"}),t(` کارت‌های دیگر\r
        `)],-1)),r[14]||(r[14]=t()),e("div",Bo,[(l(!0),a(Y,null,F(j.value,h=>(l(),a("div",{key:h.id,onClick:p=>B(h),class:"flex items-center gap-3 cursor-pointer hover:bg-gray-100 p-2 rounded-lg"},[h.avatar?(l(),a("img",{key:0,src:h.avatar,class:"w-8 h-8 rounded-full object-cover"},null,8,Ro)):C("",!0),r[11]||(r[11]=t()),e("div",qo,[e("p",Io,[t(N(h.name)+" ",1),h.isDefault?(l(),a("span",Lo,`\r
                  پیش‌فرض\r
                `)):C("",!0)]),r[10]||(r[10]=t()),h.description?(l(),a("p",Uo,N(h.description),1)):C("",!0)]),r[12]||(r[12]=t()),h.id===d.value?.id?(l(),a("i",Eo)):C("",!0)],8,No))),128))]),r[15]||(r[15]=t()),j.value.length===0?(l(),a("p",Oo,`\r
          کارت دیگری وجود ندارد\r
        `)):C("",!0)]),r[18]||(r[18]=t()),e("div",{class:"p-4"},[e("button",{onClick:$,class:"w-full bg-black text-white py-2 rounded-full flex items-center justify-center gap-2"},[...r[16]||(r[16]=[e("i",{class:"ti ti-plus"},null,-1),t(` ایجاد پروفایل جدید\r
        `,-1)])])])])):C("",!0),r[34]||(r[34]=t()),V(g,{visible:x.value&&k.value,title:"انتخاب کارت","height-class":"max-h-[calc(100vh-80px)]","content-padding":"p-4",onClose:r[0]||(r[0]=h=>x.value=!1)},{default:Q(()=>[d.value?(l(),a("div",Vo,[r[22]||(r[22]=e("h3",{class:"text-sm text-gray-500 mb-3 flex items-center gap-2"},[e("i",{class:"ti ti-eye"}),t(` در حال مشاهده\r
        `)],-1)),r[23]||(r[23]=t()),e("div",Do,[d.value.avatar?(l(),a("img",{key:0,src:d.value.avatar,class:"w-12 h-12 rounded-full object-cover shadow-sm"},null,8,Qo)):(l(),a("span",Wo,[...r[19]||(r[19]=[e("i",{class:"ti ti-user text-2xl text-gray-400"},null,-1)])])),r[21]||(r[21]=t()),e("div",Xo,[e("p",Yo,N(d.value.name),1),r[20]||(r[20]=t()),d.value.description?(l(),a("p",Ho,N(d.value.description),1)):C("",!0)])])])):C("",!0),r[31]||(r[31]=t()),j.value.length>0?(l(),a("div",Fo,[r[28]||(r[28]=e("h3",{class:"text-sm text-gray-500 mb-3 flex items-center gap-2"},[e("i",{class:"ti ti-id"}),t(` کارت‌های دیگر\r
        `)],-1)),r[29]||(r[29]=t()),e("div",Ko,[(l(!0),a(Y,null,F(j.value,h=>(l(),a("div",{key:h.id,onClick:p=>B(h),class:"flex items-center gap-3 cursor-pointer hover:bg-gray-50 active:bg-gray-100 p-4 rounded-xl transition-all duration-150 transform hover:scale-[0.98]"},[h.avatar?(l(),a("img",{key:0,src:h.avatar,class:"w-12 h-12 rounded-full object-cover shadow-sm"},null,8,Go)):(l(),a("span",Jo,[...r[24]||(r[24]=[e("i",{class:"ti ti-user text-2xl text-gray-400"},null,-1)])])),r[26]||(r[26]=t()),e("div",_o,[e("p",er,N(h.name),1),r[25]||(r[25]=t()),h.description?(l(),a("p",tr,N(h.description),1)):C("",!0)]),r[27]||(r[27]=t()),h.id===d.value?.id?(l(),a("i",sr)):C("",!0)],8,Zo))),128))])])):(l(),a("p",or,`\r
        کارت دیگری وجود ندارد\r
      `)),r[32]||(r[32]=t()),e("button",{onClick:$,class:"w-full bg-gray-900 hover:bg-black text-white py-3 rounded-xl flex items-center justify-center gap-2 text-base font-medium transition-all duration-200 transform active:scale-[0.98] shadow-lg"},[...r[30]||(r[30]=[e("i",{class:"ti ti-plus"},null,-1),t(` ایجاد پروفایل جدید\r
      `,-1)])])]),_:1},8,["visible"])],512)}}}),lr={class:"flex bg-background min-h-screen overflow-hidden transition-colors duration-300"},nr={class:"flex-1 flex flex-col relative"},Sr=ve({__name:"default",setup(P){const v=pe(),x=Ae(),w=re(),{$axios:k}=ie(),d=be(),j=I(()=>d.path.includes("/notifications")||d.path.includes("/inbox")||d.path.includes("/QR")||d.path.includes("/profile/CustomizeQRPage")||d.path.includes("/profile/CustomizeLinkPage")||d.path.includes("/profile/lead-capture")||d.path.includes("/dashboard/activate")||d.path.includes("/dashboard/support")||d.path.includes("/dashboard/transactions")||d.path.includes("/dashboard/rewards")||d.path.includes("/financial")||d.path.includes("/settings")||d.path.includes("/rewards")),T=I(()=>d.path.includes("/checkout/order")||d.path.includes("/QR")||d.path.includes("/profile/CustomizeQRPage")||d.path.includes("/dashboard/edit-card")||d.path.includes("/dashboard/activate"));ce(async()=>{x.hydrateToken(),x.isAuthenticated?(await v.fetchUser(),w.cards=v.cards):H("/auth/login")});const B=M(!1),$=M(""),i=p=>{if(p.includes("/edit-card"))return{title:"ویرایش پروفایل",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!0,showNotifications:!1,showShare:!0,showAddCard:!1,showCardSelect:!1,showStateSelect:!1};if(p.includes("/add-card"))return{title:"افزودن پروفایل جدید",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1};const o={"/dashboard/activate":{title:"فعال‌سازی کارت",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard/dashboard":{title:"پروفایل‌های من",showBack:!1,userName:v.user?.name,showSearch:!0,showMore:!0,showNotifications:!0,showShare:!1,showAddCard:!0,showCardSelect:!0,showStateSelect:!1},"/dashboard/insights":{title:"تحلیل و آمار",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!0,showShare:!1,showAddCard:!1,showCardSelect:!0,showStateSelect:!1},"/dashboard/notifications":{title:"اعلان‌ها",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard/support":{title:"پشتیبانی",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard/transactions":{title:"تراکنش‌ها",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!0},"/dashboard/upgrade":{title:"خرید اشتراک",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard":{title:"پروفایل‌های من",showBack:!1,userName:v.user?.name,showSearch:!0,showMore:!0,showNotifications:!0,showShare:!1,showAddCard:!0,showCardSelect:!0,showStateSelect:!1},"/settings":{title:"تنظیمات",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/inbox":{title:"صندوق دریافتی",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/settings/account-status":{title:"وضعیت حساب",showBack:!0,userName:v.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1}};for(const[m,f]of Object.entries(o))if(p.startsWith(m))return f;return{title:"داشبورد",showBack:!1,userName:v.user?.name,showSearch:!1,showMore:!0,showNotifications:!0,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1}},A=I(()=>i(d.path));d.params.slug;const c=M({});function r(p){c.value=p,B.value=!0}const g=p=>{switch(p){case"show-profile":h(w.defaultCard?.slug);break;case"open-share":r(w.defaultCard);break}},h=p=>{const o=new URLSearchParams;o.set("t",Date.now().toString());const m=`${window.location.origin}/preview/${p}?${o.toString()}`;window.open(m,"_blank")};return Ee("topbarConfig",A),(p,o)=>{const m=ke,f=Te;return l(),a("div",lr,[e("div",nr,[j.value?C("",!0):(l(),Z(ys,{key:0})),o[3]||(o[3]=t()),V(Gt,Oe(A.value,{search:$.value,"onUpdate:search":o[0]||(o[0]=S=>$.value=S),userLogo:O(v).user?.avatar||"",userPhone:O(v).user.phone||"",cardSlug:O(w).defaultCard?.slug,qrBgColor:O(w).defaultCard?.qrBgColor,qrColor:O(w).defaultCard?.qrColor,onOpenShare:r,onAction:g}),{"card-select":Q(()=>[V(m,null,{default:Q(()=>[V(rr)]),_:1})]),_:1},16,["search","userLogo","userPhone","cardSlug","qrBgColor","qrColor"]),o[4]||(o[4]=t()),e("div",{class:W(["flex-1 overflow-y-auto lg:pb-4",[j.value?"pt-0":"pt-20",T.value?"pb-0":"pb-20",O(d).path.includes("/checkout")||T.value?"":"lg:px-4 px-2"]])},[V(f,{search:$.value,onOpenShare:r},null,8,["search"])],2),o[5]||(o[5]=t()),T.value?C("",!0):(l(),Z(so,{key:1,onOpenShare:o[1]||(o[1]=S=>r(O(w).defaultCard))}))]),o[6]||(o[6]=t()),V(go,{visible:B.value,card:c.value,onClose:o[2]||(o[2]=S=>B.value=!1)},null,8,["visible","card"])])}}});export{Sr as default};
