import{n as w}from"#entry";import{y as L,r as k,d as g,j as B,k as l,q as e,p as o,v as f,l as D,u as n,Q as b,R as v,x as i,M as u,L as F,O as V}from"./Ct89Yiyn.js";import{u as E}from"./BKn2-9y8.js";import{u as I}from"./C1aQa-TZ.js";import"./CU4qPF7-.js";import"./ngrFHoWO.js";const P={class:"min-h-screen bg-background"},q={class:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-card border-b border-border"},A={class:"flex items-center justify-between px-4 h-16"},O={class:"hidden lg:block bg-card border-b border-border sticky top-0 z-40"},Q={class:"px-4 lg:px-6 py-6"},h={class:"flex items-center justify-between"},G={class:"flex items-center gap-3"},H={key:0,class:"flex items-center gap-6 px-6 py-3 bg-muted rounded-xl"},J={class:"text-center"},K={class:"text-lg font-bold text-foreground"},U={class:"text-center"},W={class:"text-lg font-bold text-foreground"},X={class:"text-center"},Y={class:"text-lg font-bold text-foreground"},Z={class:"lg:pt-0 pt-20 pb-24 lg:pb-8"},tt={class:"px-4 lg:px-6 py-6"},et={key:0,class:"space-y-6 animate-pulse"},st={class:"space-y-4"},ot={key:1},rt={class:"mb-6"},lt={class:"flex items-center gap-3 overflow-x-auto lg:overflow-visible pb-2 lg:justify-start"},nt=["onClick"],it={class:"space-y-4 lg:grid lg:grid-cols-2 xl:grid-cols-3 lg:gap-6 lg:space-y-0"},dt={key:0,class:"bg-card border border-border p-8 rounded-xl text-center"},at=["onClick"],ut={class:"flex items-start justify-between mb-3"},xt={class:"flex-1"},pt={class:"flex items-center gap-2 mb-2 flex-wrap"},mt={class:"font-medium text-foreground lg:text-base"},gt={class:"text-sm text-muted-foreground mb-4 line-clamp-2"},ft={key:0,class:"mb-4"},bt={class:"flex items-center justify-between mb-1.5"},vt={class:"text-xs font-medium text-primary"},yt={class:"w-full bg-muted rounded-full h-2"},ct={class:"flex items-center gap-4 text-xs text-muted-foreground mb-4 lg:mb-0"},wt={class:"flex items-center gap-1.5"},kt={class:"flex items-center gap-1.5"},Dt={class:"pt-3 mt-auto border-t border-border"},Ct=["onClick","disabled"],Tt={key:0},jt={key:1},Rt={class:"font-mono"},Nt={key:1,class:"flex items-center justify-center gap-2 text-sm py-2.5 px-4 rounded-lg bg-muted text-muted-foreground"},$t={class:"opacity-50 font-mono"},Mt={class:"mr-2 text-xs"},Et=L({__name:"rewards",setup(_t){const d=E(),y=I(),a=k(null),x=k("all"),C=[{label:"همه",value:"all"},{label:"فعال",value:"active"},{label:"استفاده شده",value:"used"},{label:"منقضی",value:"expired"}],c=g(()=>x.value==="all"?d.rewards:d.rewards.filter(r=>r.status===x.value)),T=g(()=>d.activeRewards.length),j=g(()=>d.usedRewards.length),R=g(()=>d.expiredRewards.length),N=r=>{if(!r)return"نامشخص";const t=new Date(r);return isNaN(t.getTime())?"نامشخص":new Intl.DateTimeFormat("fa-IR").format(t)},p=r=>{if(!r)return 0;const t=new Date,s=new Date(r);if(isNaN(s.getTime()))return 0;const m=s.getTime()-t.getTime();return Math.ceil(m/(1e3*3600*24))},$=r=>{const s=p(r);return s<=0?0:Math.max(0,Math.min(100,s/30*100))},M=r=>{switch(r){case"active":return"bg-green-500/10 text-green-500";case"expired":return"bg-red-500/10 text-red-500";case"used":return"bg-gray-500/10 text-gray-500";default:return"bg-secondary text-secondary"}},_=r=>{switch(r){case"active":return"فعال";case"expired":return"منقضی";case"used":return"استفاده شده";default:return"نامشخص"}},S=async r=>{a.value=r;try{if(navigator.clipboard)await navigator.clipboard.writeText(r);else{const t=document.createElement("textarea");t.value=r,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}y.success(`کد ${r} کپی شد`),setTimeout(()=>{a.value=null},1500)}catch{y.error("امکان کپی کردن کد تخفیف وجود ندارد"),a.value=null}},z=r=>{w(`/rewards/discount/${r}`)};return B(async()=>{await d.fetchRewards()}),(r,t)=>(i(),l("div",P,[e("div",q,[e("div",A,[e("button",{onClick:t[0]||(t[0]=s=>("navigateTo"in r?r.navigateTo:f(w))("/profile")),class:"p-2 hover:bg-muted rounded-lg transition-colors"},[...t[1]||(t[1]=[e("i",{class:"ti ti-arrow-right text-foreground text-xl"},null,-1)])]),t[2]||(t[2]=o()),t[3]||(t[3]=e("h1",{class:"text-lg font-bold text-foreground"},"تخفیفات و جوایز",-1)),t[4]||(t[4]=o()),t[5]||(t[5]=e("div",{class:"w-10"},null,-1))])]),t[43]||(t[43]=o()),e("div",O,[e("div",Q,[e("div",h,[t[18]||(t[18]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground mb-1"},"تخفیفات و جوایز"),o(),e("p",{class:"text-sm text-muted-foreground"},"مدیریت کدهای تخفیف خود")],-1)),t[19]||(t[19]=o()),e("div",G,[f(d).isLoading?D("",!0):(i(),l("div",H,[e("div",J,[t[6]||(t[6]=e("p",{class:"text-xs text-muted-foreground mb-1"},"فعال",-1)),t[7]||(t[7]=o()),e("p",K,n(T.value),1)]),t[12]||(t[12]=o()),t[13]||(t[13]=e("div",{class:"w-px h-8 bg-border"},null,-1)),t[14]||(t[14]=o()),e("div",U,[t[8]||(t[8]=e("p",{class:"text-xs text-muted-foreground mb-1"},"استفاده شده",-1)),t[9]||(t[9]=o()),e("p",W,n(j.value),1)]),t[15]||(t[15]=o()),t[16]||(t[16]=e("div",{class:"w-px h-8 bg-border"},null,-1)),t[17]||(t[17]=o()),e("div",X,[t[10]||(t[10]=e("p",{class:"text-xs text-muted-foreground mb-1"},"منقضی",-1)),t[11]||(t[11]=o()),e("p",Y,n(R.value),1)])]))])])])]),t[44]||(t[44]=o()),e("div",Z,[e("div",tt,[f(d).isLoading?(i(),l("div",et,[t[20]||(t[20]=e("div",{class:"bg-muted rounded-2xl p-6 h-32"},null,-1)),t[21]||(t[21]=o()),e("div",st,[(i(),l(b,null,v(4,s=>e("div",{key:s,class:"bg-card border border-border p-4 rounded-xl h-32"})),64))])])):(i(),l("div",ot,[e("div",rt,[e("div",lt,[(i(),l(b,null,v(C,s=>e("button",{key:s.value,onClick:m=>x.value=s.value,class:u(["flex-shrink-0 px-4 py-2.5 rounded-xl text-sm font-medium transition-all",x.value===s.value?"bg-primary text-primary-foreground shadow-sm":"bg-muted text-muted-foreground hover:bg-muted/80"])},n(s.label),11,nt)),64))])]),t[42]||(t[42]=o()),e("div",it,[c.value.length===0?(i(),l("div",dt,[...t[22]||(t[22]=[e("i",{class:"ti ti-discount-off text-muted-foreground text-4xl mb-4"},null,-1),o(),e("h4",{class:"font-medium text-foreground mb-2"},"هیچ تخفیفی یافت نشد",-1),o(),e("p",{class:"text-sm text-muted-foreground"},"در این دسته تخفیفی موجود نیست",-1)])])):(i(!0),l(b,{key:1},v(c.value,s=>(i(),l("div",{key:s.id,class:u(["bg-card border border-border p-5 lg:p-6 rounded-xl transition-all flex flex-col",s.status==="active"?"cursor-pointer hover:shadow-lg hover:border-primary/30":"opacity-60"]),onClick:m=>s.status==="active"?z(s.id):null},[e("div",ut,[e("div",xt,[e("div",pt,[e("h4",mt,n(s.title),1),t[23]||(t[23]=o()),e("span",{class:u(["text-xs px-2.5 py-1 rounded-full font-medium",M(s.status)])},n(_(s.status)),3)]),t[30]||(t[30]=o()),e("p",gt,n(s.description),1),t[31]||(t[31]=o()),s.status==="active"&&p(s.expiryDate)<=7&&p(s.expiryDate)>0?(i(),l("div",ft,[e("div",bt,[t[24]||(t[24]=e("span",{class:"text-xs text-muted-foreground"},"زمان باقی‌مانده",-1)),t[25]||(t[25]=o()),e("span",vt,n(p(s.expiryDate))+` روز\r
                    `,1)]),t[26]||(t[26]=o()),e("div",yt,[e("div",{class:"bg-primary h-2 rounded-full transition-all duration-300",style:F({width:`${$(s.expiryDate)}%`})},null,4)])])):D("",!0),t[32]||(t[32]=o()),e("div",ct,[e("span",wt,[t[27]||(t[27]=e("i",{class:"ti ti-percentage"},null,-1)),o(" "+n(s.value)+n(s.type==="percentage"?"%":" ریال"),1)]),t[29]||(t[29]=o()),e("span",kt,[t[28]||(t[28]=e("i",{class:"ti ti-calendar"},null,-1)),o(" "+n(N(s.expiryDate)),1)])])]),t[33]||(t[33]=o()),t[34]||(t[34]=e("div",{class:"w-14 h-14 lg:w-16 lg:h-16 bg-gradient-to-br from-primary/10 to-primary/5 rounded-xl flex items-center justify-center border border-primary/20"},[e("i",{class:"ti ti-discount text-primary text-2xl lg:text-3xl"})],-1))]),t[41]||(t[41]=o()),e("div",Dt,[s.status==="active"?(i(),l("button",{key:0,onClick:V(m=>S(s.code),["stop"]),disabled:a.value===s.code,class:u(["w-full flex items-center justify-center gap-2 text-sm py-2.5 px-4 rounded-lg font-medium transition-all",a.value===s.code?"bg-green-500/10 text-green-500 border border-green-500/20":"bg-primary text-primary-foreground hover:opacity-90 hover:shadow-md"])},[e("i",{class:u([a.value===s.code?"ti ti-check":"ti ti-copy","text-base"])},null,2),t[37]||(t[37]=o()),a.value===s.code?(i(),l("span",Tt,`\r
                  کپی شد!\r
                `)):(i(),l("span",jt,[e("span",Rt,n(s.code),1),t[35]||(t[35]=o()),t[36]||(t[36]=e("span",{class:"mr-1"},"کپی کد",-1))]))],10,Ct)):(i(),l("div",Nt,[t[38]||(t[38]=e("i",{class:"ti ti-copy text-base opacity-50"},null,-1)),t[39]||(t[39]=o()),e("span",$t,n(s.code),1),t[40]||(t[40]=o()),e("span",Mt,n(s.status==="expired"?"(منقضی)":"(استفاده شده)"),1)]))])],10,at))),128))])]))])])]))}});export{Et as default};
