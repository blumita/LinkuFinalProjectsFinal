import{n as y}from"#entry";import{y as j,r as T,d as R,j as S,k as a,q as s,p as r,v as b,Q as f,R as g,x as n,s as $,M as u,l as M,u as i,L as N,O as w}from"./Ct89Yiyn.js";import{u as P}from"./BKn2-9y8.js";import{u as V}from"./C1aQa-TZ.js";import{_ as z}from"./DlAUqK2U.js";import"./CU4qPF7-.js";import"./ngrFHoWO.js";const B={class:"fixed top-0 left-0 right-0 z-50 bg-card border-b divide-border"},I={class:"flex items-center justify-between px-4 h-16"},L={class:"pt-[68px] pb-20"},E={key:0,class:"space-y-6 animate-pulse px-6"},F={class:"space-y-4"},q={key:1,class:"px-4"},A={class:"space-y-4"},O={key:0,class:"bg-card border border-border p-8 rounded-xl text-center"},Q=["onClick"],G={class:"flex items-start justify-between mb-3"},H={class:"flex-1"},J={class:"flex items-center gap-2 mb-2"},K={class:"font-medium text-primary"},U={class:"text-sm text-secondary mb-3"},W={key:0,class:"mb-3"},X={class:"flex items-center justify-between mb-1"},Y={class:"text-xs font-medium accent-text"},Z={class:"w-full bg-secondary rounded-full h-2"},ee={class:"flex items-center gap-4 text-xs text-secondary"},te={class:"flex items-center gap-1"},se={class:"flex items-center gap-1"},re={class:"w-16 h-16 rounded-xl flex items-center justify-center border border-border overflow-hidden flex-shrink-0"},oe=["src","alt"],ae={key:1,class:"w-full h-full bg-secondary flex items-center justify-center"},ne={class:"flex items-center justify-between pt-3 border-t divide-border"},ie={class:"flex-1"},de=["onClick","disabled"],le={key:0},ce={key:1},ue={key:1,class:"flex items-center justify-center gap-2 text-sm py-2.5 px-4 rounded-lg bg-secondary text-secondary"},pe={class:"opacity-50"},xe={class:"mr-3"},me=["onClick"],ve={key:1,class:"text-sm text-secondary opacity-50 px-2"},ye=j({__name:"RewardsPage",setup(be){const p=P(),x=V(),d=T(null),m=R(()=>p.rewards),k=o=>{const e=new Date(o);return new Intl.DateTimeFormat("fa-IR").format(e)},l=o=>{const e=new Date("2025-09-24"),c=new Date(o).getTime()-e.getTime();return Math.ceil(c/(1e3*3600*24))},_=o=>{const t=l(o);return t<=0?0:Math.max(0,Math.min(100,t/30*100))},D=o=>{switch(o){case"active":return"bg-success/10 text-success border border-success/20";case"expired":return"bg-warning/10 text-warning border border-warning/20";case"used":return"bg-muted text-muted-foreground border border-muted";default:return"bg-muted text-muted-foreground"}},h=o=>{switch(o){case"active":return"فعال";case"expired":return"منقضی";case"used":return"استفاده شده";default:return"نامشخص"}},C=async o=>{d.value=o;try{if(navigator.clipboard)await navigator.clipboard.writeText(o);else{const e=document.createElement("textarea");e.value=o,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e)}x.success(`کد ${o} کپی شد`),setTimeout(()=>{d.value=null},1500)}catch{x.error("امکان کپی کردن کد تخفیف وجود ندارد"),d.value=null}},v=o=>{y(`/rewards/discount/${o}`)};return S(async()=>{await p.fetchRewards()}),(o,e)=>(n(),a("div",null,[s("div",B,[s("div",I,[s("button",{onClick:e[0]||(e[0]=t=>("navigateTo"in o?o.navigateTo:b(y))("/profile")),class:"p-2 hover:bg-secondary rounded-lg transition-colors"},[...e[1]||(e[1]=[s("i",{class:"ti ti-arrow-right text-primary text-xl"},null,-1)])]),e[2]||(e[2]=r()),e[3]||(e[3]=s("h1",{class:"text-lg font-bold text-primary"},"تخفیفات و جوایز",-1)),e[4]||(e[4]=r()),e[5]||(e[5]=s("div",{class:"w-10"},null,-1))])]),e[26]||(e[26]=r()),s("div",L,[b(p).isLoading?(n(),a("div",E,[s("div",F,[(n(),a(f,null,g(4,t=>s("div",{key:t,class:"bg-card border border-border p-4 rounded-xl"},[...e[6]||(e[6]=[$('<div class="flex items-start justify-between mb-3" data-v-18ccce42><div class="flex-1 space-y-2" data-v-18ccce42><div class="h-5 w-32 bg-muted rounded" data-v-18ccce42></div> <div class="h-4 w-48 bg-muted-foreground/20 rounded" data-v-18ccce42></div> <div class="h-4 w-20 bg-muted-foreground/20 rounded" data-v-18ccce42></div></div> <div class="w-16 h-16 bg-muted rounded-xl" data-v-18ccce42></div></div>',1)])])),64))])])):(n(),a("div",q,[s("div",A,[m.value.length===0?(n(),a("div",O,[...e[7]||(e[7]=[s("i",{class:"ti ti-discount-off text-secondary text-4xl mb-4"},null,-1),r(),s("h4",{class:"font-medium text-primary mb-2"},"هیچ تخفیفی یافت نشد",-1),r(),s("p",{class:"text-sm text-secondary"},"در حال حاضر تخفیف فعالی ندارید",-1)])])):(n(!0),a(f,{key:1},g(m.value,t=>(n(),a("div",{key:t.id,class:u(["bg-card border border-border p-4 rounded-xl transition-colors",t.status==="active"?"cursor-pointer hover:bg-muted/30":"opacity-60 cursor-not-allowed"]),onClick:c=>t.status==="active"?v(t.id):null},[s("div",G,[s("div",H,[s("div",J,[s("h4",K,i(t.title),1),e[8]||(e[8]=r()),s("span",{class:u(["text-xs px-2 py-1 rounded-full",D(t.status)])},i(h(t.status)),3)]),e[15]||(e[15]=r()),s("p",U,i(t.description),1),e[16]||(e[16]=r()),t.status==="active"&&l(t.expiryDate)<=7&&l(t.expiryDate)>0?(n(),a("div",W,[s("div",X,[e[9]||(e[9]=s("span",{class:"text-xs text-secondary"},"زمان باقی‌مانده",-1)),e[10]||(e[10]=r()),s("span",Y,i(l(t.expiryDate))+` روز\r
                    `,1)]),e[11]||(e[11]=r()),s("div",Z,[s("div",{class:"accent-bg h-2 rounded-full transition-all duration-300",style:N({width:`${_(t.expiryDate)}%`})},null,4)])])):M("",!0),e[17]||(e[17]=r()),s("div",ee,[s("span",te,[e[12]||(e[12]=s("i",{class:"ti ti-percentage"},null,-1)),r(" "+i(t.value)+i(t.type==="percentage"?"%":" ریال"),1)]),e[14]||(e[14]=r()),s("span",se,[e[13]||(e[13]=s("i",{class:"ti ti-calendar"},null,-1)),r(" "+i(k(t.expiryDate)),1)])])]),e[19]||(e[19]=r()),s("div",re,[t.banner||t.image?(n(),a("img",{key:0,src:t.banner||t.image,alt:t.title,class:"w-full h-full object-cover"},null,8,oe)):(n(),a("div",ae,[...e[18]||(e[18]=[s("i",{class:"ti ti-discount accent-text text-2xl"},null,-1)])]))])]),e[25]||(e[25]=r()),s("div",ne,[s("div",ie,[t.status==="active"?(n(),a("button",{key:0,onClick:w(c=>C(t.code),["stop"]),disabled:d.value===t.code,class:u(["w-full flex items-center justify-center gap-2 text-sm py-2.5 px-4 rounded-lg font-medium transition-all",d.value===t.code?"bg-green-500/10 text-green-500 border border-green-500/20":"accent-bg accent-text hover:opacity-90 border border-border"])},[s("i",{class:u([d.value===t.code?"ti ti-check":"ti ti-copy","text-base"])},null,2),e[20]||(e[20]=r()),d.value===t.code?(n(),a("span",le,`\r
                    کپی شد!\r
                  `)):(n(),a("span",ce,`\r
                    کپی کد: `+i(t.code),1))],10,de)):(n(),a("div",ue,[e[21]||(e[21]=s("i",{class:"ti ti-copy text-base opacity-50"},null,-1)),e[22]||(e[22]=r()),s("span",pe,i(t.code),1)]))]),e[24]||(e[24]=r()),s("div",xe,[t.status==="active"?(n(),a("button",{key:0,onClick:w(c=>v(t.id),["stop"]),class:"text-sm accent-text hover:opacity-80 transition-colors flex items-center gap-1 px-2"},[...e[23]||(e[23]=[r(`\r
                  جزئیات\r
                  `,-1),s("i",{class:"ti ti-chevron-left text-xs"},null,-1)])],8,me)):(n(),a("span",ve,i(t.status==="expired"?"منقضی":"استفاده شده"),1))])])],10,Q))),128))])]))])]))}}),Ce=z(ye,[["__scopeId","data-v-18ccce42"]]);export{Ce as default};
