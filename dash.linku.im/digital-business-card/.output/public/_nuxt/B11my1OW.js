import{_ as Te}from"./CgleJCdt.js";import{k as f,x as c,q as s,p as i,l as Q,M as W,Q as J,O as Y,r as C,d as L,a7 as Le,F as T,H as te,v as m,u as X,R as pe,y as De,f as me,L as Ae,S as be,N as Ue,P as Re,D as xe,j as $e,K as Ie,w as ge,I as ne,n as je,i as Ve,s as Be,T as Me}from"./Ct89Yiyn.js";import{u as oe,d as Ne}from"./lVmvsOkf.js";import{u as Se,_ as le,a as Oe,b as ze,c as Ee,C as Fe,d as We,e as we,E as se}from"./FxhSDkxu.js";import{I as Pe}from"./CFRFqJJ0.js";import{I as ye}from"./DGzIcDwE.js";import{u as Je}from"./AuYbrIUI.js";import{a as ve,s as qe}from"#entry";import{d as He}from"./MnsCIIQl.js";import{u as Ye}from"./Drvv-Qqv.js";import{u as Ke}from"./C1aQa-TZ.js";import{_ as ke}from"./DlAUqK2U.js";import"./CU4qPF7-.js";import"./hWjkn-YR.js";import"./BwRPt94S.js";import"./DUksgA9l.js";import"./BRBG3GYJ.js";import"./ngrFHoWO.js";import"./CE1G-McA.js";const Ge={class:"flex flex-col items-center"},Qe=["disabled"],Ze=["src"],Xe={key:1,class:"flex flex-col items-center justify-center text-center px-1"},_e={class:"text-[10px] text-muted-foreground mt-1 leading-tight"},fe={__name:"ImageUploader",props:{image:String,field:String,aspectRatio:Number,wide:Boolean,disabled:Boolean},emits:["select","remove"],setup(k,{emit:j}){const $=k,n=j,V=o=>{if($.disabled)return;const p=o.target.files[0];p&&n("select",{file:p,field:$.field,aspectRatio:$.aspectRatio}),o.target.value=""},D=()=>{$.disabled||n("remove",$.field)};return(o,p)=>(c(),f("div",Ge,[s("div",{class:W(["relative",k.wide?"w-full h-32 rounded-lg":"w-28 h-28 rounded-full"])},[s("div",{class:W(["w-full h-full bg-card border border-border flex items-center justify-center transition overflow-hidden",k.wide?"rounded-lg":"rounded-full",k.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer hover:border-primary"])},[s("input",{type:"file",accept:"image/*,video/*,.gif",class:W(["absolute inset-0 opacity-0 w-full",k.disabled?"cursor-not-allowed":"cursor-pointer"]),disabled:k.disabled,onChange:V},null,42,Qe),p[1]||(p[1]=i()),k.image?(c(),f("img",{key:0,src:k.image,class:W(["w-full h-full object-cover",k.wide?"rounded-lg":"rounded-full"])},null,10,Ze)):(c(),f("div",Xe,[s("i",{class:W(["text-2xl text-muted-foreground",k.wide?"ti ti-photo":"ti ti-user"])},null,2),p[0]||(p[0]=i()),s("span",_e,[k.disabled?(c(),f(J,{key:0},[i("غیرفعال")],64)):k.field==="profileImage"?(c(),f(J,{key:1},[i("عکس پروفایل")],64)):k.field==="coverImage"?(c(),f(J,{key:2},[i("عکس هدر")],64)):k.field==="logoImage"?(c(),f(J,{key:3},[i("لوگو شرکت")],64)):(c(),f(J,{key:4},[i("انتخاب فایل")],64))])]))],2),p[3]||(p[3]=i()),k.image&&!k.disabled?(c(),f("button",{key:0,type:"button",class:"absolute -top-0 right-2 w-6 h-6 bg-background border border-border text-muted-foreground rounded-full flex items-center justify-center hover:bg-destructive hover:text-destructive-foreground transition text-xs shadow",onClick:Y(D,["stop"])},[...p[2]||(p[2]=[s("i",{class:"ti ti-x text-sm"},null,-1)])])):Q("",!0)],2)]))}},et={class:"space-y-3"},tt={class:"flex flex-wrap justify-between items-center w-full"},at={class:"flex gap-2"},st={class:"text-sm font-semibold text-gray-800 hidden md:block"},nt={class:"relative text-sm"},lt={key:0,class:"absolute right-0 mt-1 w-40 bg-white border border-gray-200 rounded shadow z-10 text-right text-gray-700"},ot=["onClick"],it={class:"grid grid-cols-1 sm:grid-cols-3 gap-2 border p-4 border-gray-200 rounded-lg"},rt={class:"space-y-4"},dt={class:"grid grid-cols-1"},ut={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ct={class:"grid grid-cols-1"},mt={class:"bg-gray-100 p-4 rounded-2xl space-y-4"},ft={key:0,class:"flex justify-between items-center pt-4 border-t"},pt={class:"text-sm"},gt={key:0,class:"text-green-600 flex items-center"},vt={key:1,class:"text-red-600 flex items-center"},bt={key:2,class:"text-gray-600"},yt=["disabled"],kt={key:1,class:"flex justify-end space-x-3 pt-4"},xt=["disabled"],wt={key:1},he={__name:"TabAbout",props:{isAddMode:{type:Boolean,default:!1}},emits:["go-to-next-step"],setup(k,{emit:j}){const $=k,n=j,{$axios:V}=ve(),D=oe(),o=oe();C(!1);const p=C(!1),F=C({show:!1,imageFile:void 0,aspectRatio:1,fieldName:""}),q=C(!1),A=L(()=>!!(o.name&&o.name.trim().length>0&&!I.value)),I=L(()=>!o.name||o.name.trim().length===0?$.isAddMode?"نام کامل الزامی است":"":o.name.trim().length<2?"نام باید حداقل ۲ کاراکتر باشد":o.name.length>40?"حداکثر ۴۰ کاراکتر مجاز است":/^[آ-یa-zA-Z\s]+$/.test(o.name.trim())?"":"فقط حروف فارسی، انگلیسی و فاصله مجاز است"),x=L(()=>o.formSaved),P=()=>{A.value&&!x.value&&M()},z=C(""),K=C(!1),E=C(""),B=C("ti-alert-triangle"),R=(g,t="ti-lock")=>{E.value=g,B.value=t,K.value=!0,setTimeout(()=>K.value=!1,3e3)};function Z({file:g,field:t,aspectRatio:u}){F.value={show:!0,imageFile:g,aspectRatio:u,fieldName:t}}function H(g){!g||!F.value.fieldName||(o[F.value.fieldName]=g,G())}function G(){F.value={show:!1,imageFile:void 0,aspectRatio:1,fieldName:""}}function b(g){o[g]=null}async function a(){const g=new CustomEvent("manual-save",{detail:{source:"about-form"}});window.dispatchEvent(g);const t=new FormData;t.append("cardName",o.cardName||""),t.append("name",o.name||""),t.append("location",o.location||""),t.append("job",o.job||""),t.append("company",o.company||""),t.append("bio",o.bio||""),t.append("saveContact",o.saveContact||""),t.append("themeColor",JSON.stringify(o.themeColor||{})),t.append("iconColor",JSON.stringify(o.iconColor||{})),t.append("matchThemeColor",o.matchThemeColor?1:0),t.append("layout",o.layout||"");try{const u=await V.post("v1/cards",t);if(u.data.success){const S=u.data.data;await d(S.id),D.addCard(S),z.value=u.data.message,n("go-to-next-step",z.value)}else R(u.data.message,"ti-alert-triangle")}catch(u){if(u.response){const S=u.response.status,v=u.response.data;R(v.message,"ti-alert-circle")}else R("اتصال به سرور ممکن نیست.","ti-alert-triangle")}finally{q.value=!0}}async function d(g){const t=["profileImage","coverImage","logoImage"],u=new FormData;u.append("modelType","card"),u.append("modelId",g||"");function S(v,h){const U=atob(v.split(",")[1]),de=new ArrayBuffer(U.length),ae=new Uint8Array(de);for(let ue=0;ue<U.length;ue++)ae[ue]=U.charCodeAt(ue);return new Blob([de],{type:h})}for(const v of t){const h=o[v];if(h)if(typeof h=="string"&&h.startsWith("data:")){const U=S(h,"image/png");u.append(v,U,`${v}.png`)}else u.append(v,h)}try{const{$axios:v}=ve();(await v.post(`file-manager/${g}/upload`,u)).data.success?R("تصاویر با موفقیت آپلود شدند","ti-image"):R("آپلود تصاویر با خطا مواجه شد","ti-alert-triangle")}catch{R("خطا در آپلود تصاویر","ti-alert-triangle")}}function M(){q.value||(q.value=!0,a())}function N(){o.$reset()}function O(){p.value=!0}function ie(){p.value=!1}function _(g){o.cardName=g,p.value=!1}const ee=C(!1),re={right:"راست‌چین",left:"چپ‌چین",center:"وسط‌چین",portrait:"پرتره"},ce=L(()=>re[o.layout]),l=()=>ee.value=!ee.value,e=g=>{o.layout=g,ee.value=!1},r=L(()=>typeof o.cardName=="string"&&o.cardName.trim()!==""?o.cardName:"نام کارت را وارد کنید"),y=Se(),w=Je();return Le(async()=>{const g=D.newCard.id;if(!g)return;await y.fetchLinks(g),o.links=y.links,await w.fetchCard(g);const t=w.activeCard.fields;Array.isArray(t)&&(o.fields=t),(!Array.isArray(o.fields)||o.fields.length===0)&&(o.fields=structuredClone(Ne))}),(g,t)=>(c(),f(J,null,[s("div",et,[s("div",tt,[s("div",at,[s("div",{class:W(["flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200",[x.value?"cursor-not-allowed opacity-60":"cursor-pointer",typeof m(o).cardName!="string"||!m(o).cardName.trim()?"border-red-500 text-red-600":"border-gray-200 text-gray-700"]]),onClick:O},[t[10]||(t[10]=s("label",{class:"text-sm font-medium text-gray-700 hidden md:block"},"نام کارت:",-1)),t[11]||(t[11]=i()),s("span",st,X(r.value),1),t[12]||(t[12]=i()),s("i",{class:W(["ti ti-pencil text-sm",x.value?"text-gray-300":"text-gray-400"])},null,2)],2),t[14]||(t[14]=i()),s("button",{class:"bg-black text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm sm:hidden",onClick:t[0]||(t[0]=u=>g.$emit("open-preview"))},[...t[13]||(t[13]=[s("i",{class:"ti ti-eye text-base"},null,-1),i(),s("span",{class:"text-sm font-medium"},"پیش‌نمایش",-1)])])]),t[18]||(t[18]=i()),s("div",nt,[s("div",{onClick:l,class:W(["flex items-center gap-1 cursor-pointer bg-gray-50 border border-gray-200 px-3 py-2 rounded-lg",x.value?"text-gray-400 cursor-not-allowed bg-gray-100":"text-gray-700"])},[s("span",null,X(ce.value),1),t[15]||(t[15]=i()),t[16]||(t[16]=s("i",{class:"ti ti-chevron-down text-xs"},null,-1))],2),t[17]||(t[17]=i()),ee.value?(c(),f("ul",lt,[(c(),f(J,null,pe(re,(u,S)=>s("li",{key:S,onClick:v=>e(S),class:"px-3 py-1.5 hover:bg-gray-100 cursor-pointer"},X(u),9,ot)),64))])):Q("",!0)])]),t[35]||(t[35]=i()),s("div",it,[T(fe,{label:"عکس پروفایل",image:m(o).profileImage,field:"profileImage",aspectRatio:1,onSelect:Z,onRemove:b,disabled:x.value},null,8,["image","disabled"]),t[19]||(t[19]=i()),T(fe,{label:"تصویر کاور",image:m(o).coverImage,field:"coverImage",aspectRatio:1.78,wide:"",onSelect:Z,onRemove:b,disabled:x.value},null,8,["image","disabled"]),t[20]||(t[20]=i()),T(fe,{label:"لوگوی شرکت",image:m(o).logoImage,field:"logoImage",aspectRatio:1,onSelect:Z,onRemove:b,disabled:x.value},null,8,["image","disabled"])]),t[36]||(t[36]=i()),s("div",rt,[s("div",dt,[T(le,{label:"نام کامل",modelValue:m(o).name,"onUpdate:modelValue":t[1]||(t[1]=u=>m(o).name=u),placeholder:"نام و نام خانوادگی",maxlength:40,required:!0,error:I.value,disabled:x.value},null,8,["modelValue","error","disabled"])]),t[22]||(t[22]=i()),s("div",ut,[T(le,{label:"سمت شغلی",modelValue:m(o).job,"onUpdate:modelValue":t[2]||(t[2]=u=>m(o).job=u),placeholder:"عنوان شغلی",maxlength:30,error:m(o).job&&m(o).job.length>30?"حداکثر ۳۰ کاراکتر مجاز است":"",disabled:x.value},null,8,["modelValue","error","disabled"]),t[21]||(t[21]=i()),T(le,{label:"شرکت",modelValue:m(o).company,"onUpdate:modelValue":t[3]||(t[3]=u=>m(o).company=u),placeholder:"نام سازمان",maxlength:30,error:m(o).company&&m(o).company.length>30?"حداکثر ۳۰ کاراکتر مجاز است":"",disabled:x.value},null,8,["modelValue","error","disabled"])]),t[23]||(t[23]=i()),s("div",ct,[T(le,{label:"موقعیت جغرافیایی",modelValue:m(o).location,"onUpdate:modelValue":t[4]||(t[4]=u=>m(o).location=u),placeholder:"شهر، کشور",maxlength:30,error:m(o).location&&m(o).location.length>30?"حداکثر ۳۰ کاراکتر مجاز است":"",disabled:x.value},null,8,["modelValue","error","disabled"])])]),t[37]||(t[37]=i()),T(Oe,{label:"بیوگرافی",modelValue:m(o).bio,"onUpdate:modelValue":t[5]||(t[5]=u=>m(o).bio=u),placeholder:"درباره خود توضیح دهید...",maxlength:100,error:m(o).bio&&m(o).bio.length>100?"حداکثر 100 کاراکتر مجاز است":"",disabled:x.value},null,8,["modelValue","error","disabled"]),t[38]||(t[38]=i()),T(le,{label:"عنوان دکمه ذخیره مخاطب",modelValue:m(o).saveContact,"onUpdate:modelValue":t[6]||(t[6]=u=>m(o).saveContact=u),placeholder:"دکمه ذخیره مخاطب",maxlength:20,error:m(o).saveContact&&m(o).saveContact.length>20?"حداکثر ۲۰ کاراکتر مجاز است":"",disabled:x.value},null,8,["modelValue","error","disabled"]),t[39]||(t[39]=i()),s("div",null,[t[25]||(t[25]=s("h3",{class:"text-base font-medium text-gray-600 pb-2"},"بخش رنگ ظاهری کارت",-1)),t[26]||(t[26]=i()),s("div",mt,[T(ze,{themeColor:m(o).themeColor,onUpdate:t[7]||(t[7]=u=>m(o).themeColor=u),disabled:x.value},null,8,["themeColor","disabled"]),t[24]||(t[24]=i()),T(Ee,{selected:m(o).iconColor,"match-theme-color":!1,onUpdate:t[8]||(t[8]=u=>m(o).iconColor=u),"onUpdate:matchTheme":t[9]||(t[9]=u=>m(o).matchThemeColor=u),disabled:x.value},null,8,["selected","disabled"])])]),t[40]||(t[40]=i()),k.isAddMode?(c(),f("div",ft,[s("div",pt,[A.value?(c(),f("span",gt,[...t[27]||(t[27]=[s("i",{class:"ti ti-check ml-1"},null,-1),i(`\r
          آماده برای مرحله بعد\r
        `,-1)])])):I.value?(c(),f("span",vt,[t[28]||(t[28]=s("i",{class:"ti ti-alert-circle ml-1"},null,-1)),i(" "+X(I.value),1)])):(c(),f("span",bt,`\r
          نام کامل را وارد کنید\r
        `))]),t[30]||(t[30]=i()),s("button",{onClick:P,disabled:!A.value,class:W(["px-6 py-3 rounded-md transition-colors text-sm font-medium",{"bg-black hover:bg-gray-800 text-white":A.value,"bg-gray-300 text-gray-500 cursor-not-allowed":!A.value}])},[...t[29]||(t[29]=[s("i",{class:"ti ti-arrow-left ml-1"},null,-1),i(`\r
        ادامه\r
      `,-1)])],10,yt)])):(c(),f("div",kt,[s("button",{onClick:N,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"},`\r
        بازنشانی\r
      `),t[34]||(t[34]=i()),s("button",{onClick:M,disabled:q.value,class:"px-4 py-2 bg-black text-white rounded-md hover:bg-black/90 flex items-center min-w-[140px] justify-center"},[q.value?(c(),f(J,{key:0},[t[31]||(t[31]=s("svg",{class:"animate-spin mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i(),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1)),t[32]||(t[32]=i()),t[33]||(t[33]=s("span",null,"در حال ذخیره اطلاعات...",-1))],64)):(c(),f("span",wt,"ذخیره تغییرات"))],8,xt)])),t[41]||(t[41]=i()),T(Fe,{isOpen:p.value,currentCardName:typeof m(o).cardName=="string"?m(o).cardName:"",onClose:ie,onUpdate:_},null,8,["isOpen","currentCardName"]),t[42]||(t[42]=i()),F.value.show?(c(),te(Pe,{key:2,show:F.value.show,"image-file":F.value.imageFile,"aspect-ratio":F.value.aspectRatio,onClose:G,onSave:H},null,8,["show","image-file","aspect-ratio"])):Q("",!0)]),t[43]||(t[43]=i()),T(ye,{visible:K.value,message:E.value,icon:B.value},null,8,["visible","message","icon"])],64))}},ht={class:"relative w-10 h-10 rounded-xl flex items-center justify-center bg-white"},Ct=["src"],$t={key:0,class:"ti ti-layout-grid text-gray-400 text-xl"},It={key:1,class:"ti ti-link text-gray-400 text-xl"},Nt={class:"flex items-center gap-2"},St={class:"flex flex-col"},Tt={class:"font-semibold text-sm text-black"},Lt={key:0,class:"text-xs text-gray-500 mt-1"},Dt={class:"flex items-center gap-2",style:{opacity:"1 !important"}},At=["checked"],Ut={key:2,class:"px-3 py-2 bg-gray-100 text-gray-400 text-sm font-medium rounded-lg cursor-not-allowed flex items-center gap-1"},Rt=["checked"],jt=De({__name:"LinkItem",props:{link:{},count:{}},emits:["edit","toggle","remove","select-as-single"],setup(k,{emit:j}){const{warning:$}=Ke(),n=k,V=oe(),D=L(()=>!!(V.iconColor?.background&&V.iconColor.background!=="transparent")),o=L(()=>{if(D.value)return V.iconColor.background}),{getIconComponent:p}=Ye(),F=L(()=>n.link.icon||null),q=L(()=>{const a=F.value;if(a&&typeof a=="object"){const d=a;if(d.url)return d.url}return null}),A=me("isBasicLink",null),I=me("singleLink",C(!1)),x=L(()=>typeof I=="boolean"?I:I?.value||!1),P=L(()=>n.link.index===0),z=L(()=>{const a=F.value;return a&&typeof a=="object"?p(a):null});function K(){if(x.value){if(P.value){H("edit",n.link);return}const a=n.link;if(a.type==="block"&&a.action!=="contactcard"){$("انتخاب نامعتبر","فقط بلاک کارت تماس می‌تواند به عنوان اولین لینک انتخاب شود");return}return}H("edit",n.link)}function E(a){a&&(a.stopPropagation(),a.preventDefault()),H("remove",n.link.id)}function B(a){a&&(a.stopPropagation(),a.preventDefault());const d=n.link;if(d.type==="block"&&d.action!=="contactcard"){$("انتخاب نامعتبر","فقط بلاک کارت تماس می‌تواند به عنوان اولین لینک انتخاب شود");return}H("select-as-single",n.link)}function R(a){a&&(a.stopPropagation(),a.preventDefault()),!(n.link.type==="block"&&x.value)&&H("toggle",n.link.id)}function Z(a){a&&(a.stopPropagation(),a.preventDefault()),!(n.link.type==="block"&&x.value)&&H("toggle",n.link.id)}const H=j,G=me("categories",null),b=L(()=>{const a=n.link;if(typeof a.displayName=="string"&&a.displayName.trim())return a.displayName.trim();if(typeof a.title=="string"&&a.title.trim())return a.title.trim();if(typeof a.name=="string"&&a.name.trim())return a.name.trim();if(a.type==="block"&&G&&Array.isArray(G)){for(const d of G)if(d&&typeof d=="object"&&"items"in d&&Array.isArray(d.items)){const M=d.items.find(N=>{if(N&&typeof N=="object"){const O=N;return O.id===a.id||O.name===a.name||O.title===a.title}return!1});if(M&&typeof M=="object"){const N=M;if(N.displayName&&typeof N.displayName=="string"&&N.displayName.trim())return N.displayName.trim();if(N.title&&typeof N.title=="string"&&N.title.trim())return N.title.trim();if(N.name&&typeof N.name=="string"&&N.name.trim())return N.name.trim()}}}return a.type==="block"?"Untitled Block":"Untitled"});return(a,d)=>(c(),f("div",{class:W(["flex items-center justify-between bg-gray-50 rounded-2xl px-4 py-3 transition",{"cursor-pointer hover:bg-gray-100":!x.value||P.value,"touch-action-none user-select-none":x.value&&!P.value}]),style:Ae(x.value&&!P.value?"pointer-events: none; touch-action: none; user-select: none;":""),onClick:K},[s("div",{class:W(["flex items-center gap-3",{"opacity-50":x.value&&!P.value}])},[s("span",{class:"drag-handle text-gray-300 cursor-grab",onClick:d[0]||(d[0]=Y(()=>{},["stop"]))},[...d[1]||(d[1]=[s("i",{class:"ti ti-grip-vertical text-lg"},null,-1)])]),d[4]||(d[4]=i()),s("div",ht,[z.value?(c(),te(be(z.value),{key:0,size:32,color:D.value?o.value:void 0,filled:D.value},null,8,["color","filled"])):q.value?(c(),f("img",{key:1,src:q.value,class:"w-full h-full object-contain",alt:"icon"},null,8,Ct)):(c(),f(J,{key:2},[a.link.type==="block"?(c(),f("i",$t)):(c(),f("i",It))],64))]),d[5]||(d[5]=i()),s("div",Nt,[Ue(s("div",{class:"bg-blue-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center border-2 border-white shadow-md",style:{"pointer-events":"none"}},X(a.count),513),[[Re,a.count>1]]),d[3]||(d[3]=i()),s("div",St,[s("p",Tt,X(b.value),1),d[2]||(d[2]=i()),x.value&&m(A)&&m(A)(a.link)&&P.value?(c(),f("p",Lt,`\r
            Default link\r
          `)):Q("",!0)])])],2),d[18]||(d[18]=i()),s("div",Dt,["enabled"in a.link&&a.link.enabled===!1?(c(),f("button",{key:0,class:"text-gray-400 hover:text-red-700 transition p-2",style:{opacity:"1 !important","min-width":"44px","min-height":"44px"},title:"Delete",onClick:Y(E,["stop","prevent"]),onTouchend:Y(E,["stop","prevent"])},[...d[6]||(d[6]=[s("i",{class:"ti ti-trash text-lg"},null,-1)])],32)):Q("",!0),d[17]||(d[17]=i()),x.value?(c(),f(J,{key:1},[!P.value&&(a.link.type!=="block"||a.link.action==="contactcard")?(c(),f("button",{key:0,class:"px-3 py-2 bg-gray-200 text-gray-600 text-sm font-medium rounded-lg border-none hover:bg-gray-300 transition-all duration-200 flex items-center gap-1 cursor-pointer",style:{opacity:"1 !important",position:"relative","z-index":"10","pointer-events":"auto !important","touch-action":"manipulation !important","user-select":"auto !important","min-height":"44px"},onClick:Y(B,["stop","prevent"]),onTouchend:Y(B,["stop","prevent"])},[...d[7]||(d[7]=[s("i",{class:"ti ti-arrow-up text-xs"},null,-1),i(`\r
          انتخاب به عنوان پیش فرض\r
        `,-1)])],32)):P.value?(c(),f("label",{key:1,class:"relative inline-flex items-center cursor-pointer p-2",style:{opacity:"1 !important","z-index":"10","min-width":"44px","min-height":"44px"},onClick:Y(R,["stop","prevent"]),onTouchend:Y(R,["stop","prevent"])},[s("input",{type:"checkbox",class:"sr-only peer",checked:"enabled"in a.link?a.link.enabled:!0,onChange:Y(Z,["stop","prevent"])},null,40,At),d[8]||(d[8]=i()),d[9]||(d[9]=s("div",{class:"w-11 h-6 bg-gray-300 rounded-full peer peer-checked:bg-black transition-colors"},null,-1)),d[10]||(d[10]=i()),d[11]||(d[11]=s("div",{class:"absolute left-0.5 top-0.5 bg-white w-5 h-5 rounded-full shadow transition-transform peer-checked:translate-x-5"},null,-1))],32)):a.link.type==="block"&&a.link.action!=="contactcard"?(c(),f("span",Ut,[...d[12]||(d[12]=[s("i",{class:"ti ti-ban text-xs"},null,-1),i(`\r
         این گزینه نمی تواند لینک اول انتخاب شود\r
        `,-1)])])):Q("",!0)],64)):(c(),f("label",{key:2,class:"relative inline-flex items-center cursor-pointer p-2",style:{opacity:"1 !important","z-index":"10","min-width":"44px","min-height":"44px"},onClick:Y(R,["stop","prevent"]),onTouchend:Y(R,["stop","prevent"])},[s("input",{type:"checkbox",class:"sr-only peer",checked:"enabled"in a.link?a.link.enabled:!0,onChange:Y(Z,["stop","prevent"])},null,40,Rt),d[13]||(d[13]=i()),d[14]||(d[14]=s("div",{class:"w-11 h-6 bg-gray-300 rounded-full peer peer-checked:bg-black transition-colors"},null,-1)),d[15]||(d[15]=i()),d[16]||(d[16]=s("div",{class:"absolute left-0.5 top-0.5 bg-white w-5 h-5 rounded-full shadow transition-transform peer-checked:translate-x-5"},null,-1))],32))])],6))}}),Vt={class:"flex items-center cursor-pointer select-none gap-2"},Bt={class:"text-sm text-gray-700"},Mt={class:"relative"},Ot=["checked"],zt={__name:"FormSwitch",props:{modelValue:Boolean,label:String},emits:["update:modelValue"],setup(k,{emit:j}){const $=j,n=V=>{$("update:modelValue",V.target.checked)};return(V,D)=>(c(),f("label",Vt,[s("span",Bt,X(k.label),1),D[2]||(D[2]=i()),s("div",Mt,[s("input",{type:"checkbox",class:"sr-only",checked:k.modelValue,onChange:n},null,40,Ot),D[0]||(D[0]=i()),s("div",{class:W(["w-10 h-5 bg-gray-300 rounded-full shadow-inner transition-colors duration-200",k.modelValue?"bg-gray-900":"bg-gray-300"])},null,2),D[1]||(D[1]=i()),s("div",{class:W(["absolute left-0 top-0 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200",k.modelValue?"translate-x-5":"translate-x-0"])},null,2)])]))}},Ce=ke(zt,[["__scopeId","data-v-727b5e18"]]),Et={key:0,class:"border-b"},Ft={class:"flex items-center justify-between p-4 w-full"},Wt={key:1,class:"border-b"},Pt={class:"lg:flex lg:space-y-0 space-y-4 items-center justify-between p-4 w-full"},Jt={class:"lg:flex items-center gap-2 lg:space-y-0 space-y-4 lg:w-2/4"},qt={class:"flex items-center gap-4 lg:w-2/3"},Ht={class:"p-4"},Yt={key:0},Kt={key:0},Gt={key:1,class:"text-center py-8 text-gray-500"},Qt={key:3,class:"mt-8 pt-6 border-t"},Zt={class:"flex justify-between items-center"},Xt={class:"text-sm text-gray-600"},_t={__name:"TabLinks",props:{isAddMode:{type:Boolean,default:!1}},emits:["create-card"],setup(k,{emit:j}){Se();const{$axios:$}=ve(),n=oe(),V=C(!1),D=C(""),o=C("ti-alert-triangle"),p=(l,e="ti-lock")=>{D.value=l,o.value=e,V.value=!0,setTimeout(()=>V.value=!1,3e3)};C(!1),L(()=>!!(n.name&&n.name.trim().length>0));function F(l){return!l||!n.links?1:n.links.filter(e=>e.action===l).length}const q=L(()=>{const l={},e=n.links||[];for(const r of e){const y=String(r.action||r.id||"unknown").toLowerCase();l[y]=(l[y]||0)+1}return l}),A=C(!1),I=C(null),x=C([]);function P(l){if(!l)return!1;const e=["poll","expandabletext","questionbox","leadcapture","form","embeddedvideo","map"];return!(l.action&&e.includes(l.action)||l.description&&String(l.description).trim().length>0)}xe("isBasicLink",P),xe("singleLink",L(()=>n.singleLink)),$e(async()=>{try{n.fields.length||(n.fields=JSON.parse(JSON.stringify(Ne)));let l=null;typeof window<"u"&&(l=qe.getItem("userPhoneNumber")||"09123456789"),z.value=n.singleLink}catch{}}),Ie(()=>{try{I.value=null,A.value=!1,ee.value=!1,window.Sortable&&Object.keys(window.Sortable.active||{}).forEach(l=>{try{window.Sortable.active[l]&&window.Sortable.active[l].destroy()}catch{}})}catch{}});const z=C(n.singleLink);ge(()=>n.singleLink,l=>{z.value=l}),ge(z,l=>{if(l){if(!n.canEnableSingleLink()){je(()=>{z.value=!1});return}n.isLeadCaptureEnabled&&n.toggleLeadCapture(!1)}n.singleLink=l});const K=L({get:()=>n.isLeadCaptureEnabled,set:l=>{n.toggleLeadCapture(l)}});function E(l){return(l||"").toString().trim().toLowerCase()}function B(l){for(const e of x.value)for(const r of e.items||[])if(E(r.id)===E(l.id)||E(r.name)===E(l.name)||E(r.title)===E(l.title))return{action:r.action?.toLowerCase()||null};return{action:null}}function R(l){if(!l||!l.action)return we;const e=l.action.toLowerCase();if(Object.prototype.hasOwnProperty.call(se,e))return se[e];const r=Object.keys(se).find(w=>w.toLowerCase()===e);if(r)return se[r];const y=Object.keys(se).find(w=>w.toLowerCase().includes(e));return y?se[y]:we}function Z(l){const e={...l,type:l.type||(l.action?.includes("block")?"block":"link"),action:l.action?.toLowerCase()||B(l).action,username:l.baseUrl&&l.value?.startsWith(l.baseUrl)?l.value.replace(l.baseUrl,""):l.username||""};e.title||(e.title=l.name||"بدون عنوان"),e.value||(e.value=""),I.value=e}function H(){I.value=null}async function G(l){const e={...l};if(e.baseUrl&&e.username&&(e.value=e.baseUrl+e.username),!e.id)return;const r=e?.customIcon??null,y=e?.fileData??null,w=e?.backgroundImage??null;try{const g={phoneRequired:e.phoneRequired||"",rewards:e.rewards||"",segments:e.segments||"",prizes:e.prizes||"",difficulty:e.difficulty||"",submitButtonText:e.submitButtonText||"",thankYouMessage:e.thankYouMessage||"",avatar:e.avatar||"",align:e.align||"",options:e.options||"",fileName:e.fileName||"",fileType:e.fileType||"",accountHolder:e.accountHolder||"",accountNumber:e.accountNumber||"",bankName:e.bankName||"",cardNumber:e.cardNumber||"",customBank:e.customBank||"",ibanNumber:e.ibanNumber||"",showBankDropdown:e.showBankDropdown||"",highlight:e.highlight||!1,access:e.access||"",address:e.address||"",days:e.days||"",mode:e.mode||"",latitude:e.latitude||"",longitude:e.longitude||"",zoom:e.zoom||"",action:e.action||"",fields:e.fields||"",baseUrl:e.baseUrl||"",description:e.description||"",enabled:e.enabled,icon:e.icon?JSON.stringify(e.icon):null,id:e.id,name:e.name,username:e.username||"",selectedItems:e.selectedItems||"",placeholder:e.placeholder?JSON.stringify(e.placeholder):null,showDescription:e.showDescription||!1,title:e.title,type:e.type,value:e.value||""},t=await $.post(`v1/cards/${n.newCardId}/links`,{link:JSON.stringify(g)});if(!t.data?.success)p(t.data.message,"ti-alert-triangle");else{const u=N(t.data.data),S=n.links.findIndex(v=>v.id===t.data.data.id);if(S!==-1&&(n.links[S]=u),I.value=null,p(t.data.message,"ti-alert-triangle"),r&&typeof r=="string"&&r.startsWith("data:")){const v=await _(t.data?.data.id,t.data?.data.cardId,t.data?.data.modelType,r);if(v.data?.success&&v.data.data){const h=n.links.findIndex(U=>U.id===t.data.data.id);h!==-1&&(n.links[h].customIcon=v.data.data,n.links=[...n.links])}}if(y&&typeof y=="string"&&y.startsWith("data:")){const v=await _(t.data?.data.id,t.data?.data.cardId,t.data?.data.modelType,y,"fileData");if(v.data?.success&&v.data.data){const h=n.links.findIndex(U=>U.id===t.data.data.id);h!==-1&&(n.links[h].fileData=v.data.data,n.links=[...n.links])}}if(w&&typeof w=="string"&&w.startsWith("data:")){const v=await _(t.data?.data.id,t.data?.data.cardId,t.data?.data.modelType,w,"backgroundImage");if(v.data?.success&&v.data.data){const h=n.links.findIndex(U=>U.id===t.data.data.id);h!==-1&&(n.links[h].backgroundImage=v.data.data,n.links=[...n.links])}}}}catch(g){g.response?p(g.response.data.message,"ti-alert-triangle"):p("مشکلی در ارتباط با سرور وجود دارد. لطفاً بعداً امتحان کنید.","ti-alert-triangle")}}async function b(l){try{n.links=n.links.filter(r=>r.id!==l),I.value=null;const e=await $.delete(`v1/cards/${n.newCardId}/links/${l}`,{data:{fieldName:"customIcon"}});e.data?.success?p(e.data.message,"ti-alert-triangle"):p(e.data.message,"ti-check")}catch(e){e.response?p(e.response.data.message,"ti-alert-triangle"):p("مشکلی در ارتباط با سرور وجود دارد. لطفاً بعداً امتحان کنید.")}}async function a(l){const e=n.links.find(w=>w.id===l);if(!e)return;const r=e.enabled,y=n.newCardId;try{const w=await $.patch(`v1/cards/${y}/links/${l}`,{enabled:!r});w.data?.success?(e.enabled=!r,n.links=[...n.links],p(w.data.message,"ti-check")):p(w.data.message,"ti-alert-triangle")}catch(w){w.response?p(w.response.data.message,"ti-alert-triangle"):(p("مشکلی در ارتباط با سرور وجود دارد. لطفاً بعداً امتحان کنید."),e.enabled=r,n.links=[...n.links])}}async function d(l){if(l.type==="block"&&l.action!=="contactcard"){alert("فقط بلاک کارت تماس می‌تواند به عنوان لینک اول انتخاب شود");return}try{const e=await $.put(`v1/cards/${n.newCardId}/links/${l.id}/toggleSelectedAsSingleLink`);if(e.data.success){const r=n.links.findIndex(g=>g.id===l.id);if(r===-1||r===0)return;const y=[...n.links],[w]=y.splice(r,1);y.unshift(w),n.links=y,p(e.data.message,"ti-lock")}else p(e.data.message,"ti-lock")}catch{p("با خطا مواجه شد","ti-lock")}finally{}}function M(l){const e=l.target.files[0],r=new FileReader;r.onload=y=>{I.value.customIcon=y.target.result},r.readAsDataURL(e)}function N(l){return{...l,icon:l.icon?O(l.icon):null,placeholder:l.placeholder?O(l.placeholder):null}}function O(l){try{return typeof l=="string"?JSON.parse(l):l}catch{return l}}async function ie(l){const e={...l};e.id=`${Date.now()}_${Math.random().toString(36).slice(2)}`,e.enabled=!0,e.type=e.type||(e.action?.includes("block")?"block":"link");const r=B(e);r.action&&(e.action=r.action),e.baseUrl&&e.value?.startsWith(e.baseUrl)&&(e.username=e.value.replace(e.baseUrl,""));const y=e?.customIcon??null,w=e?.fileData??null,g=e?.backgroundImage??null;try{const t={phoneRequired:e.phoneRequired||"",rewards:e.rewards||"",segments:e.segments||"",prizes:e.prizes||"",difficulty:e.difficulty||"",submitButtonText:e.submitButtonText||"",thankYouMessage:e.thankYouMessage||"",avatar:e.avatar||"",align:e.align||"",options:e.options||"",fileName:e.fileName||"",fileType:e.fileType||"",accountHolder:e.accountHolder||"",accountNumber:e.accountNumber||"",bankName:e.bankName||"",cardNumber:e.cardNumber||"",customBank:e.customBank||"",ibanNumber:e.ibanNumber||"",showBankDropdown:e.showBankDropdown||"",highlight:e.highlight||!1,access:e.access||"",address:e.address||"",days:e.days||"",mode:e.mode||"",latitude:e.latitude||"",longitude:e.longitude||"",zoom:e.zoom||"",action:e.action||"",fields:e.fields||"",baseUrl:e.baseUrl||"",description:e.description||"",enabled:e.enabled,icon:e.icon?JSON.stringify(e.icon):null,id:e.id,name:e.name,username:e.username||"",selectedItems:e.selectedItems||"",placeholder:e.placeholder?JSON.stringify(e.placeholder):null,showDescription:e.showDescription||!1,title:e.title,type:e.type,value:e.value||""},u=await $.post(`v1/cards/${n.newCardId}/links`,{link:JSON.stringify(t)});if(!u.data?.success)p(u.data.message,"ti-alert-triangle");else{const S=N(u.data.data);if(n.addLink(S),p(u.data.message,"ti-alert-triangle"),y&&typeof y=="string"&&y.startsWith("data:")){const v=await _(u.data?.data.id,u.data?.data.cardId,u.data?.data.modelType,y);if(v.data?.success&&v.data.data){const h=n.links.findIndex(U=>U.id===u.data.data.id);h!==-1&&(n.links[h].customIcon=v.data.data,n.links=[...n.links])}}if(w&&typeof w=="string"&&w.startsWith("data:")){const v=await _(u.data?.data.id,u.data?.data.cardId,u.data?.data.modelType,w);if(v.data?.success&&v.data.data){const h=n.links.findIndex(U=>U.id===u.data.data.id);h!==-1&&(n.links[h].fileData=v.data.data,n.links=[...n.links])}}if(g&&typeof g=="string"&&g.startsWith("data:")){const v=await _(u.data?.data.id,u.data?.data.cardId,u.data?.data.modelType,g);if(v.data?.success&&v.data.data){const h=n.links.findIndex(U=>U.id===u.data.data.id);h!==-1&&(n.links[h].backgroundImage=v.data.data,n.links=[...n.links])}}}}catch(t){t.response?p(t.response.data.message,"ti-alert-triangle"):p("مشکلی در ارتباط با سرور وجود دارد. لطفاً بعداً امتحان کنید.","ti-alert-triangle")}A.value=!1}async function _(l,e,r,y,w){const g=new FormData;g.append("modelType",r),g.append("modelId",l);function t(S,v="image/png"){const h=atob(S.split(",")[1]),U=new ArrayBuffer(h.length),de=new Uint8Array(U);for(let ae=0;ae<h.length;ae++)de[ae]=h.charCodeAt(ae);return new Blob([U],{type:v})}const u=t(y);g.append(w,u,w+".png");try{const S=await $.post(`file-manager/${l}/upload`,g);return S.data?.success?p("آیکون سفارشی با موفقیت آپلود شد","ti-image"):p("آپلود آیکون سفارشی با خطا مواجه شد","ti-alert-triangle"),S}catch{p("خطا در آپلود آیکون سفارشی","ti-alert-triangle")}}const ee=C(!1);async function re(){ee.value=!0}async function ce(){setTimeout(async()=>{ee.value=!1;const l=n.links.map(r=>r?.hash),e=new FormData;l.forEach((r,y)=>{e.append(`hashOrder[${y}]`,r)});try{const r=await $.post(`v1/cards/${n.newCardId}/links/reorder`,e);r.data?.success?p(r.data.message,"ti-check"):p(r.data.message,"ti-alert-triangle")}catch(r){r.response?p(r.response.data.message,"ti-alert-triangle"):p("مشکلی در ارتباط با سرور وجود دارد. لطفاً بعداً امتحان کنید.","ti-alert-triangle")}},100)}return(l,e)=>(c(),f(J,null,[s("div",null,[k.isAddMode&&!I.value?(c(),f("div",Et,[s("div",Ft,[e[8]||(e[8]=s("h1",{class:"text-xl font-semibold text-gray-700"},"لینک‌های اجتماعی",-1)),e[9]||(e[9]=i()),k.isAddMode&&!I.value&&m(n).links&&m(n).links.length>0?(c(),f("button",{key:0,onClick:e[0]||(e[0]=r=>A.value=!0),class:"bg-black text-white px-4 py-2 rounded text-sm hover:bg-gray-800 transition"},`\r
          افزودن لینک\r
        `)):Q("",!0)])])):I.value?Q("",!0):(c(),f("div",Wt,[s("div",Pt,[e[12]||(e[12]=s("h1",{class:"text-xl font-semibold w-2/4"},"لینک‌ها ",-1)),e[13]||(e[13]=i()),s("div",Jt,[s("div",qt,[T(Ce,{label:"جمع‌آوری لید",modelValue:K.value,"onUpdate:modelValue":e[1]||(e[1]=r=>K.value=r)},null,8,["modelValue"]),e[10]||(e[10]=i()),T(Ce,{label:"لینک تکی",modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=r=>z.value=r)},null,8,["modelValue"])]),e[11]||(e[11]=i()),s("div",null,[s("button",{onClick:e[3]||(e[3]=r=>A.value=!0),class:"bg-black text-white px-4 py-2 rounded text-sm hover:bg-gray-800 transition lg:w-24 mt-0"},`\r
              افزودن\r
            `)])])])])),e[21]||(e[21]=i()),s("div",Ht,[I.value?(c(),te(be(R(I.value)),{key:1,link:I.value,cradId:m(n).newCardId,onCancel:H,onSubmit:G,onDelete:e[6]||(e[6]=()=>b(I.value.id)),onUploadIcon:M},null,40,["link","cradId"])):(c(),f("div",Yt,[m(n).links&&m(n).links.length>0?(c(),f("div",Kt,[(c(),te(m(He),{modelValue:m(n).links,"onUpdate:modelValue":e[4]||(e[4]=r=>m(n).links=r),key:m(n).newCardId,"item-key":"id",handle:".drag-handle",class:"space-y-3",disabled:!1,"ghost-class":"ghost","chosen-class":"chosen","drag-class":"drag",onStart:re,onEnd:ce},{item:ne(({element:r,index:y})=>[(c(),te(jt,{key:r.id,link:{...r,displayName:r.title||r.name,index:y},count:F(r.action),onEdit:Z,onToggle:a,onRemove:b,onSelectAsSingle:d},null,8,["link","count"]))]),_:1},8,["modelValue"]))])):(c(),f("div",Gt,[e[15]||(e[15]=s("div",{class:"mb-4"},[s("i",{class:"ti ti-link text-4xl text-gray-300"})],-1)),e[16]||(e[16]=i()),e[17]||(e[17]=s("p",{class:"text-lg font-medium mb-2"},"هنوز لینکی اضافه نکرده‌اید",-1)),e[18]||(e[18]=i()),e[19]||(e[19]=s("p",{class:"text-sm mb-4"},"لینک‌های شبکه‌های اجتماعی و وب‌سایت خود را اضافه کنید",-1)),e[20]||(e[20]=i()),s("button",{onClick:e[5]||(e[5]=r=>A.value=!0),class:"bg-black text-white px-6 py-3 rounded-md text-sm hover:bg-gray-800 transition font-medium"},[...e[14]||(e[14]=[s("i",{class:"ti ti-plus ml-1"},null,-1),i(`\r
            افزودن اولین لینک\r
          `,-1)])])]))]))]),e[22]||(e[22]=i()),A.value?(c(),te(We,{key:2,"count-map":q.value,cardId:m(n).newCardId,onClose:e[7]||(e[7]=r=>A.value=!1),onAddLink:ie},null,8,["count-map","cardId"])):Q("",!0),e[23]||(e[23]=i()),k.isAddMode?(c(),f("div",Qt,[s("div",Zt,[s("div",Xt,[s("span",null,X(m(n).links&&m(n).links.length>0?`${m(n).links.length} لینک اضافه شده`:"هنوز لینکی اضافه نشده"),1)])])])):Q("",!0)]),e[24]||(e[24]=i()),T(ye,{visible:V.value,message:D.value,icon:o.value},null,8,["visible","message","icon"])],64))}},ea=ke(_t,[["__scopeId","data-v-5ce3179a"]]),ta={class:"flex flex-col"},aa={class:"flex flex-col sm:flex-row gap-4 mb-6 p-2"},sa={class:"grid grid-cols-2 gap-4 flex-1"},na=["disabled","onClick"],la={class:"w-full grid grid-cols-1 lg:grid-cols-6 gap-4"},oa={class:"lg:col-span-4"},ia={class:"lg:col-span-2 space-y-4 sticky z-0 top-16 h-fit w-full hidden lg:block"},ra={class:"flex justify-center"},da={class:"relative",style:{width:"390px",height:"844px"}},ua={class:"absolute inset-0 rounded-[40px] border-4 border-gray-800 bg-black shadow-xl"},ca={class:"absolute inset-2 rounded-[32px] overflow-hidden bg-white"},ma=["src"],fa={class:"bg-white w-full h-full rounded-t-2xl p-4 overflow-y-auto shadow-xl flex flex-col"},pa={class:"flex justify-between items-center mb-4 flex-shrink-0"},ga={class:"w-full",style:{height:"calc(100vh - 120px)"}},va={class:"w-full h-full relative overflow-hidden rounded-lg"},ba={key:0,class:"absolute inset-0 flex items-center justify-center bg-gray-50 rounded-lg z-10"},ya=["src"],ka={__name:"index",setup(k){const j=oe(),$=C(!1),n=C(""),V=C("ti-alert-triangle"),D=(b,a="ti-lock")=>{n.value=b,V.value=a,$.value=!0,setTimeout(()=>$.value=!1,3e3)},o=C("about");C(!1);const p=[{id:1,items:[{id:"about",label:"درباره",icon:"ti ti-user"},{id:"links",label:"لینک‌ها",icon:"ti ti-link"}]}],F=L(()=>({about:he,links:ea})[o.value]||he),q=L(()=>{const b=j.name?.trim();return!b||b.length===0||b.length<2||b.length>40?!1:/^[آ-یa-zA-Z\s]+$/.test(b)});L(()=>q.value);const A=b=>b==="about"?!0:b==="links"?q.value:!1,I=L(()=>{if(typeof window>"u")return"about:blank";const b=new URLSearchParams;return b.set("t",Date.now().toString()),`${window.location.origin}/preview/newCard?${b.toString()}`}),x=(b,a)=>{A(b)&&(a&&D(a,"ti-check"),o.value=b)},P=b=>{},z=C(!0),K=C(!1),E=C(0),B=C(null),R=C(!1),Z=b=>{if(b.origin===window.location.origin&&b.data?.type==="IFRAME_READY"&&(K.value=!0,B.value&&B.value.contentWindow))try{B.value.contentWindow.postMessage({type:"FORM_DATA_UPDATE",data:JSON.parse(JSON.stringify(j.$state))},window.location.origin)}catch{}},H=()=>{z.value=!1};ge(()=>j.$state,b=>{if(K.value&&B.value&&B.value.contentWindow)try{B.value.contentWindow.postMessage({type:"FORM_DATA_UPDATE",data:JSON.parse(JSON.stringify(b))},window.location.origin);return}catch{}clearTimeout(G.value),G.value=setTimeout(()=>{E.value++,z.value=!0,K.value=!1},300)},{deep:!0});const G=C(null);return $e(()=>{j.$reset(),window.addEventListener("message",Z)}),Ie(()=>{window.removeEventListener("message",Z),clearTimeout(G.value)}),(b,a)=>{const d=Te;return c(),f(J,null,[s("div",ta,[s("div",aa,[s("div",sa,[(c(),f(J,null,pe(p,(M,N)=>s("div",{key:N,class:"contents"},[(c(!0),f(J,null,pe(M.items,O=>(c(),f("button",{key:O.id,class:W(["flex items-center gap-1.5 px-3 py-3 rounded-md transition-all text-sm w-full justify-center",{"bg-black text-white shadow-sm":o.value===O.id,"text-gray-700 hover:bg-gray-100 bg-white":o.value!==O.id,"opacity-50 cursor-not-allowed":!A(O.id)}]),disabled:!A(O.id),onClick:ie=>x(O.id)},[s("i",{class:W([O.icon,"text-base"])},null,2),a[5]||(a[5]=i()),s("span",null,X(O.label),1)],10,na))),128))])),64))])]),a[18]||(a[18]=i()),s("div",la,[s("div",oa,[(c(),te(be(F.value),{form:m(j),"onUpdate:form":a[0]||(a[0]=M=>Ve(j)?j.value=M:null),"is-add-mode":!0,"onUpdate:settings":P,onOpenPreview:a[1]||(a[1]=M=>R.value=!0),onGoToNextStep:a[2]||(a[2]=M=>x("links",M)),class:"bg-white p-4 rounded-lg mb-16"},null,40,["form"]))]),a[9]||(a[9]=i()),s("div",ia,[s("div",ra,[s("div",da,[s("div",ua,[a[8]||(a[8]=Be('<div class="absolute top-[15%] -left-[5px] w-[4px] h-5 bg-slate-700 rounded-xl" data-v-cdf46fad></div> <div class="absolute top-[25%] -left-[5px] w-[4px] h-10 bg-slate-700 rounded-xl" data-v-cdf46fad></div> <div class="absolute top-[35%] -left-[5px] w-[4px] h-10 bg-slate-700 rounded-xl" data-v-cdf46fad></div> <div class="absolute top-[35%] -right-[5px] w-[4px] h-16 bg-slate-700 rounded-xl" data-v-cdf46fad></div> <div class="absolute top-3 left-1/2 -translate-x-1/2 w-16 h-5 bg-black rounded-xl z-20" data-v-cdf46fad></div> ',10)),s("div",ca,[T(d,null,{fallback:ne(()=>[...a[6]||(a[6]=[s("div",{class:"w-full h-full bg-gray-100 rounded-[28px] flex items-center justify-center"},[s("div",{class:"text-gray-500"},"در حال بارگذاری...")],-1)])]),default:ne(()=>[(c(),f("iframe",{ref_key:"iframeRef",ref:B,key:`iframe-${E.value}`,src:I.value,class:"w-full h-full border-0 rounded-[28px] overflow-hidden",sandbox:"allow-scripts allow-forms allow-same-origin allow-popups",loading:"lazy",onLoad:H},null,40,ma)),a[7]||(a[7]=i())]),_:1})])])])])])]),a[19]||(a[19]=i()),T(Me,{"enter-active-class":"transform transition ease-in-out duration-300","enter-from-class":"translate-y-full","enter-to-class":"translate-y-0","leave-active-class":"transform transition ease-in-out duration-300","leave-from-class":"translate-y-0","leave-to-class":"translate-y-full"},{default:ne(()=>[R.value?(c(),f("div",{key:0,class:"fixed inset-0 z-50 flex items-end lg:hidden",onClick:a[4]||(a[4]=Y(M=>R.value=!1,["self"]))},[s("div",fa,[s("div",pa,[a[11]||(a[11]=s("h2",{class:"text-base font-semibold"},"پیش‌نمایش",-1)),a[12]||(a[12]=i()),s("button",{onClick:a[3]||(a[3]=M=>R.value=!1),class:"text-gray-400 hover:text-black"},[...a[10]||(a[10]=[s("i",{class:"ti ti-x"},null,-1)])])]),a[17]||(a[17]=i()),s("div",ga,[s("div",va,[z.value?(c(),f("div",ba,[...a[13]||(a[13]=[s("div",{class:"flex flex-col items-center space-y-2"},[s("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),i(),s("span",{class:"text-sm text-gray-600"},"در حال بارگذاری...")],-1)])])):Q("",!0),a[16]||(a[16]=i()),T(d,null,{fallback:ne(()=>[...a[14]||(a[14]=[s("div",{class:"w-full h-full bg-gray-100 rounded-lg flex items-center justify-center"},[s("div",{class:"text-gray-500"},"در حال بارگذاری...")],-1)])]),default:ne(()=>[(c(),f("iframe",{ref_key:"iframeRef",ref:B,key:`iframe-mobile-${E.value}`,src:I.value,class:"w-full h-full border-0 rounded-lg overflow-hidden",sandbox:"allow-scripts allow-forms allow-same-origin allow-popups",loading:"lazy",onLoad:H},null,40,ya)),a[15]||(a[15]=i())]),_:1})])])])])):Q("",!0)]),_:1})]),a[20]||(a[20]=i()),T(ye,{visible:$.value,message:n.value,icon:V.value},null,8,["visible","message","icon"])],64)}}},xa=ke(ka,[["__scopeId","data-v-cdf46fad"]]),wa={class:"p-4"},Fa={__name:"index",setup(k){return(j,$)=>(c(),f("div",wa,[T(xa)]))}};export{Fa as default};
