const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bw9k-xBj.js","./CE1G-McA.js"])))=>i.map(i=>d[i]);
import{_ as Se}from"./Cuk9nQEh.js";import{r as M,J as le,C as J,i as l,y as V,E as Q,b as n,d as k,Y as je,f as e,e as t,t as N,S as me,V as ge,P as H,Q as K,aa as Ae,T as we,$ as qe,a as ne,M as fe,o as ae,L as Ne,O as Y,c as q,ab as ze,h as D,F as Pe,aM as Ce,aN as Ie,ae as pe,z as ye,x as Me,n as F,k as xe,l as Re,X as $e,R as Le,W as Ue,u as Ee,v as Oe,ak as Ve}from"#entry";import{Q as he}from"./Bw9k-xBj.js";import{u as De,_ as Qe}from"./DVjSPpAI.js";import{_ as ie}from"./DlAUqK2U.js";import{_ as ee}from"./Bv-RA7Kk.js";import{u as We}from"./C2vpi6FS.js";import{u as de}from"./DyClqVU4.js";import{useUserStore as ke}from"./0dA2cnp7.js";import{u as Xe}from"./CqqU26cq.js";import{u as Ye}from"./BD1tHKkX.js";import"./CE1G-McA.js";const He={class:"bg-white rounded-2xl w-96 shadow-xl p-6 scale-100"},Fe={class:"flex items-center gap-2 mb-4 text-black"},Ke={class:"text-lg font-bold"},Ze={key:0,class:"mb-4"},Je={key:1,class:"mb-4"},Ge={class:"flex justify-center gap-2 ltr"},_e=["onUpdate:modelValue","onInput","onKeydown"],et={key:0,class:"text-xs text-red-600"},tt={key:1,class:"text-xs text-green-600"},st={class:"text-xs text-gray-500 mt-2"},ot={class:"font-medium"},rt={class:"flex justify-end gap-2 mt-6"},lt={__name:"EditPhoneModal",props:{visible:Boolean,modelValue:String},emits:["close","update"],setup(z,{emit:p}){const{error:x}=De(),h=z,y=p,d=M(h.modelValue||"");le(()=>h.modelValue,v=>{d.value=v||""});const S=M(!1),T=M(!1),P=M(1),b=M(["","","",""]),i=M([]),A=M(!1),f=M(""),r=M("ti-alert-triangle"),m=(v,c="ti-lock")=>{f.value=v,r.value=c,A.value=!0,setTimeout(()=>A.value=!1,3e3)};function w(v){return v.replace(/[۰-۹]/g,c=>"۰۱۲۳۴۵۶۷۸۹".indexOf(c)).replace(/[^\d]/g,"")}function $(v){const c=b.value[v];if(!/^\d$/.test(c)){b.value[v]="";return}v<b.value.length-1&&i.value[v+1]?.focus()}function o(v){b.value[v]===""&&v>0&&i.value[v-1]?.focus()}const u=async()=>{if(!d.value||d.value.length<10){x("شماره نامعتبر","لطفاً شماره موبایل معتبر وارد کنید");return}const{$axios:v}=ne(),c=w(d.value||"");try{const I=await v.post("auth/sendOtpCode",{phone:c.replace(/^0/,""),countryCode:"98"});I.data&&I.data.success===!0?(b.value=["","","",""],S.value=!1,T.value=!1,await fe(()=>i.value[0]?.focus())):m(I.data.message||"ارسال کد با مشکل مواجه شد.","ti-alert-triangle")}catch(I){I.response?.data?.message?m(I.response.data.message,"ti-alert-triangle"):m("مشکلی در ارتباط با سرور وجود دارد.","ti-alert-triangle")}P.value=2};async function g(){const{$axios:v}=ne(),c=b.value.join(""),I=w(d.value||"").replace(/^0/,"");try{const L=await v.post("auth/verifyPhoneChange",{code:c,phone:I,countryCode:"98"});L.data?.success===!0?(T.value=!0,S.value=!1,m("شماره با موفقیت تأیید شد.","ti-check"),P.value=1,y("update",d.value),y("close")):(T.value=!1,S.value=!0,m(L.data.message||"کد وارد شده نادرست است.","ti-alert-triangle"))}catch(L){T.value=!1,S.value=!0;const E=L.response?.data?.message||"خطایی در بررسی کد تأیید رخ داد.";m(E,"ti-alert-triangle")}}function C(v){let c=v.target.value.replace(/[^\d۰-۹]/g,"");c=c.replace(/[۰-۹]/g,I=>String("۰۱۲۳۴۵۶۷۸۹".indexOf(I))),c.startsWith("0")||(c="0"+c),c.length>11&&(c=c.slice(0,11)),d.value=c}return(v,c)=>(l(),J(qe,{to:"body"},[V(we,{name:"fade-scale"},{default:Q(()=>[z.visible?(l(),n("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:c[2]||(c[2]=je(I=>v.$emit("close"),["self"]))},[e("div",He,[e("div",Fe,[c[3]||(c[3]=e("i",{class:"ti ti-device-mobile text-2xl"},null,-1)),c[4]||(c[4]=t()),e("h2",Ke,N(P.value===1?"ویرایش شماره موبایل":"تایید کد"),1)]),c[13]||(c[13]=t()),P.value===1?(l(),n("div",Ze,[c[5]||(c[5]=e("label",{class:"block text-sm text-gray-600 mb-1"},"شماره جدید",-1)),c[6]||(c[6]=t()),me(e("input",{type:"tel","onUpdate:modelValue":c[0]||(c[0]=I=>d.value=I),onInput:C,placeholder:"مثلاً 09123456789",class:"w-full px-3 py-2 rounded-md border border-gray-300 focus:ring-2 focus:ring-black focus:outline-none text-sm text-gray-700"},null,544),[[ge,d.value]])])):(l(),n("div",Je,[e("div",Ge,[(l(!0),n(H,null,K(b.value.length,(I,L)=>me((l(),n("input",{key:L,ref_for:!0,ref:E=>i.value[L]=E,"onUpdate:modelValue":E=>b.value[L]=E,type:"text",inputmode:"numeric",maxlength:"1",pattern:"[0-9]*",class:"w-12 h-12 text-xl text-center border rounded-lg font-bold text-gray-700",dir:"ltr",onInput:E=>$(L),onKeydown:Ae(E=>o(L,E),["backspace"])},null,40,_e)),[[ge,b.value[L]]])),128)),c[7]||(c[7]=t()),S.value?(l(),n("p",et,"کد وارد شده نادرست است.")):k("",!0),c[8]||(c[8]=t()),T.value?(l(),n("p",tt,"شماره موبایل تأیید شد.")):k("",!0)]),c[11]||(c[11]=t()),e("p",st,[c[9]||(c[9]=t(`\r
              کد به شماره `,-1)),e("span",ot,N(d.value),1),c[10]||(c[10]=t(` ارسال شد.\r
            `,-1))])])),c[14]||(c[14]=t()),e("div",rt,[e("button",{onClick:c[1]||(c[1]=I=>v.$emit("close")),class:"px-4 py-2 text-sm rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100"},`\r
              لغو\r
            `),c[12]||(c[12]=t()),P.value===1?(l(),n("button",{key:0,onClick:u,class:"px-4 py-2 text-sm rounded-md bg-black text-white hover:bg-gray-900"},`\r
              ارسال کد\r
            `)):(l(),n("button",{key:1,onClick:g,class:"px-4 py-2 text-sm rounded-md bg-black text-white hover:bg-gray-900"},`\r
              تایید\r
            `))])])])):k("",!0)]),_:1})]))}},nt=ie(lt,[["__scopeId","data-v-8ed94b6a"]]),at={class:"relative min-w-0"},it={key:0,class:"absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg z-50"},dt={class:"text-sm p-2 space-y-2"},ut=["onClick"],ct={class:"text-base space-y-1"},ft=["onClick"],mt={__name:"ActionMenu",emits:["action","download-qr","edit-mobile"],setup(z,{emit:p}){const x=M(!1),h=M(!1),y=()=>{h.value=window.innerWidth<768,h.value||(x.value=!1)};ae(()=>{y(),window.addEventListener("resize",y),document.addEventListener("click",d)}),Ne(()=>{window.removeEventListener("resize",y),document.removeEventListener("click",d)});const d=b=>{x.value&&(b.target.closest(".relative")||(x.value=!1))},S=p,T=[{key:"view",label:"مشاهده پروقایل",icon:"ti-eye"},{key:"share",label:"اشتراک کارت",icon:"ti-share"},{key:"downloadQR",label:"دانلود QR",icon:"ti-download"},{key:"editMobile",label:"ویرایش موبایل",icon:"ti-mail"}],P=b=>{switch(b){case"view":S("action","show-profile");break;case"share":S("action","open-share");break;case"downloadQR":S("download-qr");break;case"editMobile":S("edit-mobile");break}x.value=!1};return(b,i)=>{const A=ee;return l(),n("div",at,[e("button",{class:"w-10 h-10 border border-gray-300 text-gray-700 rounded-full flex items-center justify-center shrink-0 hover:bg-gray-100 transition",onClick:i[0]||(i[0]=f=>x.value=!x.value),"aria-label":"نمایش منو"},[...i[2]||(i[2]=[e("i",{class:"ti ti-dots"},null,-1)])]),i[3]||(i[3]=t()),x.value&&!h.value?(l(),n("div",it,[e("ul",dt,[(l(),n(H,null,K(T,f=>e("li",{key:f.key,class:"hover:bg-gray-100 p-2 rounded flex items-center gap-2 cursor-pointer text-gray-700",onClick:r=>P(f.key)},[e("i",{class:Y(`ti ${f.icon} text-lg`)},null,2),t(" "+N(f.label),1)],8,ut)),64))])])):k("",!0),i[4]||(i[4]=t()),V(A,{visible:x.value&&h.value,title:"منوی عملیات","desktop-centered":!1,"height-class":"max-h-[50vh]","content-padding":"p-4",onClose:i[1]||(i[1]=f=>x.value=!1)},{default:Q(()=>[e("ul",ct,[(l(),n(H,null,K(T,f=>e("li",{key:f.key,class:"hover:bg-gray-100 p-4 rounded-lg flex items-center gap-3 cursor-pointer text-gray-700",onClick:r=>P(f.key)},[e("i",{class:Y(`ti ${f.icon} text-lg`)},null,2),t(" "+N(f.label),1)],8,ft)),64))])]),_:1},8,["visible"])])}}},gt=ie(mt,[["__scopeId","data-v-c9d5f0d2"]]),xt={class:"relative min-w-0"},bt={key:0,class:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"},vt={key:0,class:"absolute left-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 overflow-hidden"},pt={class:"p-4 border-b border-gray-100"},ht={class:"max-h-64 overflow-y-auto"},wt=["onClick"],yt={class:"flex items-start gap-3"},kt={class:"flex-1"},Ct={class:"text-sm font-medium text-gray-800"},$t={class:"text-xs text-gray-600 mt-1"},St={class:"text-xs text-gray-400"},jt={class:"p-3 border-t border-gray-100"},zt={class:"max-h-64 overflow-y-auto"},Pt=["onClick"],Mt={class:"flex items-start gap-3"},Bt={class:"flex-1"},Tt={class:"text-sm font-medium text-gray-800"},At={class:"text-xs text-gray-600 mt-1"},qt={class:"text-xs text-gray-400"},Nt={class:"p-3 border-t border-gray-100"},It={__name:"NotificationMenu",setup(z){const p=M(!1),x=M(!1),h=We(),y=q(()=>h.notifications?.length?h.notifications.filter(b=>!b.read).length:0);ae(()=>{h.fetchNotifications();const b=()=>{x.value=window.innerWidth<768};b(),window.addEventListener("resize",b);const i=A=>{p.value&&!A.target.closest(".relative")&&(p.value=!1)};document.addEventListener("click",i),ze(()=>{window.removeEventListener("resize",b),document.removeEventListener("click",i)})});const d=async b=>{await h.markAsRead(b)},S=b=>{switch(b){case"subscription":return"ti ti-clock text-orange-600";case"payment":return"ti ti-check text-green-600";case"system":return"ti ti-refresh text-blue-600";case"security":return"ti ti-alert-circle text-red-600";case"general":return"ti ti-info-circle text-gray-600";default:return"ti ti-bell text-gray-600"}},T=b=>{switch(b){case"subscription":return"bg-orange-100";case"payment":return"bg-green-100";case"system":return"bg-blue-100";case"security":return"bg-red-100";case"general":return"bg-gray-100";default:return"bg-gray-100"}},P=b=>{const i=(Date.now()-b.getTime())/1e3;return i<60?"لحظاتی پیش":i<3600?`${Math.floor(i/60)} دقیقه پیش`:i<86400?`${Math.floor(i/3600)} ساعت پیش`:`${Math.floor(i/86400)} روز پیش`};return(b,i)=>{const A=Pe;return l(),n("div",xt,[e("button",{class:"w-10 h-10 flex items-center justify-center text-gray-600 hover:text-black transition-colors rounded-lg hover:bg-gray-100 shrink-0",onClick:i[0]||(i[0]=f=>p.value=!p.value),title:"نوتیفیکیشن‌ها"},[i[5]||(i[5]=e("i",{class:"ti ti-bell text-xl"},null,-1)),i[6]||(i[6]=t()),D(y)>0?(l(),n("span",bt)):k("",!0)]),i[20]||(i[20]=t()),p.value&&!x.value?(l(),n("div",vt,[e("div",pt,[i[7]||(i[7]=e("h3",{class:"font-semibold text-gray-800 flex items-center gap-2"},[e("i",{class:"ti ti-bell text-lg"}),t(`\r
          نوتیفیکیشن‌ها\r
        `)],-1)),i[8]||(i[8]=t()),D(y)>0?(l(),n("button",{key:0,onClick:i[1]||(i[1]=(...f)=>D(h).markAllAsRead&&D(h).markAllAsRead(...f)),class:"text-xs text-blue-600 hover:text-blue-800"},`\r
          علامت‌گذاری همه به عنوان خوانده شده\r
        `)):k("",!0)]),i[13]||(i[13]=t()),e("div",ht,[(l(!0),n(H,null,K(D(h).notifications,f=>(l(),n("div",{key:f.id,class:Y(["p-4 hover:bg-gray-50 border-b border-gray-100 transition-colors cursor-pointer flex items-start gap-3",[f.read?"bg-white":"border-r-4 border-blue-500 bg-blue-50"]]),onClick:r=>D(h).markAsRead(f.id)},[e("div",yt,[e("div",{class:Y(["w-8 h-8 rounded-full flex items-center justify-center shrink-0",T(f.type)])},[e("i",{class:Y([S(f.type),"text-sm"])},null,2)],2),i[11]||(i[11]=t()),e("div",kt,[e("p",Ct,N(f.title),1),i[9]||(i[9]=t()),e("p",$t,N(f.description),1),i[10]||(i[10]=t()),e("span",St,N(P(f.createdAt)),1)])])],10,wt))),128))]),i[14]||(i[14]=t()),e("div",jt,[V(A,{to:"/dashboard/notifications",onClick:i[2]||(i[2]=f=>p.value=!1),class:"w-full block text-center text-sm text-blue-600 hover:text-blue-800 transition-colors"},{default:Q(()=>[...i[12]||(i[12]=[t(`\r
          مشاهده همه نوتیفیکیشن‌ها\r
        `,-1)])]),_:1})])])):k("",!0),i[21]||(i[21]=t()),V(ee,{visible:p.value&&x.value,title:"نوتیفیکیشن‌ها","desktop-centered":!1,"height-class":"max-h-[80vh]","content-padding":"p-0",onClose:i[4]||(i[4]=f=>p.value=!1)},{default:Q(()=>[e("div",zt,[(l(!0),n(H,null,K(D(h).notifications,f=>(l(),n("div",{key:f.id,class:Y(["p-4 hover:bg-gray-50 border-b border-gray-100 transition-colors cursor-pointer",f.read?"bg-white":"border-r-4 border-blue-500"]),onClick:r=>d(f.id)},[e("div",Mt,[e("div",{class:Y(["w-8 h-8 rounded-full flex items-center justify-center shrink-0",T(f.type)])},[e("i",{class:Y([S(f.type),"text-sm"])},null,2)],2),i[17]||(i[17]=t()),e("div",Bt,[e("p",Tt,N(f.title),1),i[15]||(i[15]=t()),e("p",At,N(f.description),1),i[16]||(i[16]=t()),e("span",qt,N(P(f.createdAt)),1)])])],10,Pt))),128))]),i[19]||(i[19]=t()),e("div",Nt,[V(A,{to:"/dashboard/notifications",onClick:i[3]||(i[3]=f=>p.value=!1),class:"w-full block text-center text-sm text-blue-600 hover:text-blue-800 transition-colors"},{default:Q(()=>[...i[18]||(i[18]=[t(`\r
          مشاهده همه نوتیفیکیشن‌ها\r
        `,-1)])]),_:1})])]),_:1},8,["visible"])])}}},Rt={class:"hidden"},Lt={class:"flex flex-wrap items-center justify-between gap-4 overflow-x-auto md:overflow-visible min-w-0"},Ut={class:"flex items-center gap-2 flex-shrink-0 min-w-0"},Et={key:1,class:"items-center gap-2 hidden md:flex min-w-0"},Ot={class:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-sm text-white shrink-0"},Vt=["src"],Dt={key:1,class:"ti ti-user"},Qt={class:"font-semibold text-sm truncate text-gray-700"},Wt={key:0,class:"flex items-center gap-2 flex-1 min-w-0 sm:text-start text-center"},Xt={class:"text-lg font-bold truncate min-w-0 text-gray-700"},Yt={key:1,class:"relative min-w-0"},Ht={class:"hidden md:block w-full sm:max-w-sm min-w-0"},Ft={class:"flex items-center gap-2 flex-shrink-0 min-w-0"},Kt={key:0,class:"fixed inset-x-0 top-0 z-50 bg-white shadow-lg flex flex-col items-center",style:{height:"96px"}},Zt={class:"flex items-center w-full max-w-md mx-auto px-4 h-full"},Jt={__name:"index",props:Ce({showBack:Boolean,userName:String,showSearch:Boolean,showMore:Boolean,showNotifications:Boolean,showShare:Boolean,showAddCard:Boolean,title:String,showCardSelect:Boolean,showStateSelect:Boolean,userLogo:String,userPhone:String,cardSlug:String,qrBgColor:String,qrColor:String},{search:{},searchModifiers:{}}),emits:Ce(["open-share","search","action","add-card","toggle-sidebar"],["update:search"]),setup(z,{emit:p}){const x=z,h=p,y=Ie(z,"search"),d=q({get:()=>y.value,set:$=>y.value=$}),S=M(!1),T=M(!1),P=M(x.userPhone),b=M(!1),i=()=>{window.location.pathname.includes("/dashboard/edit-card")?window.location.href="/dashboard/dashboard":window.history.back()},A=$=>{h("action",$),S.value=!1},f=$=>{P.value=$},r=de(),m=q(()=>r.defaultCard),w=async()=>{const o=document.createElement("canvas");o.width=800,o.height=800;const u=o.getContext("2d"),g=`https://linku.im/profile/${x.cardSlug}/share`;await he.toCanvas(o,g,{errorCorrectionLevel:"H",width:800,margin:2,color:{dark:x.qrColor?x.qrColor:"#000000",light:x.qrBgColor?x.qrBgColor:"#ffffff"}});const C=x.userLogo?.trim()?x.userLogo:new URL(""+new URL("logo.Bw_Da6Fq.png",import.meta.url).href,import.meta.url).href,v=new Image;v.crossOrigin="anonymous",v.src=C,await new Promise((I,L)=>{v.onload=()=>{u.save(),u.beginPath();const X=16;u.moveTo(312+X,312),u.lineTo(488-X,312),u.quadraticCurveTo(488,312,488,312+X),u.lineTo(488,488-X),u.quadraticCurveTo(488,488,488-X,488),u.lineTo(312+X,488),u.quadraticCurveTo(312,488,312,488-X),u.lineTo(312,312+X),u.quadraticCurveTo(312,312,312+X,312),u.closePath(),u.fillStyle="#ffffff",u.fill(),u.clip();const U=176*.12,te=176-U*2,ue=176-U*2,se=Math.min(te/v.width,ue/v.height),oe=v.width*se,re=v.height*se,ce=312+(176-oe)/2,be=312+(176-re)/2;u.drawImage(v,ce,be,oe,re),u.restore(),I()},v.onerror=L});const c=document.createElement("a");c.href=o.toDataURL("image/png"),c.download=`qr-${P.value}.png`,c.click()};return($,o)=>{const u=Pe;return l(),n(H,null,[e("header",Rt,[e("div",Lt,[e("div",Ut,[e("button",{class:"w-10 h-10 bg-white border text-gray-700 rounded-lg md:hidden flex items-center justify-center shrink-0",onClick:o[0]||(o[0]=g=>$.$emit("toggle-sidebar"))},[...o[8]||(o[8]=[e("i",{class:"ti ti-menu text-base"},null,-1)])]),o[11]||(o[11]=t()),z.showBack?(l(),n("button",{key:0,onClick:i,class:"w-10 h-10 flex items-center justify-center text-gray-500 hover:text-black text-xl shrink-0"},[...o[9]||(o[9]=[e("i",{class:"ti ti-chevron-right"},null,-1)])])):k("",!0),o[12]||(o[12]=t()),z.userName?(l(),n("div",Et,[e("div",Ot,[D(r).defaultCard?.avatar?(l(),n("img",{key:0,src:D(r).defaultCard.avatar,alt:"cover_img_card",class:"w-7 h-7 rounded-full object-cover"},null,8,Vt)):(l(),n("i",Dt))]),o[10]||(o[10]=t()),e("span",Qt,N(z.userName),1)])):k("",!0)]),o[24]||(o[24]=t()),z.title?(l(),n("div",Wt,[e("h1",Xt,N(z.title),1),o[14]||(o[14]=t()),z.showAddCard?(l(),J(u,{key:0,to:"/dashboard/add-card",class:"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-800 flex items-center justify-center text-sm shrink-0 transition-colors",title:"ساخت پروفایل جدید"},{default:Q(()=>[...o[13]||(o[13]=[e("i",{class:"ti ti-plus"},null,-1)])]),_:1})):k("",!0)])):k("",!0),o[25]||(o[25]=t()),z.showSearch?(l(),n("div",Yt,[e("button",{class:"w-10 h-10 md:hidden flex items-center justify-center text-gray-500 hover:text-blue-600 text-xl bg-white border border-gray-200 shadow-sm rounded-full transition",onClick:o[1]||(o[1]=g=>b.value=!0)},[...o[15]||(o[15]=[e("i",{class:"ti ti-search"},null,-1)])]),o[18]||(o[18]=t()),e("div",Ht,[o[16]||(o[16]=e("i",{class:"ti ti-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-base"},null,-1)),o[17]||(o[17]=t()),me(e("input",{type:"text",placeholder:"جستجوی کارت...","onUpdate:modelValue":o[2]||(o[2]=g=>d.value=g),class:"w-full bg-white rounded-full py-3 ltr:pl-10 ltr:pr-4 rtl:pl-4 rtl:pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-black border border-gray-200 min-w-0 text-gray-700"},null,512),[[ge,d.value]])])])):k("",!0),o[26]||(o[26]=t()),e("div",Ft,[z.showCardSelect?pe($.$slots,"card-select",{key:0},void 0,!0):k("",!0),o[20]||(o[20]=t()),z.showStateSelect?pe($.$slots,"state-select",{key:1},void 0,!0):k("",!0),o[21]||(o[21]=t()),z.showNotifications?(l(),J(It,{key:2})):k("",!0),o[22]||(o[22]=t()),z.showShare?(l(),n("button",{key:3,class:"w-10 h-10 lg:w-auto px-4 flex items-center justify-center bg-black text-white rounded-full text-sm gap-2 shrink-0",onClick:o[3]||(o[3]=g=>$.$emit("open-share",m.value))},[...o[19]||(o[19]=[e("i",{class:"ti ti-share"},null,-1),t(),e("span",{class:"hidden lg:block"},"اشتراک‌گذاری کارت",-1)])])):k("",!0),o[23]||(o[23]=t()),z.showMore?(l(),J(gt,{key:4,onAction:A,onDownloadQr:w,onEditMobile:o[4]||(o[4]=g=>T.value=!0)})):k("",!0)])])]),o[29]||(o[29]=t()),V(we,{name:"slide-down"},{default:Q(()=>[b.value?(l(),n("div",Kt,[e("div",Zt,[e("button",{onClick:o[5]||(o[5]=g=>b.value=!1),class:"w-10 h-10 flex items-center justify-center text-gray-500 mr-2"},[...o[27]||(o[27]=[e("i",{class:"ti ti-x"},null,-1)])]),o[28]||(o[28]=t()),me(e("input",{type:"text",placeholder:"جستجوی کارت...","onUpdate:modelValue":o[6]||(o[6]=g=>d.value=g),class:"flex-1 bg-gray-100 rounded-full py-3 px-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autofocus:""},null,512),[[ge,d.value]])])])):k("",!0)]),_:1}),o[30]||(o[30]=t()),V(nt,{visible:T.value,modelValue:P.value,onUpdate:f,onClose:o[7]||(o[7]=g=>T.value=!1)},null,8,["visible","modelValue"])],64)}}},Gt=ie(Jt,[["__scopeId","data-v-db0bc4b5"]]),_t={class:"fixed top-0 left-0 right-0 w-full z-50 bg-background backdrop-blur-lg border-b border-border"},es={class:"flex items-center justify-between px-4 py-3"},ts={key:0,class:"flex items-center gap-3"},ss={key:0,class:"text-lg font-semibold text-foreground"},os={class:"flex items-center gap-2"},rs={key:0,class:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-card"},ls={key:0,class:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-card"},ns={class:"px-4 pb-6 pt-2"},as={class:"space-y-2"},is=["onClick"],ds={class:"relative w-11 h-11 rounded-full overflow-hidden ring-2 ring-border bg-white"},us=["src","alt"],cs={class:"flex-1"},fs={class:"flex items-center justify-between mb-0.5"},ms={class:"flex items-center gap-1.5"},gs={class:"text-sm font-semibold text-primary"},xs={key:0,class:"ti ti-rosette-discount-check-filled text-primary text-lg"},bs={key:0,class:"text-xs bg-secondary text-primary border border-border px-2 py-0.5 rounded-full font-medium flex items-center gap-1"},vs={class:"flex flex-wrap items-center gap-1.5 text-xs text-foreground"},ps={key:0,class:"font-medium"},hs={class:"mt-3 pt-3"},ws={class:"w-full flex items-center justify-between gap-2 p-3 rounded-2xl bg-secondary border-2 border-dashed border-border hover:bg-accent-bg/30 transition-colors"},ys={key:1,class:"bg-black dark:bg-white text-white dark:text-black px-3 py-1 rounded-full text-xs font-semibold"},ks={__name:"MobileHeader",setup(z){const p=ye(),x=Me(),h=ke(),y=de(),d=M(!1),S=M(!1),T={"/profile":"پروفایل","/settings":"تنظیمات","/settings/account-status":"وضعیت حساب","/dashboard/transactions":"تراکنش‌ها","/dashboard/support":"پشتیبانی","/dashboard/activate":"فعال‌سازی دستگاه","/dashboard/checkout":"خرید اشتراک","/dashboard/notifications":"اعلان‌ها","/dashboard/inbox":"صندوق ورودی"},P=q(()=>{const R=p.path;return R!=="/dashboard"&&R!=="/dashboard/dashboard"}),b=q(()=>{const R=p.path;return R==="/dashboard"||R==="/dashboard/dashboard"||R==="/"}),i=q(()=>T[p.path]||""),A=q(()=>typeof window>"u"?!1:window.innerWidth>=1024),f=q(()=>h.user?.name||"کاربر"),r=q(()=>h.user?.userName||h.user?.username||""),m=q(()=>h.user?.isPro||!1),w=q(()=>y.inboxBadge||0),$=M(!0),o=q(()=>y.defaultCard||y.cards?.[0]||null),u=q(()=>{const R=y.cards||[];return m.value?R.filter(a=>a.isActive!==!1):R.slice(0,1)}),g=()=>{p.path.includes("/dashboard/edit-card")?F("/dashboard"):x.back()},C=R=>{y.setDefaultCard(R.id),d.value=!1},v=()=>{if(d.value=!1,!m.value&&u.value.length>=1){F("/dashboard/checkout");return}m.value&&u.value.length>=5||F("/dashboard/add-card")},c=()=>{d.value=!1,F("/dashboard/checkout")},I=()=>{S.value=!1,F("/dashboard/support/online")},L=()=>{S.value=!1,F("/dashboard/support/faq")},E=()=>{S.value=!1,F("/dashboard/support/ticket")};return(R,a)=>{const X=Se;return l(),n("div",_t,[e("div",es,[P.value?(l(),n("div",ts,[e("button",{onClick:g,class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200"},[...a[7]||(a[7]=[e("i",{class:"ti ti-arrow-right text-xl"},null,-1)])]),a[8]||(a[8]=t()),i.value?(l(),n("h1",ss,N(i.value),1)):k("",!0)])):k("",!0),a[19]||(a[19]=t()),V(X,null,{default:Q(()=>[P.value?k("",!0):(l(),n("button",{key:0,onClick:a[0]||(a[0]=U=>d.value=!0),class:"flex items-center gap-2 transition-all duration-200 hover:bg-muted rounded-lg px-2 py-1"},[...a[9]||(a[9]=[e("span",{class:"text-lg font-semibold text-foreground"},"پروفایل‌ها",-1),t(),e("i",{class:"ti ti-chevron-down text-muted-foreground text-sm"},null,-1)])]))]),_:1}),a[20]||(a[20]=t()),V(X,null,{default:Q(()=>[e("div",os,[!P.value&&A.value?(l(),n("button",{key:0,onClick:a[1]||(a[1]=U=>("navigateTo"in R?R.navigateTo:D(F))("/settings")),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200"},[...a[10]||(a[10]=[e("i",{class:"ti ti-settings text-xl"},null,-1)])])):k("",!0),a[16]||(a[16]=t()),b.value?(l(),n("button",{key:1,onClick:a[2]||(a[2]=U=>("navigateTo"in R?R.navigateTo:D(F))("/inbox")),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200 relative"},[a[11]||(a[11]=e("i",{class:"ti ti-inbox text-xl"},null,-1)),a[12]||(a[12]=t()),w.value>0?(l(),n("div",rs)):k("",!0)])):k("",!0),a[17]||(a[17]=t()),b.value?(l(),n("button",{key:2,onClick:a[3]||(a[3]=U=>("navigateTo"in R?R.navigateTo:D(F))("/dashboard/notifications")),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200 relative"},[a[13]||(a[13]=e("i",{class:"ti ti-bell text-xl"},null,-1)),a[14]||(a[14]=t()),$.value?(l(),n("div",ls)):k("",!0)])):k("",!0),a[18]||(a[18]=t()),e("button",{onClick:a[4]||(a[4]=U=>S.value=!0),class:"w-10 h-10 rounded-full bg-muted flex items-center justify-center text-foreground hover:bg-primary/10 hover:text-primary transition-all duration-200"},[...a[15]||(a[15]=[e("i",{class:"ti ti-headset text-xl"},null,-1)])])])]),_:1})]),a[38]||(a[38]=t()),V(ee,{modelValue:d.value,"onUpdate:modelValue":a[5]||(a[5]=U=>d.value=U),closable:!0,"close-on-backdrop":!0,title:"انتخاب پروفایل"},{default:Q(()=>[e("div",ns,[a[28]||(a[28]=e("p",{class:"text-sm text-primary opacity-60 text-center mb-4"},"پروفایل مورد نظر خود را انتخاب کنید",-1)),a[29]||(a[29]=t()),e("div",as,[(l(!0),n(H,null,K(u.value,U=>(l(),n("div",{key:U.id,onClick:te=>C(U),class:Y(["flex items-center gap-3 p-3 rounded-2xl border cursor-pointer transition-colors",U.id===o.value?.id?"bg-primary/5 border-primary":"bg-secondary border-border hover:bg-accent-bg/30"])},[e("div",ds,[e("img",{src:U.avatar||"/logo.svg",alt:U.name,class:"w-full h-full object-cover"},null,8,us)]),a[25]||(a[25]=t()),e("div",cs,[e("div",fs,[e("div",ms,[e("h3",gs,N(f.value),1),a[21]||(a[21]=t()),m.value?(l(),n("i",xs)):k("",!0)]),a[23]||(a[23]=t()),U.id===o.value?.id?(l(),n("span",bs,[...a[22]||(a[22]=[e("i",{class:"ti ti-check text-xs"},null,-1),t(`\r
                  پیش‌فرض\r
                `,-1)])])):k("",!0)]),a[24]||(a[24]=t()),e("div",vs,[r.value?(l(),n("span",ps,`\r
                  @`+N(r.value),1)):k("",!0)])])],10,is))),128))]),a[30]||(a[30]=t()),e("div",hs,[e("div",ws,[e("div",{onClick:v,class:"flex items-center gap-2 flex-1 cursor-pointer"},[...a[26]||(a[26]=[e("div",{class:"w-11 h-11 rounded-full bg-accent-bg ring-2 ring-border flex items-center justify-center"},[e("i",{class:"ti ti-plus text-primary text-sm"})],-1),t(),e("span",{class:"text-sm font-medium text-primary"},`\r
                ایجاد پروفایل جدید\r
              `,-1)])]),a[27]||(a[27]=t()),m.value?(l(),n("div",ys,`\r
              کاربر ویژه\r
            `)):(l(),n("div",{key:0,onClick:c,class:"bg-black dark:bg-white text-white dark:text-black px-3 py-1 rounded-full text-xs font-semibold cursor-pointer hover:opacity-90 transition-opacity"},`\r
              خرید اشتراک\r
            `))])])])]),_:1},8,["modelValue"]),a[39]||(a[39]=t()),V(ee,{modelValue:S.value,"onUpdate:modelValue":a[6]||(a[6]=U=>S.value=U),closable:!0,"close-on-backdrop":!0,title:"پشتیبانی"},{default:Q(()=>[e("div",{class:"px-4 pb-6 pt-2"},[e("div",{class:"space-y-3"},[e("button",{onClick:I,class:"w-full flex items-center gap-4 p-4 rounded-2xl border border-border bg-card hover:bg-accent transition-colors group"},[...a[31]||(a[31]=[e("div",{class:"w-12 h-12 rounded-xl bg-green-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-green-500/20 transition-colors"},[e("i",{class:"ti ti-message-circle text-green-500 text-2xl"})],-1),t(),e("div",{class:"flex-1 text-right"},[e("h3",{class:"text-sm font-semibold text-foreground mb-0.5"},"پشتیبانی آنلاین"),t(),e("p",{class:"text-xs text-muted-foreground"},"گفتگو با تیم پشتیبانی")],-1),t(),e("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])]),a[34]||(a[34]=t()),e("button",{onClick:L,class:"w-full flex items-center gap-4 p-4 rounded-2xl border border-border bg-card hover:bg-accent transition-colors group"},[...a[32]||(a[32]=[e("div",{class:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-blue-500/20 transition-colors"},[e("i",{class:"ti ti-help text-blue-500 text-2xl"})],-1),t(),e("div",{class:"flex-1 text-right"},[e("h3",{class:"text-sm font-semibold text-foreground mb-0.5"},"سوالات متداول"),t(),e("p",{class:"text-xs text-muted-foreground"},"پاسخ سوالات پرتکرار")],-1),t(),e("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])]),a[35]||(a[35]=t()),e("button",{onClick:E,class:"w-full flex items-center gap-4 p-4 rounded-2xl border border-border bg-card hover:bg-accent transition-colors group"},[...a[33]||(a[33]=[e("div",{class:"w-12 h-12 rounded-xl bg-purple-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-purple-500/20 transition-colors"},[e("i",{class:"ti ti-phone text-purple-500 text-2xl"})],-1),t(),e("div",{class:"flex-1 text-right"},[e("h3",{class:"text-sm font-semibold text-foreground mb-0.5"},"تماس تلفنی"),t(),e("p",{class:"text-xs text-muted-foreground"},"تماس با پشتیبانی")],-1),t(),e("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])])]),a[36]||(a[36]=t()),a[37]||(a[37]=e("div",{class:"mt-6 p-4 rounded-2xl bg-muted/50 border border-border"},[e("p",{class:"text-xs text-muted-foreground text-center mb-2"},[e("i",{class:"ti ti-clock text-sm ml-1"}),t(`\r
            پاسخگویی: شنبه تا چهارشنبه، ۹ صبح تا ۶ عصر\r
          `)]),t(),e("p",{class:"text-xs text-muted-foreground text-center"},[e("i",{class:"ti ti-mail text-sm ml-1"}),t(`\r
            support@linku.im\r
          `)])],-1))])]),_:1},8,["modelValue"])])}}},Cs={key:0,class:"fixed bottom-0 left-0 right-0 bg-card border-t border-border z-40"},$s={class:"flex items-center justify-around h-20 px-6 relative"},Ss=["onClick"],js=["href","onClick"],zs=["src","alt"],Ps=["onClick"],Ms={class:"sticky top-0 w-full z-10 bg-background lg:bg-card border-b border-border flex-shrink-0 lg:rounded-t-2xl"},Bs={class:"flex items-center justify-between px-6 py-4 lg:py-3"},Ts={class:"flex-1 overflow-y-auto lg:overflow-hidden"},As={class:"flex flex-col lg:flex-row lg:h-full"},qs={class:"lg:w-1/2 lg:border-l lg:border-border p-6 lg:flex lg:flex-col lg:justify-center lg:items-center bg-muted/30"},Ns={class:"flex justify-center mb-6"},Is={class:"w-7 h-7 rounded-full overflow-hidden flex-shrink-0 ring-2 ring-primary/30"},Rs=["src","alt"],Ls={class:"text-sm font-medium text-foreground truncate flex-1"},Us={class:"flex flex-col items-center justify-center mb-6"},Es={class:"p-4 rounded-2xl border-2 border-border shadow-lg bg-white"},Os={class:"px-4 pb-6 pt-2"},Vs={class:"space-y-2"},Ds=["onClick"],Qs={class:"relative w-11 h-11 rounded-full overflow-hidden ring-2 ring-border bg-white"},Ws=["src","alt"],Xs={class:"flex-1"},Ys={class:"flex items-center justify-between mb-0.5"},Hs={class:"flex items-center gap-1.5"},Fs={class:"text-sm font-semibold text-primary"},Ks={key:0,class:"ti ti-rosette-discount-check-filled text-primary text-lg"},Zs={key:0,class:"text-xs bg-secondary text-primary border border-border px-2 py-0.5 rounded-full font-medium flex items-center gap-1"},Js={class:"flex flex-wrap items-center gap-1.5 text-xs text-foreground"},Gs={key:0,class:"font-medium"},_s={class:"mt-3 pt-3"},eo={class:"w-full flex items-center justify-between gap-2 p-3 rounded-2xl bg-secondary border-2 border-dashed border-border hover:bg-accent-bg/30 transition-colors"},to={key:1,class:"bg-primary text-white px-3 py-1 rounded-full text-xs font-semibold"},so=xe({__name:"BottomNavigation",emits:["open-share"],setup(z,{emit:p}){const x=Me(),h=ye(),y=de(),d=ke(),S=M(!1),T=Re(null),P=M(!1),b=M("لینک کپی شد!"),i=M("success"),A=M(!1),f=M(null),r=(j,s="success")=>{b.value=j,i.value=s,P.value=!0},m=q(()=>y.defaultCard||(y.cards||[]).filter(j=>j.isActive!==!1)[0]||null),w=q(()=>{const j=m.value?.avatar;if(j&&typeof j=="string"&&j.trim().length>0)return j;const s=y.safeProfileImage;if(s&&typeof s=="string"&&s.trim().length>0)return s;const B=d.user?.avatar;return B&&typeof B=="string"&&B.trim().length>0?B:"/logo.svg"}),$=q(()=>d.user?.name||"کاربر"),o=q(()=>d.user?.userName||d.user?.username||""),u=q(()=>(y.cards||[]).filter(s=>s.isActive!==!1));le(()=>m.value,j=>{j&&!f.value&&(f.value=j)},{immediate:!0});const g=q(()=>{if(typeof window>"u")return"https://linku.im";const j=window.location.origin,s=o.value||$.value||"profile";return`${j}/${s}`}),C=q(()=>d.user?.isPro||!1),v=q(()=>[{id:"profile",icon:"ti ti-user",label:"پروفایل",path:"/profile",isActive:h.path.includes("/profile")},{id:"analytics",icon:"ti ti-chart-line",label:"تحلیل‌ها",path:"/dashboard/insights",isActive:h.path.includes("/dashboard/insights")},{id:"share",icon:"ti ti-brand-telegram",label:"",action:"share",isCenter:!0},{id:"search",icon:"ti ti-search",label:"جستجو",path:"/dashboard/search",action:"search"},{id:"dashboard",avatarUrl:w.value,label:"داشبورد",path:"/dashboard",isActive:h.path==="/dashboard"||h.path.startsWith("/dashboard")&&!h.path.includes("/insights")}]),c=j=>{j.path?x.push(j.path):j.action==="share"&&I()},I=()=>{S.value=!0,fe(()=>{L()})},L=async()=>{if(T.value)try{const j=(await $e(async()=>{const{default:_}=await import("./Bw9k-xBj.js").then(Z=>Z.b);return{default:_}},__vite__mapDeps([0,1]),import.meta.url)).default,s=m.value?.qrColor||"#000000",B=m.value?.qrBgColor||"#ffffff";await j.toCanvas(T.value,g.value,{width:200,margin:1,color:{dark:s,light:B},errorCorrectionLevel:"H"});const O=T.value.getContext("2d");if(!O)return;const W=f.value?.avatar||f.value?.logo||w.value,G=new Image;G.crossOrigin="anonymous",G.onload=()=>{O.fillStyle="#ffffff",O.beginPath(),O.arc(100,100,50/2+4,0,2*Math.PI),O.fill(),O.save(),O.beginPath(),O.arc(100,100,50/2,0,2*Math.PI),O.clip(),O.drawImage(G,100-50/2,100-50/2,50,50),O.restore(),C.value&&f.value?.avatar&&(O.strokeStyle="#ffd700",O.lineWidth=2,O.beginPath(),O.arc(100,100,50/2,0,2*Math.PI),O.stroke())},G.onerror=()=>{},G.src=W}catch{}},E=async()=>{try{await navigator.clipboard.writeText(g.value),r("لینک کپی شد!","success")}catch{}},R=async()=>{try{const j=(await $e(async()=>{const{default:_}=await import("./Bw9k-xBj.js").then(Z=>Z.b);return{default:_}},__vite__mapDeps([0,1]),import.meta.url)).default,s=document.createElement("canvas");s.width=1e3,s.height=1e3;const B=m.value?.qrColor||"#000000",O=m.value?.qrBgColor||"#ffffff";await j.toCanvas(s,g.value,{width:1e3,margin:2,color:{dark:B,light:O},errorCorrectionLevel:"H"});const W=s.getContext("2d");if(W){const _=f.value?.avatar||f.value?.logo||w.value;if(_&&_!=="/logo.svg"){const Z=new Image;Z.crossOrigin="anonymous",await new Promise(ve=>{Z.onload=()=>{W.fillStyle="#ffffff",W.beginPath(),W.arc(500,500,250/2+20,0,2*Math.PI),W.fill(),W.save(),W.beginPath(),W.arc(500,500,250/2,0,2*Math.PI),W.clip(),W.drawImage(Z,500-250/2,500-250/2,250,250),W.restore(),C.value&&f.value?.avatar&&(W.strokeStyle="#ffd700",W.lineWidth=8,W.beginPath(),W.arc(500,500,250/2+4,0,2*Math.PI),W.stroke()),ve()},Z.onerror=()=>ve(),Z.src=_})}}const G=document.createElement("a");G.href=s.toDataURL("image/png",1),G.download=`qr-${f.value?.slug||"profile"}-1000x1000.png`,G.click(),r("کیوآر کد با کیفیت بالا ذخیره شد!","success")}catch(j){console.error("Error downloading QR:",j),r("خطا در ذخیره کیوآر کد","error")}},a=async()=>{if(navigator.share)try{await navigator.share({title:`پروفایل ${f.value?.name||"من"}`,text:"پروفایل من را در لینکو ببینید!",url:g.value})}catch(j){j?.name!=="AbortError"&&E()}else E()},X=()=>{x.push("/profile/customize-link"),S.value=!1},U=()=>{x.push("/QR"),S.value=!1},te=()=>{const j=`پروفایل من را ببینید: ${g.value}`,s=/iPad|iPhone|iPod/.test(navigator.userAgent);window.location.href=s?`sms:&body=${encodeURIComponent(j)}`:`sms:?body=${encodeURIComponent(j)}`},ue=()=>{const j=`پروفایل ${f.value?.name||"من"}`,s=`سلام،

پروفایل من را در لینکو ببینید:
${g.value}`;window.location.href=`mailto:?subject=${encodeURIComponent(j)}&body=${encodeURIComponent(s)}`},se=()=>{const j=`پروفایل من را ببینید: ${g.value}`;window.open(`https://wa.me/?text=${encodeURIComponent(j)}`,"_blank")},oe=()=>{const j=`پروفایل من را ببینید: ${g.value}`;window.open(`https://t.me/share/url?url=${encodeURIComponent(g.value)}&text=${encodeURIComponent(j)}`,"_blank")},re=async()=>{await E();const j=/iPad|iPhone|iPod/.test(navigator.userAgent),s=/Android/.test(navigator.userAgent);j?window.location.href="instagram://app":s?window.location.href="intent://instagram.com/#Intent;package=com.instagram.android;scheme=https;end":window.open("https://www.instagram.com/","_blank")},ce=()=>{a()},be=j=>{f.value=j,A.value=!1,fe(()=>L())},Be=()=>{if(A.value=!1,!C.value){x.push("/dashboard/checkout");return}if(u.value.length>=5){r("حداکثر 5 پروفایل مجاز است","warning");return}x.push("/dashboard/add-card")},Te=()=>{x.push("/dashboard/checkout")};return le(S,j=>{j&&fe(()=>L())}),(j,s)=>(l(),n("div",null,[S.value?k("",!0):(l(),n("div",Cs,[e("div",$s,[(l(!0),n(H,null,K(v.value,B=>(l(),n(H,{key:B.id},[B.isCenter?(l(),n("button",{key:0,onClick:O=>c(B),class:"w-16 h-16 bg-primary rounded-3xl flex items-center justify-center shadow-xl -mt-10 transition-all duration-200 hover:scale-105 hover:shadow-2xl"},[e("i",{class:Y([B.icon,"text-primary-foreground font-bold text-4xl"])},null,2)],8,Ss)):B.avatarUrl?(l(),n("a",{key:1,href:B.path,onClick:je(O=>c(B),["prevent"]),class:"flex flex-col items-center justify-center p-3 transition-all duration-200 min-w-12"},[e("div",{class:Y(["w-7 h-7 rounded-full overflow-hidden transition-all duration-200 border-2",B.isActive?"border-primary scale-110 ring-2 ring-primary/20":"border-muted-foreground/30 hover:border-primary/50"])},[e("img",{src:B.avatarUrl,alt:B.label,class:"w-full h-full object-cover"},null,8,zs)],2)],8,js)):(l(),n("div",{key:2,onClick:O=>c(B),class:Y(["flex flex-col items-center justify-center p-3 transition-all duration-200 min-w-12 relative cursor-pointer",B.isActive?"text-primary":"text-muted-foreground hover:text-foreground"])},[e("i",{class:Y([B.icon,"text-2xl"])},null,2)],10,Ps))],64))),128))])])),s[67]||(s[67]=t()),V(ee,{modelValue:S.value,"onUpdate:modelValue":s[2]||(s[2]=B=>S.value=B),size:"full",closable:!1,"close-on-backdrop":!0},{default:Q(()=>[e("div",Ms,[e("div",Bs,[s[6]||(s[6]=e("h3",{class:"text-lg font-semibold text-foreground"},"اشتراک‌گذاری",-1)),s[7]||(s[7]=t()),e("button",{onClick:s[0]||(s[0]=B=>S.value=!1),class:"w-8 h-8 rounded-full bg-muted hover:bg-muted/80 flex items-center justify-center transition-colors"},[...s[5]||(s[5]=[e("i",{class:"ti ti-x text-foreground text-base"},null,-1)])])])]),s[56]||(s[56]=t()),e("div",Ts,[e("div",As,[e("div",qs,[e("div",Ns,[e("button",{onClick:s[1]||(s[1]=B=>A.value=!0),class:"flex items-center gap-2 p-3 bg-background hover:bg-muted/80 rounded-full border border-border min-w-[164px] transition-colors"},[e("div",Is,[e("img",{src:f.value?.avatar||w.value,alt:$.value,class:"w-full h-full object-cover"},null,8,Rs)]),s[8]||(s[8]=t()),e("span",Ls,N($.value),1),s[9]||(s[9]=t()),s[10]||(s[10]=e("i",{class:"ti ti-chevron-down text-muted-foreground flex-shrink-0"},null,-1))])]),s[12]||(s[12]=t()),e("div",Us,[e("div",Es,[e("canvas",{ref_key:"qrCanvas",ref:T,width:"200",height:"200",class:"rounded-lg"},null,512)])]),s[13]||(s[13]=t()),e("div",{class:"flex justify-center"},[e("button",{onClick:a,class:"flex items-center gap-3 px-10 py-3 bg-primary text-primary-foreground rounded-full font-semibold text-base hover:opacity-90 transition-opacity shadow-lg"},[...s[11]||(s[11]=[e("i",{class:"ti ti-share-2 text-lg"},null,-1),t(`\r
                اشتراک‌گذاری\r
              `,-1)])])])]),s[55]||(s[55]=t()),e("div",{class:"lg:w-1/2 p-6 lg:overflow-y-auto"},[e("div",{class:"lg:hidden space-y-0 bg-card rounded-2xl overflow-hidden border border-border shadow-sm"},[e("button",{onClick:E,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[14]||(s[14]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-link text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"کپی لینک",-1)])]),s[24]||(s[24]=t()),e("button",{onClick:X,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[15]||(s[15]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-edit text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"سفارشی‌سازی لینک",-1)])]),s[25]||(s[25]=t()),e("button",{onClick:U,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[16]||(s[16]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-qrcode text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"سفارشی‌سازی کیوآر کد",-1)])]),s[26]||(s[26]=t()),e("button",{onClick:R,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[17]||(s[17]=[e("div",{class:"w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-photo text-primary text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"ذخیره در گالری",-1)])]),s[27]||(s[27]=t()),e("button",{onClick:te,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[18]||(s[18]=[e("div",{class:"w-9 h-9 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-message text-blue-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"ارسال پیامک",-1)])]),s[28]||(s[28]=t()),e("button",{onClick:ue,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[19]||(s[19]=[e("div",{class:"w-9 h-9 rounded-xl bg-red-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-mail text-red-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"ارسال ایمیل",-1)])]),s[29]||(s[29]=t()),e("button",{onClick:se,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[20]||(s[20]=[e("div",{class:"w-9 h-9 rounded-xl bg-green-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-whatsapp text-green-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"اشتراک در واتساپ",-1)])]),s[30]||(s[30]=t()),e("button",{onClick:re,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[21]||(s[21]=[e("div",{class:"w-9 h-9 rounded-xl bg-pink-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-instagram text-pink-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"اشتراک در اینستاگرام",-1)])]),s[31]||(s[31]=t()),e("button",{onClick:oe,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all border-b border-border"},[...s[22]||(s[22]=[e("div",{class:"w-9 h-9 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-telegram text-blue-500 text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"اشتراک در تلگرام",-1)])]),s[32]||(s[32]=t()),e("button",{onClick:ce,class:"w-full flex items-center gap-3 p-4 hover:bg-muted/50 transition-all"},[...s[23]||(s[23]=[e("div",{class:"w-9 h-9 rounded-xl bg-muted flex items-center justify-center"},[e("i",{class:"ti ti-dots text-muted-foreground text-lg"})],-1),t(),e("span",{class:"font-medium text-foreground text-sm"},"روش‌های دیگر",-1)])])]),s[54]||(s[54]=t()),e("div",{class:"hidden lg:block"},[s[52]||(s[52]=e("h4",{class:"text-sm font-semibold text-muted-foreground mb-4"},"روش‌های اشتراک‌گذاری",-1)),s[53]||(s[53]=t()),e("div",{class:"grid grid-cols-4 gap-3"},[e("button",{onClick:E,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[33]||(s[33]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-link text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"کپی لینک",-1)])]),s[43]||(s[43]=t()),e("button",{onClick:X,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[34]||(s[34]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-edit text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"سفارشی لینک",-1)])]),s[44]||(s[44]=t()),e("button",{onClick:U,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[35]||(s[35]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-qrcode text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"سفارشی QR",-1)])]),s[45]||(s[45]=t()),e("button",{onClick:R,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[36]||(s[36]=[e("div",{class:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-photo text-primary text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"ذخیره QR",-1)])]),s[46]||(s[46]=t()),e("button",{onClick:te,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[37]||(s[37]=[e("div",{class:"w-11 h-11 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-message text-blue-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"پیامک",-1)])]),s[47]||(s[47]=t()),e("button",{onClick:ue,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[38]||(s[38]=[e("div",{class:"w-11 h-11 rounded-xl bg-red-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-mail text-red-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"ایمیل",-1)])]),s[48]||(s[48]=t()),e("button",{onClick:se,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[39]||(s[39]=[e("div",{class:"w-11 h-11 rounded-xl bg-green-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-whatsapp text-green-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"واتساپ",-1)])]),s[49]||(s[49]=t()),e("button",{onClick:re,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[40]||(s[40]=[e("div",{class:"w-11 h-11 rounded-xl bg-pink-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-instagram text-pink-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"اینستاگرام",-1)])]),s[50]||(s[50]=t()),e("button",{onClick:oe,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[41]||(s[41]=[e("div",{class:"w-11 h-11 rounded-xl bg-blue-500/10 flex items-center justify-center"},[e("i",{class:"ti ti-brand-telegram text-blue-500 text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"تلگرام",-1)])]),s[51]||(s[51]=t()),e("button",{onClick:ce,class:"flex flex-col items-center gap-2 p-4 hover:bg-muted/50 rounded-xl transition-all border border-border bg-card"},[...s[42]||(s[42]=[e("div",{class:"w-11 h-11 rounded-xl bg-muted flex items-center justify-center"},[e("i",{class:"ti ti-dots text-muted-foreground text-xl"})],-1),t(),e("span",{class:"font-medium text-foreground text-xs text-center"},"بیشتر",-1)])])])])])])])]),_:1},8,["modelValue"]),s[68]||(s[68]=t()),P.value?(l(),J(Qe,{key:1,title:b.value,type:i.value,onClose:s[3]||(s[3]=B=>P.value=!1)},null,8,["title","type"])):k("",!0),s[69]||(s[69]=t()),V(ee,{modelValue:A.value,"onUpdate:modelValue":s[4]||(s[4]=B=>A.value=B),closable:!0,"close-on-backdrop":!0,title:"انتخاب پروفایل"},{default:Q(()=>[e("div",Os,[s[64]||(s[64]=e("p",{class:"text-sm text-primary opacity-60 text-center mb-4"},"پروفایل مورد نظر خود را انتخاب کنید",-1)),s[65]||(s[65]=t()),e("div",Vs,[(l(!0),n(H,null,K(u.value,B=>(l(),n("div",{key:B.id,onClick:O=>be(B),class:Y(["flex items-center gap-3 p-3 rounded-2xl border cursor-pointer transition-colors",f.value?.id===B.id?"bg-primary/5 border-primary":"bg-secondary border-border hover:bg-accent-bg/30"])},[e("div",Qs,[e("img",{src:B.avatar||"/logo.svg",alt:B.name,class:"w-full h-full object-cover"},null,8,Ws)]),s[61]||(s[61]=t()),e("div",Xs,[e("div",Ys,[e("div",Hs,[e("h3",Fs,N($.value),1),s[57]||(s[57]=t()),C.value?(l(),n("i",Ks)):k("",!0)]),s[59]||(s[59]=t()),f.value?.id===B.id?(l(),n("span",Zs,[...s[58]||(s[58]=[e("i",{class:"ti ti-check text-xs"},null,-1),t(`\r
                  پیش‌فرض\r
                `,-1)])])):k("",!0)]),s[60]||(s[60]=t()),e("div",Js,[o.value?(l(),n("span",Gs,`\r
                  @`+N(o.value),1)):k("",!0)])])],10,Ds))),128))]),s[66]||(s[66]=t()),e("div",_s,[e("div",eo,[e("div",{onClick:Be,class:"flex items-center gap-2 flex-1 cursor-pointer"},[...s[62]||(s[62]=[e("div",{class:"w-11 h-11 rounded-full bg-accent-bg ring-2 ring-border flex items-center justify-center"},[e("i",{class:"ti ti-plus text-primary text-sm"})],-1),t(),e("span",{class:"text-sm font-medium text-primary"},`\r
                ایجاد پروفایل جدید\r
              `,-1)])]),s[63]||(s[63]=t()),C.value?(l(),n("div",to,`\r
              کاربر ویژه\r
            `)):(l(),n("div",{key:0,onClick:Te,class:"bg-primary text-white px-3 py-1 rounded-full text-xs font-semibold cursor-pointer"},`\r
              خرید اشتراک\r
            `))])])])]),_:1},8,["modelValue"])]))}}),oo=ie(so,[["__scopeId","data-v-d2cd92b8"]]),ro={class:"flex flex-col items-center gap-4 mb-8 border-b border-gray-100 pb-4"},lo={class:"my-16"},no={class:"relative flex justify-between gap-4"},ao=["value"],io={key:0,class:"text-xs text-blue-500 mt-1"},uo={class:"mt-6"},co={class:"grid grid-cols-2 gap-y-4 gap-x-4 pr-1"},fo=["href"],mo={class:"flex items-center gap-2"},go={class:"text-sm font-medium"},xo={__name:"ShareModal",props:{visible:Boolean,card:Object},emits:["close"],setup(z,{emit:p}){const x=z,{getIconComponent:h}=Xe(),y=M(""),d=M("/logo/logo.png"),S=M(!1),T=M(null);le(()=>x.card,r=>{r!=null?(d.value=r.qrLogo??"/logo/logo.png",y.value=r.slug?`https://linku.im/profile/${r.slug}/share`:"https://linku.im/profile/MA5PZ1jq/share"):(d.value="/logo/logo.png",y.value="https://linku.im/profile/MA5PZ1jq/share")});const P=()=>{navigator.clipboard.writeText(y.value),S.value=!0,setTimeout(()=>S.value=!1,2e3)},b=async(r,m)=>{if(!T.value||!y.value)return;await he.toCanvas(T.value,y.value,{width:160,margin:1,errorCorrectionLevel:"H",color:{dark:r,light:m}});const w=T.value.getContext("2d"),$=new Image;$.src=d.value,$.crossOrigin="anonymous",await $.decode();const o=160,u=o*.35,g=(o-u)/2,C=(o-u)/2;w.save(),w.beginPath();const v=8;w.moveTo(g+v,C),w.lineTo(g+u-v,C),w.quadraticCurveTo(g+u,C,g+u,C+v),w.lineTo(g+u,C+u-v),w.quadraticCurveTo(g+u,C+u,g+u-v,C+u),w.lineTo(g+v,C+u),w.quadraticCurveTo(g,C+u,g,C+u-v),w.lineTo(g,C+v),w.quadraticCurveTo(g,C,g+v,C),w.closePath(),w.fillStyle="#ffffff",w.fill(),w.clip();const c=u*.15,I=Math.min((u-2*c)/$.width,(u-2*c)/$.height),L=$.width*I,E=$.height*I,R=g+(u-L)/2,a=C+(u-E)/2;w.drawImage($,R,a,L,E),w.restore()},i=async(r,m)=>{const $=document.createElement("canvas");$.width=800,$.height=800;const o=$.getContext("2d");await he.toCanvas($,y.value,{errorCorrectionLevel:"H",width:800,margin:2,color:{dark:r,light:m}});const u=new Image;u.src=d.value,u.crossOrigin="anonymous",await u.decode();const g=800*.35,C=(800-g)/2,v=(800-g)/2;o.save(),o.beginPath();const c=24;o.moveTo(C+c,v),o.lineTo(C+g-c,v),o.quadraticCurveTo(C+g,v,C+g,v+c),o.lineTo(C+g,v+g-c),o.quadraticCurveTo(C+g,v+g,C+g-c,v+g),o.lineTo(C+c,v+g),o.quadraticCurveTo(C,v+g,C,v+g-c),o.lineTo(C,v+c),o.quadraticCurveTo(C,v,C+c,v),o.closePath(),o.fillStyle="#ffffff",o.fill(),o.clip();const I=g*.12,L=Math.min((g-2*I)/u.width,(g-2*I)/u.height),E=u.width*L,R=u.height*L,a=C+(g-E)/2,X=v+(g-R)/2;o.drawImage(u,a,X,E,R),o.restore();const U=document.createElement("a");U.href=$.toDataURL("image/png"),U.download="qr-high-quality.png",U.click()},A=Ye();le(()=>x.visible,async r=>{r&&(await A.fetchCard(x.card.id),d.value=A.activeCard?.qrLogo??"/logo/logo.png",y.value=`https://linku.im/profile/${A.activeCard?.slug}/share`,r&&setTimeout(()=>{b(A.activeCard.qrColor?A.activeCard.qrColor:"#000000",A.activeCard.qrBgColor?A.activeCard.qrBgColor:"#ffffff")},50))},{immediate:!0});const f=q(()=>[{name:"ایمیل",iconComponent:h({type:"component",name:"email"}),url:`mailto:?subject=کارت دیجیتال&body=برای مشاهده پروفایل، روی لینک زیر کلیک کنید 👇🏻%0A%0A${y.value}`},{name:"لینکدین",iconComponent:h({type:"component",name:"linkedin"}),url:`https://www.linkedin.com/sharing/share-offsite/?url=${y.value}`},{name:"تلگرام",iconComponent:h({type:"component",name:"telegram"}),url:`https://t.me/share/url?url=${y.value}&text=${encodeURIComponent("برای مشاهده پروفایل، روی لینک زیر کلیک کنید 👇🏻")}`},{name:"واتساپ",iconComponent:h({type:"component",name:"whatsapp"}),url:`https://api.whatsapp.com/send?text=${encodeURIComponent(`برای مشاهده پروفایل، روی لینک زیر کلیک کنید 👇🏻

`+y.value)}`}]);return(r,m)=>{const w=ee;return l(),J(w,{visible:z.visible,title:"اشتراک کارت",onClose:m[1]||(m[1]=$=>r.$emit("close"))},{default:Q(()=>[e("div",ro,[e("canvas",{ref_key:"qrCanvas",ref:T,width:"160",height:"160",class:"rounded-lg"},null,512),m[3]||(m[3]=t()),e("button",{onClick:m[0]||(m[0]=$=>i(z.card.qrColor?z.card.qrColor:"#000000",z.card.qrBgColor?z.card.qrBgColor:"#ffffff")),class:"flex items-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-5 py-2 rounded-full font-medium mt-2"},[...m[2]||(m[2]=[e("i",{class:"ti ti-download"},null,-1),t(`\r
        دانلود QR کد\r
      `,-1)])])]),m[14]||(m[14]=t()),e("div",lo,[m[6]||(m[6]=e("p",{class:"text-sm font-semibold mb-4"},"کپی لینک کارت",-1)),m[7]||(m[7]=t()),e("div",no,[e("input",{readonly:"",value:y.value,class:"w-full bg-gray-100 text-sm text-gray-700 py-4 px-3 rounded-2xl ltr:pr-20 rtl:pl-20"},null,8,ao),m[5]||(m[5]=t()),e("button",{onClick:P,class:"text-blue-500 text-sm font-medium flex items-center justify-end gap-1 w-28"},[...m[4]||(m[4]=[e("i",{class:"ti ti-copy text-base"},null,-1),t(` کپی لینک\r
        `,-1)])])]),m[8]||(m[8]=t()),S.value?(l(),n("p",io,"کپی شد!")):k("",!0)]),m[15]||(m[15]=t()),e("div",uo,[m[12]||(m[12]=e("p",{class:"text-sm font-semibold mb-4"},"اشتراک از طریق",-1)),m[13]||(m[13]=t()),e("div",co,[(l(!0),n(H,null,K(f.value,$=>(l(),n("a",{key:$.name,href:$.url,target:"_blank",rel:"noreferrer",class:"flex items-center justify-between text-gray-700 rounded-lg px-4 py-3 bg-gray-100 hover:bg-gray-50 transition"},[e("div",mo,[(l(),J(Le(Ue($.iconComponent)),{size:24})),m[9]||(m[9]=t()),e("span",go,N($.name),1)]),m[10]||(m[10]=t()),m[11]||(m[11]=e("i",{class:"ti ti-external-link opacity-50"},null,-1))],8,fo))),128))])])]),_:1},8,["visible"])}}};async function bo(z,p){try{const[x,h]=await Promise.all([p.get(`v1/cards/${z}/leads/leadsCount`),p.get(`v1/cards/${z}/forms/formsCount`)]),y=x.data.data||{},d=h.data.data||{};return{unreadCount:(y.unreadCount??0)+(d.unreadCount??0),totalCount:(y.totalCount??0)+(d.totalCount??0)}}catch{return{unreadCount:0,totalCount:0}}}async function vo(z,p){try{return(await p.get(`v1/cards/${z}/votes`)).data?.total_votes||0}catch{return 0}}async function po(z,p){try{const x=await p.get(`club/${z}/luckyDice/resultCount`),{totalCount:h,unreadCount:y}=x.data.data||{};return{totalCount:h??0,unreadCount:y??0}}catch{return{totalCount:0,unreadCount:0}}}async function ho(z,p){try{const x=await p.get(`club/${z}/luckyEgg/resultCount`),{totalCount:h,unreadCount:y}=x.data.data||{};return{totalCount:h??0,unreadCount:y??0}}catch{return{totalCount:0,unreadCount:0}}}async function wo(z,p){try{const x=await p.get(`club/${z}/luckyWheel/resultCount`),{totalCount:h,unreadCount:y}=x.data.data||{};return{totalCount:h??0,unreadCount:y??0}}catch{return{totalCount:0,unreadCount:0}}}const yo={class:"flex items-center gap-2 overflow-hidden"},ko=["src"],Co={key:1,class:"bg-gray-100 rounded-full w-7 h-7 flex items-center justify-center"},$o={class:"truncate font-medium hidden md:block text-gray-700"},So={key:2,class:"text-xs font-semibold bg-gray-100 text-black px-2 py-0.5 rounded-full hidden md:inline"},jo={key:0,class:"absolute mt-4 left-0 w-72 bg-white border rounded-xl shadow-xl z-50"},zo={key:0,class:"px-4 py-3 border-b"},Po={class:"flex items-center gap-2"},Mo=["src"],Bo={class:"font-medium text-gray-700"},To={class:"text-xs text-gray-500"},Ao={class:"px-4 py-3 border-b max-h-40 overflow-y-auto"},qo={class:"space-y-3"},No=["onClick"],Io=["src"],Ro={class:"flex-1"},Lo={class:"font-medium flex items-center gap-1 text-gray-700"},Uo={key:0,class:"text-xs bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full"},Eo={key:0,class:"text-xs text-gray-500"},Oo={key:1,class:"ti ti-check text-green-600"},Vo={key:0,class:"text-xs text-gray-500 text-center py-2"},Do={key:0,class:"mb-6 transform transition-all duration-200"},Qo={class:"flex items-center gap-3 p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors"},Wo=["src"],Xo={key:1,class:"bg-gray-100 rounded-full w-12 h-12 flex items-center justify-center"},Yo={class:"flex-1"},Ho={class:"font-semibold text-base text-gray-800"},Fo={key:0,class:"text-sm text-gray-500"},Ko={key:1,class:"mb-6"},Zo={class:"space-y-2"},Jo=["onClick"],Go=["src"],_o={key:1,class:"bg-gray-100 rounded-full w-12 h-12 flex items-center justify-center"},er={class:"flex-1"},tr={class:"font-semibold text-base text-gray-800"},sr={key:0,class:"text-sm text-gray-500"},or={key:2,class:"ti ti-check text-green-600 text-xl"},rr={key:2,class:"text-sm text-gray-500 text-center py-4 mb-6"},lr=xe({__name:"CardSelect",setup(z){const p=de(),x=M(!1),h=M(null),y=M(!1),d=q(()=>p.defaultCard||{id:"default",name:"کارت من",avatar:null,isDefault:!1,description:"پیش‌فرض"}),S=q(()=>!p.cards||!d.value?[]:p.cards.filter(f=>f.id!==d.value?.id)),T=f=>{f.stopPropagation(),x.value=!x.value},P=async f=>{p.setDefaultCard(f.id),x.value=!1;const r=p.defaultCard?.id;if(!r)return;const{$axios:m}=ne(),w=await bo(r,m),$=await vo(r,m),o=await po(r,m),u=await ho(r,m),g=await wo(r,m),C=w+$+o+u+g;p.setInboxBadge(C)},b=async()=>{x.value=!1,await F("/dashboard/add-card")},i=f=>{h.value?.contains(f.target)||(x.value=!1)};function A(){y.value=window.innerWidth<768}return ae(()=>{document.addEventListener("click",i),A(),window.addEventListener("resize",A)}),ze(()=>{document.removeEventListener("click",i),window.removeEventListener("resize",A)}),(f,r)=>{const m=ee;return l(),n("div",{ref_key:"dropdownRef",ref:h,class:"relative z-50 w-20 md:w-72 text-sm text-right rtl"},[e("button",{onClick:T,class:"w-full rounded-full border border-gray-300 px-4 py-1.5 flex items-center justify-between bg-white"},[e("div",yo,[d.value?.avatar?(l(),n("img",{key:0,src:d.value.avatar,class:"w-6 h-6 rounded-full object-cover"},null,8,ko)):(l(),n("span",Co,[...r[1]||(r[1]=[e("i",{class:"ti ti-user text-xl text-gray-400"},null,-1)])])),r[2]||(r[2]=t()),e("span",$o,N(d.value?.name||"کارت من"),1),r[3]||(r[3]=t()),d.value?.isDefault?(l(),n("span",So,`\r
          پیش‌فرض\r
        `)):k("",!0)]),r[4]||(r[4]=t()),r[5]||(r[5]=e("i",{class:"ti ti-chevron-down text-xs"},null,-1))]),r[33]||(r[33]=t()),x.value&&!y.value?(l(),n("div",jo,[d.value?(l(),n("div",zo,[r[8]||(r[8]=e("h3",{class:"text-xs text-gray-500 mb-2 flex items-center gap-1"},[e("i",{class:"ti ti-eye"}),t(` در حال مشاهده\r
        `)],-1)),r[9]||(r[9]=t()),e("div",Po,[d.value.avatar?(l(),n("img",{key:0,src:d.value.avatar,class:"w-8 h-8 rounded-full object-cover"},null,8,Mo)):k("",!0),r[7]||(r[7]=t()),e("div",null,[e("p",Bo,N(d.value.name),1),r[6]||(r[6]=t()),e("p",To,N(d.value.description),1)])])])):k("",!0),r[17]||(r[17]=t()),e("div",Ao,[r[13]||(r[13]=e("h3",{class:"text-xs text-gray-500 mb-2 flex items-center gap-1"},[e("i",{class:"ti ti-id"}),t(` کارت‌های دیگر\r
        `)],-1)),r[14]||(r[14]=t()),e("div",qo,[(l(!0),n(H,null,K(S.value,w=>(l(),n("div",{key:w.id,onClick:$=>P(w),class:"flex items-center gap-3 cursor-pointer hover:bg-gray-100 p-2 rounded-lg"},[w.avatar?(l(),n("img",{key:0,src:w.avatar,class:"w-8 h-8 rounded-full object-cover"},null,8,Io)):k("",!0),r[11]||(r[11]=t()),e("div",Ro,[e("p",Lo,[t(N(w.name)+" ",1),w.isDefault?(l(),n("span",Uo,`\r
                  پیش‌فرض\r
                `)):k("",!0)]),r[10]||(r[10]=t()),w.description?(l(),n("p",Eo,N(w.description),1)):k("",!0)]),r[12]||(r[12]=t()),w.id===d.value?.id?(l(),n("i",Oo)):k("",!0)],8,No))),128))]),r[15]||(r[15]=t()),S.value.length===0?(l(),n("p",Vo,`\r
          کارت دیگری وجود ندارد\r
        `)):k("",!0)]),r[18]||(r[18]=t()),e("div",{class:"p-4"},[e("button",{onClick:b,class:"w-full bg-black text-white py-2 rounded-full flex items-center justify-center gap-2"},[...r[16]||(r[16]=[e("i",{class:"ti ti-plus"},null,-1),t(` ایجاد پروفایل جدید\r
        `,-1)])])])])):k("",!0),r[34]||(r[34]=t()),V(m,{visible:x.value&&y.value,title:"انتخاب کارت","height-class":"max-h-[calc(100vh-80px)]","content-padding":"p-4",onClose:r[0]||(r[0]=w=>x.value=!1)},{default:Q(()=>[d.value?(l(),n("div",Do,[r[22]||(r[22]=e("h3",{class:"text-sm text-gray-500 mb-3 flex items-center gap-2"},[e("i",{class:"ti ti-eye"}),t(` در حال مشاهده\r
        `)],-1)),r[23]||(r[23]=t()),e("div",Qo,[d.value.avatar?(l(),n("img",{key:0,src:d.value.avatar,class:"w-12 h-12 rounded-full object-cover shadow-sm"},null,8,Wo)):(l(),n("span",Xo,[...r[19]||(r[19]=[e("i",{class:"ti ti-user text-2xl text-gray-400"},null,-1)])])),r[21]||(r[21]=t()),e("div",Yo,[e("p",Ho,N(d.value.name),1),r[20]||(r[20]=t()),d.value.description?(l(),n("p",Fo,N(d.value.description),1)):k("",!0)])])])):k("",!0),r[31]||(r[31]=t()),S.value.length>0?(l(),n("div",Ko,[r[28]||(r[28]=e("h3",{class:"text-sm text-gray-500 mb-3 flex items-center gap-2"},[e("i",{class:"ti ti-id"}),t(` کارت‌های دیگر\r
        `)],-1)),r[29]||(r[29]=t()),e("div",Zo,[(l(!0),n(H,null,K(S.value,w=>(l(),n("div",{key:w.id,onClick:$=>P(w),class:"flex items-center gap-3 cursor-pointer hover:bg-gray-50 active:bg-gray-100 p-4 rounded-xl transition-all duration-150 transform hover:scale-[0.98]"},[w.avatar?(l(),n("img",{key:0,src:w.avatar,class:"w-12 h-12 rounded-full object-cover shadow-sm"},null,8,Go)):(l(),n("span",_o,[...r[24]||(r[24]=[e("i",{class:"ti ti-user text-2xl text-gray-400"},null,-1)])])),r[26]||(r[26]=t()),e("div",er,[e("p",tr,N(w.name),1),r[25]||(r[25]=t()),w.description?(l(),n("p",sr,N(w.description),1)):k("",!0)]),r[27]||(r[27]=t()),w.id===d.value?.id?(l(),n("i",or)):k("",!0)],8,Jo))),128))])])):(l(),n("p",rr,`\r
        کارت دیگری وجود ندارد\r
      `)),r[32]||(r[32]=t()),e("button",{onClick:b,class:"w-full bg-gray-900 hover:bg-black text-white py-3 rounded-xl flex items-center justify-center gap-2 text-base font-medium transition-all duration-200 transform active:scale-[0.98] shadow-lg"},[...r[30]||(r[30]=[e("i",{class:"ti ti-plus"},null,-1),t(` ایجاد پروفایل جدید\r
      `,-1)])])]),_:1},8,["visible"])],512)}}}),nr={key:0,class:"fixed top-4 left-4 right-4 z-[9999] mx-auto max-w-md"},ar={class:"bg-card/95 backdrop-blur-md rounded-xl shadow-lg border border-border p-3"},ir={class:"flex items-center gap-3"},dr={class:"flex items-center gap-2 flex-shrink-0"},ur=["disabled"],cr={key:0},fr={key:1},mr=["disabled"],gr=xe({__name:"NotificationPermissionBanner",emits:["enabled","dismissed"],setup(z,{emit:p}){const x=M(!1),h=M(!1),y=p,d=()=>{if(!("Notification"in window))return!1;const P=localStorage.getItem("notification_banner_dismissed"),b=Notification.permission;!P&&b==="default"&&(x.value=!0)},S=async()=>{if(!h.value){h.value=!0;try{const P=await Notification.requestPermission();if(P==="granted"){const{$subscribeToPush:b}=ne();b&&await b(),x.value=!1,localStorage.setItem("notification_banner_dismissed","true"),y("enabled")}else P==="denied"&&(x.value=!1,localStorage.setItem("notification_banner_dismissed","true"))}catch(P){console.error("Error requesting notification permission:",P)}finally{h.value=!1}}},T=()=>{x.value=!1,localStorage.setItem("notification_banner_dismissed","true"),y("dismissed")};return ae(()=>{setTimeout(()=>{d()},1500)}),(P,b)=>(l(),J(we,{name:"toast-slide"},{default:Q(()=>[x.value?(l(),n("div",nr,[e("div",ar,[e("div",ir,[b[2]||(b[2]=e("div",{class:"flex-shrink-0 w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center"},[e("i",{class:"ti ti-bell text-primary text-xl"})],-1)),b[3]||(b[3]=t()),b[4]||(b[4]=e("div",{class:"flex-1 min-w-0"},[e("p",{class:"text-sm font-medium text-foreground"},`\r
              فعال‌سازی اعلان‌ها\r
            `),t(),e("p",{class:"text-xs text-muted-foreground mt-0.5"},`\r
              برای دریافت آپدیت‌ها\r
            `)],-1)),b[5]||(b[5]=t()),e("div",dr,[e("button",{onClick:S,disabled:h.value,class:"px-3 py-1.5 bg-primary text-primary-foreground text-xs font-medium rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50"},[h.value?(l(),n("span",fr,"...")):(l(),n("span",cr,"فعال کن"))],8,ur),b[1]||(b[1]=t()),e("button",{onClick:T,disabled:h.value,class:"p-1.5 hover:bg-muted rounded-lg transition-colors disabled:opacity-50","aria-label":"بستن"},[...b[0]||(b[0]=[e("i",{class:"ti ti-x text-muted-foreground text-lg"},null,-1)])],8,mr)])])])])):k("",!0)]),_:1}))}}),xr=ie(gr,[["__scopeId","data-v-9749df82"]]),br={key:0,class:"flex bg-background min-h-screen overflow-hidden transition-colors duration-300"},vr={class:"flex-1 flex flex-col relative"},qr=xe({__name:"default",setup(z){const p=ke(),x=Ee(),h=de(),{$axios:y}=ne(),d=ye(),S=q(()=>{{const o=window.location.pathname.toLowerCase();if(o.startsWith("/auth")||o==="/login")return!1;const u=localStorage.getItem("auth_token"),g=document.cookie.split("; ").find(C=>C.startsWith("auth_token="))?.split("=")[1];return!u&&!g?(typeof window<"u"&&window.location.replace("/auth/login"),!1):!0}}),T=q(()=>d.path.includes("/notifications")||d.path.includes("/inbox")||d.path.includes("/QR")||d.path.includes("/profile/CustomizeQRPage")||d.path.includes("/profile/CustomizeLinkPage")||d.path.includes("/profile/lead-capture")||d.path.includes("/dashboard/activate")||d.path.includes("/dashboard/support")||d.path.includes("/dashboard/transactions")||d.path.includes("/dashboard/rewards")||d.path.includes("/financial")||d.path.includes("/settings")||d.path.includes("/rewards")),P=q(()=>d.path==="/dashboard"||d.path==="/dashboard/");ae(async()=>{x.hydrateToken(),await p.fetchUser(),h.cards=p.cards});const b=M(!1),i=M(""),A=o=>{if(o.includes("/edit-card"))return{title:"ویرایش پروفایل",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!0,showNotifications:!1,showShare:!0,showAddCard:!1,showCardSelect:!1,showStateSelect:!1};if(o.includes("/add-card"))return{title:"افزودن پروفایل جدید",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1};const u={"/dashboard/activate":{title:"فعال‌سازی کارت",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard/dashboard":{title:"پروفایل‌های من",showBack:!1,userName:p.user?.name,showSearch:!0,showMore:!0,showNotifications:!0,showShare:!1,showAddCard:!0,showCardSelect:!0,showStateSelect:!1},"/dashboard/insights":{title:"تحلیل و آمار",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!0,showShare:!1,showAddCard:!1,showCardSelect:!0,showStateSelect:!1},"/dashboard/notifications":{title:"اعلان‌ها",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard/support":{title:"پشتیبانی",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard/transactions":{title:"تراکنش‌ها",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!0},"/dashboard/upgrade":{title:"خرید اشتراک",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/dashboard":{title:"پروفایل‌های من",showBack:!1,userName:p.user?.name,showSearch:!0,showMore:!0,showNotifications:!0,showShare:!1,showAddCard:!0,showCardSelect:!0,showStateSelect:!1},"/settings":{title:"تنظیمات",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/inbox":{title:"صندوق دریافتی",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1},"/settings/account-status":{title:"وضعیت حساب",showBack:!0,userName:p.user?.name,showSearch:!1,showMore:!1,showNotifications:!1,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1}};for(const[g,C]of Object.entries(u))if(o.startsWith(g))return C;return{title:"داشبورد",showBack:!1,userName:p.user?.name,showSearch:!1,showMore:!0,showNotifications:!0,showShare:!1,showAddCard:!1,showCardSelect:!1,showStateSelect:!1}},f=q(()=>A(d.path));d.params.slug;const r=M({});function m(o){r.value=o,b.value=!0}const w=o=>{switch(o){case"show-profile":$(h.defaultCard?.slug);break;case"open-share":m(h.defaultCard);break}},$=o=>{const u=new URLSearchParams;u.set("t",Date.now().toString());const g=`${window.location.origin}/preview/${o}?${u.toString()}`;window.open(g,"_blank")};return Oe("topbarConfig",f),(o,u)=>{const g=Se;return S.value?(l(),n("div",br,[V(g,null,{default:Q(()=>[V(xr)]),_:1}),u[6]||(u[6]=t()),e("div",vr,[T.value?k("",!0):(l(),J(ks,{key:0})),u[3]||(u[3]=t()),V(Gt,Ve(f.value,{search:i.value,"onUpdate:search":u[0]||(u[0]=C=>i.value=C),userLogo:D(p).user?.avatar||"",userPhone:D(p).user.phone||"",cardSlug:D(h).defaultCard?.slug,qrBgColor:D(h).defaultCard?.qrBgColor,qrColor:D(h).defaultCard?.qrColor,onOpenShare:m,onAction:w}),{"card-select":Q(()=>[V(g,null,{default:Q(()=>[V(lr)]),_:1})]),_:1},16,["search","userLogo","userPhone","cardSlug","qrBgColor","qrColor"]),u[4]||(u[4]=t()),e("div",{class:Y(["flex-1 overflow-y-auto lg:pb-4",[T.value?"pt-0":"pt-20",P.value?"pb-20":"pb-0",D(d).path.includes("/checkout")||!P.value?"":"lg:px-4 px-2"]])},[pe(o.$slots,"default",{search:i.value,onOpenShare:m})],2),u[5]||(u[5]=t()),P.value?(l(),J(oo,{key:1,onOpenShare:u[1]||(u[1]=C=>m(D(h).defaultCard))})):k("",!0)]),u[7]||(u[7]=t()),V(xo,{visible:b.value,card:r.value,onClose:u[2]||(u[2]=C=>b.value=!1)},null,8,["visible","card"])])):k("",!0)}}});export{qr as default};
