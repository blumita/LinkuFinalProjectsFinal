import{w as C,a as D,r as i,o as h,b as a,f as e,e as s,y as T,d as A,P as x,Q as y,i as n,g as I,t as v}from"#entry";import{I as S}from"./DJY3EWAx.js";import{_ as V}from"./DlAUqK2U.js";const B={class:"min-h-screen bg-background flex flex-col"},j={class:"flex-1 pt-16 px-2 lg:px-6 max-w-4xl mx-auto w-full pb-8"},M={key:0,class:"space-y-3"},$={key:1,class:"space-y-2 lg:space-y-3"},L=["src","alt"],P={class:"flex-1 min-w-0"},R={class:"font-medium text-foreground text-sm lg:text-base"},z={class:"text-xs lg:text-sm text-muted-foreground font-mono truncate"},E={class:"text-xs text-muted-foreground"},F=["onClick"],Q={key:2,class:"bg-card border border-dashed border-border rounded-xl p-8 lg:p-12 text-center"},q={key:3,class:"mt-6 lg:mt-8"},G={__name:"my-products",setup(H){const u=C(),{$axios:c}=D(),g=i(!1),p=i(""),b=i("ti-alert-triangle"),d=(l,t="ti-lock")=>{p.value=l,b.value=t,g.value=!0,setTimeout(()=>g.value=!1,3e3)},r=i([]),m=i(!0);function w(){window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||window.history.length<=2?u.push("/dashboard"):u.back()}function f(){u.push("/dashboard/activate")}async function k(){m.value=!0;try{const l=await c.get("v1/cards/activateDevices");r.value=(l.data?.data||[]).map(t=>({card_id:t.card_id,license:t.license,name:t.device?.name||"محصول",image:t.device?.image||"/devices/default.png",activatedAt:new Date(t.updated_at).toLocaleDateString("fa-IR")}))}catch{d("خطا در دریافت محصولات","ti-alert-triangle")}finally{m.value=!1}}async function N(l){try{const t=await c.post(`v1/cards/${l}/deactivateDevice`);t?.data?.success?(d("محصول غیرفعال شد","ti-check"),r.value=r.value.filter(o=>Number(o.card_id)!==Number(l))):d(t.data?.message||"خطا در غیرفعال‌سازی","ti-alert-triangle")}catch{d("خطا در غیرفعال‌سازی","ti-alert-triangle")}}return h(async()=>{await k()}),(l,t)=>(n(),a(x,null,[e("div",B,[e("div",{class:"fixed top-0 left-0 right-0 z-50 bg-background/95 backdrop-blur-lg border-b border-border"},[e("div",{class:"flex items-center h-14 px-2 lg:px-6 max-w-4xl mx-auto"},[e("button",{onClick:w,class:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-accent transition-colors"},[...t[0]||(t[0]=[e("i",{class:"ti ti-arrow-right text-xl text-foreground"},null,-1)])]),t[1]||(t[1]=s()),t[2]||(t[2]=e("h1",{class:"flex-1 text-base lg:text-lg font-semibold text-foreground text-center"},`\r
          محصولات فعال من\r
        `,-1)),t[3]||(t[3]=s()),t[4]||(t[4]=e("div",{class:"w-10"},null,-1))])]),t[21]||(t[21]=s()),e("div",j,[t[18]||(t[18]=e("p",{class:"text-sm text-muted-foreground text-center mb-4 lg:mb-6"},`\r
        لیست محصولات فعال شده شما\r
      `,-1)),t[19]||(t[19]=s()),m.value?(n(),a("div",M,[(n(),a(x,null,y(3,o=>e("div",{key:o,class:"bg-card rounded-xl p-3 lg:p-4 animate-pulse"},[...t[5]||(t[5]=[I('<div class="flex items-center gap-3" data-v-d77c89b5><div class="w-12 h-12 lg:w-14 lg:h-14 bg-muted rounded-lg" data-v-d77c89b5></div> <div class="flex-1 space-y-2" data-v-d77c89b5><div class="h-4 bg-muted rounded w-3/4" data-v-d77c89b5></div> <div class="h-3 bg-muted rounded w-1/2" data-v-d77c89b5></div></div></div>',1)])])),64))])):r.value.length?(n(),a("div",$,[(n(!0),a(x,null,y(r.value,o=>(n(),a("div",{key:o.license,class:"bg-card border border-border rounded-xl p-3 lg:p-4 flex items-center gap-2 lg:gap-3"},[e("img",{src:o.image,alt:o.name,class:"w-12 h-12 lg:w-14 lg:h-14 object-contain"},null,8,L),t[8]||(t[8]=s()),e("div",P,[e("h4",R,v(o.name),1),t[6]||(t[6]=s()),e("p",z,v(o.license),1),t[7]||(t[7]=s()),e("p",E,"فعال شده در: "+v(o.activatedAt),1)]),t[9]||(t[9]=s()),e("button",{onClick:J=>N(o.card_id),class:"text-xs lg:text-sm text-destructive bg-destructive/10 px-3 py-2 rounded-lg hover:bg-destructive/20 transition-colors"},`\r
            غیرفعال\r
          `,8,F)]))),128))])):(n(),a("div",Q,[t[11]||(t[11]=e("i",{class:"ti ti-device-mobile-off text-4xl lg:text-5xl text-muted-foreground mb-3 lg:mb-4"},null,-1)),t[12]||(t[12]=s()),t[13]||(t[13]=e("p",{class:"text-foreground font-semibold mb-2 text-base lg:text-lg"},"محصول فعالی ندارید",-1)),t[14]||(t[14]=s()),t[15]||(t[15]=e("p",{class:"text-xs lg:text-sm text-muted-foreground mb-6"},"هنوز محصولی را فعال نکرده‌اید",-1)),t[16]||(t[16]=s()),e("button",{onClick:f,class:"inline-flex items-center gap-2 bg-primary text-white px-6 py-3 rounded-xl font-medium hover:bg-primary/90 transition-colors"},[...t[10]||(t[10]=[e("i",{class:"ti ti-plus"},null,-1),s(),e("span",null,"فعال‌سازی محصول جدید",-1)])])])),t[20]||(t[20]=s()),r.value.length?(n(),a("div",q,[e("button",{onClick:f,class:"w-full bg-gradient-to-r from-primary to-primary/80 text-white py-4 rounded-xl font-semibold hover:from-primary/90 hover:to-primary/70 transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2"},[...t[17]||(t[17]=[e("i",{class:"ti ti-plus text-xl"},null,-1),s(),e("span",null,"فعال‌سازی محصول جدید",-1)])])])):A("",!0)])]),t[22]||(t[22]=s()),T(S,{visible:g.value,message:p.value,icon:b.value},null,8,["visible","message","icon"])],64))}},W=V(G,[["__scopeId","data-v-d77c89b5"]]);export{W as default};
