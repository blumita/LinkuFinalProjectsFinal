import{y as _,d as E,r,j as ee,K as te,k as v,q as t,p as o,F as f,l as c,H as I,M as $,u as T,s as oe,I as i,a4 as h,x as n,N as se,V as le}from"./Ct89Yiyn.js";import{useUserStore as re}from"./BRBG3GYJ.js";import{u as ne}from"./lVmvsOkf.js";import{n as F}from"#entry";import{_ as ie}from"./DlAUqK2U.js";import"./CU4qPF7-.js";import"./ngrFHoWO.js";const ae={class:"qr-scanner-wrapper"},de={class:"header-section"},ue={class:"header-content"},me={class:"flex items-center justify-between"},ve={class:"camera-container"},fe={key:0,class:"absolute inset-0 flex items-center justify-center"},ce={key:1,class:"absolute inset-0 flex items-center justify-center p-6"},be={class:"text-center max-w-sm"},pe={class:"text-white/80 text-sm mb-6"},xe={key:2,class:"absolute inset-0 pointer-events-none"},ge={class:"footer-section"},we={class:"footer-content"},ye={class:"px-6 pb-6"},ke={class:"mb-6"},he={class:"flex gap-3"},Ce={class:"px-4 py-6"},Se={class:"space-y-4"},Be={key:0,class:"ti ti-check text-2xl flex-shrink-0"},Re={key:1,class:"ti ti-x text-2xl flex-shrink-0"},je={class:"font-medium"},ze=_({__name:"QRScannerPage",setup(Ee){const L=re(),D=ne(),A=E(()=>L.user?.name||"کاربر"),M=E(()=>D.defaultCard),H=E(()=>M.value?.slug?`https://linku.im/${M.value.slug}`:"https://linku.im"),b=r(null),C=r(null),d=r(!1),g=r(!1),a=r(""),w=r(!1),p=r(""),u=r(!1),B=r(!1),x=r({show:!1,success:!1,message:""});let y=null;const R=()=>{document.documentElement.style.setProperty("--app-height",window.innerHeight+"px")};ee(()=>{document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",window.addEventListener("resize",R),window.addEventListener("orientationchange",()=>setTimeout(R,300)),j()});const j=async()=>{if(!g.value){g.value=!0,a.value="";try{y=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}}),b.value&&(b.value.srcObject=y,await b.value.play(),d.value=!0,setTimeout(()=>{const s="LINKU-DEMO-"+Math.random().toString(36).substring(7).toUpperCase();V(s)},3e3))}catch(s){K(s)}finally{g.value=!1}}},S=()=>{y&&(y.getTracks().forEach(s=>s.stop()),y=null),b.value&&(b.value.srcObject=null),d.value=!1,a.value=""},K=s=>{s.name==="NotAllowedError"?a.value="لطفاً اجازه دسترسی به دوربین را بدهید":s.name==="NotFoundError"?a.value="دوربین یافت نشد":s.name==="NotSupportedError"?a.value="مرورگر شما از دوربین پشتیبانی نمی‌کند":a.value="خطا در دسترسی به دوربین"},V=s=>{S(),N(s)},N=s=>{try{s&&s.length>5?(k(!0,"کد با موفقیت اسکن شد!"),F({path:"/dashboard/activate",query:{code:s}})):k(!1,"کد معتبر نیست")}catch{k(!1,"خطا در پردازش کد")}},k=(s,e)=>{x.value={show:!0,success:s,message:e},setTimeout(()=>{x.value.show=!1},3e3)},Q=()=>{C.value?.click()},O=async s=>{if(s.target.files?.[0]){try{const m="LINKU-IMG-"+Math.random().toString(36).substring(7).toUpperCase();V(m),k(!0,"تصویر با موفقیت اسکن شد!")}catch{k(!1,"خطا در اسکن تصویر")}C.value&&(C.value.value="")}},P=()=>{S(),B.value=!0},G=()=>{S(),w.value=!0},J=async()=>{p.value.trim()&&(w.value=!1,N(p.value.trim()),p.value="")},W=()=>{u.value=!1,F("/dashboard/support")},X=()=>{const s="+98-21-12345678";u.value=!1,window.location.href=`tel:${s}`},Y=()=>{const s="support@linku.im",e=encodeURIComponent("درخواست پشتیبانی - QR Scanner"),m=encodeURIComponent("سلام، من در استفاده از QR Scanner به کمک نیاز دارم...");u.value=!1,window.location.href=`mailto:${s}?subject=${e}&body=${m}`};return te(()=>{document.body.style.overflow="",document.documentElement.style.overflow="",document.body.classList.remove("qr-scanner-fullscreen"),window.removeEventListener("resize",R),S()}),(s,e)=>{const m=h("IconButton"),U=h("IconTextButton"),z=h("BlumitaButton"),q=h("BlumitaBottomSheet"),Z=h("QRCodeFullScreen");return n(),v("div",ae,[t("div",de,[t("div",ue,[t("div",me,[t("button",{onClick:e[0]||(e[0]=l=>s.$router.go(-1)),class:"w-10 h-10 rounded-full bg-white/15 hover:bg-white/25 backdrop-blur-sm flex items-center justify-center transition-colors flex-shrink-0"},[...e[8]||(e[8]=[t("i",{class:"ti ti-arrow-right text-white text-lg"},null,-1)])]),e[10]||(e[10]=o()),e[11]||(e[11]=t("h1",{class:"text-white text-lg font-medium"},"اسکن کد QR",-1)),e[12]||(e[12]=o()),t("button",{onClick:e[1]||(e[1]=l=>u.value=!0),class:"w-12 h-12 bg-white/10 backdrop-blur-sm text-white rounded-2xl flex items-center justify-center hover:bg-white/20 transition-all duration-300"},[...e[9]||(e[9]=[t("i",{class:"ti ti-help text-xl"},null,-1)])])])])]),e[45]||(e[45]=o()),t("div",ve,[t("video",{ref_key:"videoElement",ref:b,autoplay:"",muted:"",playsinline:"",class:$(["w-full h-full object-cover",{"opacity-0":!d.value}])},null,2),e[21]||(e[21]=o()),!d.value&&g.value?(n(),v("div",fe,[...e[13]||(e[13]=[t("div",{class:"text-center"},[t("div",{class:"w-16 h-16 border-4 border-white/20 border-t-white rounded-full animate-spin mx-auto mb-4"}),o(),t("p",{class:"text-white text-lg font-medium"},"آماده‌سازی دوربین...")],-1)])])):c("",!0),e[22]||(e[22]=o()),a.value&&!g.value?(n(),v("div",ce,[t("div",be,[e[15]||(e[15]=t("div",{class:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4"},[t("i",{class:"ti ti-exclamation-triangle text-red-400 text-2xl"})],-1)),e[16]||(e[16]=o()),e[17]||(e[17]=t("h3",{class:"text-white text-lg font-medium mb-2"},"مشکل در دسترسی به دوربین",-1)),e[18]||(e[18]=o()),t("p",pe,T(a.value),1),e[19]||(e[19]=o()),t("div",{class:"space-y-3"},[t("button",{onClick:j,class:"w-full bg-white/20 backdrop-blur-sm hover:bg-white/30 text-white py-3 px-4 rounded-xl font-medium transition-all duration-300"},`\r
              تلاش مجدد\r
            `),e[14]||(e[14]=o()),t("button",{onClick:Q,class:"w-full bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white py-3 px-4 rounded-xl font-medium transition-all duration-300"},`\r
              انتخاب از گالری\r
            `)])])])):c("",!0),e[23]||(e[23]=o()),d.value?(n(),v("div",xe,[...e[20]||(e[20]=[oe('<div class="scanning-overlay" data-v-c9d97f11><div class="overlay-top" data-v-c9d97f11></div> <div class="overlay-bottom" data-v-c9d97f11></div> <div class="overlay-left" data-v-c9d97f11></div> <div class="overlay-right" data-v-c9d97f11></div></div> <div class="scanning-frame" data-v-c9d97f11><div class="w-64 h-64 relative" data-v-c9d97f11><div class="absolute -top-2 -left-2 w-6 h-6 border-l-3 border-t-3 border-white rounded-tl-lg" data-v-c9d97f11></div> <div class="absolute -top-2 -right-2 w-6 h-6 border-r-3 border-t-3 border-white rounded-tr-lg" data-v-c9d97f11></div> <div class="absolute -bottom-2 -left-2 w-6 h-6 border-l-3 border-b-3 border-white rounded-bl-lg" data-v-c9d97f11></div> <div class="absolute -bottom-2 -right-2 w-6 h-6 border-r-3 border-b-3 border-white rounded-br-lg" data-v-c9d97f11></div> <div class="absolute top-0 left-0 right-0 h-0.5 bg-white scan-line" data-v-c9d97f11></div></div></div> <div class="absolute bottom-32 left-4 right-4 text-center z-50" data-v-c9d97f11><div class="bg-black/30 backdrop-blur-sm rounded-xl p-3" data-v-c9d97f11><p class="text-white text-base font-medium" data-v-c9d97f11>QR کد را در قاب قرار دهید</p></div></div>',5)])])):c("",!0)]),e[46]||(e[46]=o()),t("div",ge,[t("div",we,[f(m,{icon:"photo",variant:"tonal-primary",size:"lg",rounded:"",onClick:Q,class:"qr-footer-button"}),e[26]||(e[26]=o()),d.value?c("",!0):(n(),I(U,{key:0,icon:"camera",variant:"tonal-primary",size:"lg",style:{boxShadow:"none",marginBottom:"32px",background:"var(--color-primary)"},onClick:j,class:"qr-main-button"},{default:i(()=>[...e[24]||(e[24]=[o(`\r
          شروع اسکن\r
        `,-1)])]),_:1})),e[27]||(e[27]=o()),d.value?(n(),I(U,{key:1,icon:"qrcode",variant:"tonal-primary",size:"lg",style:{boxShadow:"none",marginBottom:"32px",background:"var(--color-primary)"},onClick:P,class:"qr-main-button"},{default:i(()=>[...e[25]||(e[25]=[o(`\r
          QR کد من\r
        `,-1)])]),_:1})):c("",!0),e[28]||(e[28]=o()),f(m,{icon:"keyboard",variant:"tonal-primary",size:"lg",rounded:"",onClick:G,class:"qr-footer-button"})])]),e[47]||(e[47]=o()),t("input",{ref_key:"fileInput",ref:C,type:"file",accept:"image/*",onChange:O,class:"hidden"},null,544),e[48]||(e[48]=o()),f(q,{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=l=>w.value=l),title:"وارد کردن کد دستی",size:"md",closable:!0,"close-on-backdrop":!0,"show-default-footer":!1,"z-index":"99999"},{header:i(()=>[...e[29]||(e[29]=[t("div",{class:"text-center"},[t("div",{class:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4"},[t("i",{class:"ti ti-keyboard text-primary text-2xl"})]),o(),t("h3",{class:"text-xl font-bold text-foreground mb-2"},"وارد کردن کد دستی"),o(),t("p",{class:"text-muted-foreground text-sm"},"کد فعال‌سازی دستگاه را وارد کنید")],-1)])]),default:i(()=>[e[34]||(e[34]=o()),t("div",ye,[t("div",ke,[se(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l),type:"text",placeholder:"کد فعال‌سازی",class:"w-full p-4 border-2 border-border bg-background text-foreground placeholder-muted-foreground rounded-2xl text-center text-lg font-mono tracking-wider focus:border-primary focus:outline-none transition-colors",maxlength:"20",autofocus:""},null,512),[[le,p.value]])]),e[33]||(e[33]=o()),t("div",he,[f(z,{variant:"outline",size:"lg",class:"flex-1",onClick:e[3]||(e[3]=l=>w.value=!1)},{default:i(()=>[...e[30]||(e[30]=[o(`\r
            انصراف\r
          `,-1)])]),_:1}),e[32]||(e[32]=o()),f(z,{variant:"primary",size:"lg",class:"flex-1",disabled:!p.value.trim(),onClick:J},{default:i(()=>[...e[31]||(e[31]=[o(`\r
            تایید\r
          `,-1)])]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"]),e[49]||(e[49]=o()),f(q,{modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=l=>u.value=l),title:"پشتیبانی لینکو",size:"md",closable:!0,"close-on-backdrop":!0,"show-default-footer":!1,"z-index":"99999"},{header:i(()=>[...e[35]||(e[35]=[t("div",{class:"flex items-center py-2"},[t("div",{class:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center ml-3"},[t("i",{class:"ti ti-headset text-primary text-2xl"})]),o(),t("div",{class:"text-right"},[t("h3",{class:"text-xl font-bold text-foreground mb-1"},"پشتیبانی لینکو"),o(),t("p",{class:"text-sm text-muted-foreground"},"ما آماده کمک به شما هستیم")])],-1)])]),default:i(()=>[e[43]||(e[43]=o()),t("div",Ce,[t("div",Se,[t("button",{onClick:W,class:"w-full bg-muted/50 border border-border rounded-xl p-4 transition-colors duration-200 flex items-center hover:bg-muted"},[...e[36]||(e[36]=[t("div",{class:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center ml-4"},[t("i",{class:"ti ti-message-circle text-primary text-xl"})],-1),o(),t("div",{class:"flex-1 text-right"},[t("div",{class:"font-semibold text-foreground mb-1"},"گفتگوی آنلاین"),o(),t("div",{class:"text-sm text-muted-foreground"},"پاسخ فوری - ۲۴/۷ در دسترس")],-1),o(),t("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])]),e[40]||(e[40]=o()),t("button",{onClick:X,class:"w-full bg-muted/50 border border-border rounded-xl p-4 transition-colors duration-200 flex items-center hover:bg-muted"},[...e[37]||(e[37]=[t("div",{class:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center ml-4"},[t("i",{class:"ti ti-phone text-primary text-xl"})],-1),o(),t("div",{class:"flex-1 text-right"},[t("div",{class:"font-semibold text-foreground mb-1"},"تماس تلفنی"),o(),t("div",{class:"text-sm text-muted-foreground"},"شنبه تا پنج‌شنبه ۹ تا ۱۸")],-1),o(),t("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])]),e[41]||(e[41]=o()),t("button",{onClick:Y,class:"w-full bg-muted/50 border border-border rounded-xl p-4 transition-colors duration-200 flex items-center hover:bg-muted"},[...e[38]||(e[38]=[t("div",{class:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center ml-4"},[t("i",{class:"ti ti-mail text-primary text-xl"})],-1),o(),t("div",{class:"flex-1 text-right"},[t("div",{class:"font-semibold text-foreground mb-1"},"ایمیل پشتیبانی"),o(),t("div",{class:"text-sm text-muted-foreground"},"پاسخ در کمتر از ۲۴ ساعت")],-1),o(),t("i",{class:"ti ti-chevron-left text-muted-foreground"},null,-1)])]),e[42]||(e[42]=o()),f(z,{variant:"outline",size:"lg",class:"w-full",onClick:e[5]||(e[5]=l=>u.value=!1)},{default:i(()=>[...e[39]||(e[39]=[o(`\r
            بستن\r
          `,-1)])]),_:1})])])]),_:1},8,["modelValue"]),e[50]||(e[50]=o()),x.value.show?(n(),v("div",{key:0,class:$(["fixed top-28 left-4 right-4 p-4 rounded-2xl text-white z-40 flex items-center gap-3 transition-all duration-300 backdrop-blur-sm",x.value.success?"bg-green-600/90":"bg-red-600/90"])},[x.value.success?(n(),v("i",Be)):(n(),v("i",Re)),e[44]||(e[44]=o()),t("span",je,T(x.value.message),1)],2)):c("",!0),e[51]||(e[51]=o()),B.value?(n(),I(Z,{key:1,"qr-data":H.value,"user-name":A.value,onClose:e[7]||(e[7]=l=>B.value=!1)},null,8,["qr-data","user-name"])):c("",!0)])}}}),$e=ie(ze,[["__scopeId","data-v-c9d97f11"]]);export{$e as default};
