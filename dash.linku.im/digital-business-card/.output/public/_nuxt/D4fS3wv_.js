import{_ as Ve}from"./CgleJCdt.js";import{y as ye,r as g,d as P,k as b,x as m,Q as Y,q as e,p as o,F as k,l as j,I as Z,n as Oe,w as K,a7 as qe,j as ke,K as Ce,v as c,u as ie,M as $,t as de,H as le,O as xe,s as ae,N as Fe,a2 as Pe,S as we,T as Re}from"./Ct89Yiyn.js";import{f as $e,a as J}from"#entry";import{a as Je,u as He}from"./Drvv-Qqv.js";import{u as ne,d as We}from"./lVmvsOkf.js";import{u as Ze,_,a as Ye,b as Xe,c as Ke,C as Qe,d as Ge,e as he,E as oe}from"./Bs4dFaLE.js";import{_ as Ie}from"./DUksgA9l.js";import{I as De}from"./CFRFqJJ0.js";import{I as Le}from"./DGzIcDwE.js";import{u as _e}from"./AuYbrIUI.js";import{d as et}from"./MnsCIIQl.js";import{_ as tt}from"./DlAUqK2U.js";const st={class:"relative rounded-xl bg-card border border-border h-36 hover:shadow-md transition-shadow"},ot={key:0,class:"absolute inset-0 w-full h-full"},dt=["src"],rt={class:"absolute -bottom-10 left-1/2 transform -translate-x-1/2"},lt={class:"relative"},at=["src"],it={key:1,viewBox:"0 0 24 24",class:"w-10 h-10 text-muted-foreground"},nt=["src"],ut={key:1,class:"text-xs font-bold text-muted-foreground"},ct={class:"p-6"},mt=ye({__name:"CoverAvatarSection",setup(G){const M=ne(),x=g(!1),a=g(!1),S=g(null),r=g("cover"),U=P({get:()=>M.safeCoverImage||"",set:C=>{M.coverImage=C}}),A=P({get:()=>M.safeProfileImage||"",set:C=>{M.profileImage=C}}),L=P({get:()=>M.safeLogoImage||"",set:C=>{M.logoImage=C}}),B=()=>{x.value=!1,u("cover")},N=()=>{x.value=!1,u("profile")},T=()=>{x.value=!1,u("logo")},u=C=>{r.value=C;const i=document.createElement("input");i.type="file",i.accept="image/*",i.onchange=y=>{const V=y.target.files?.[0];V&&(S.value=V,a.value=!0)},i.click()},d=async(C,i)=>{switch(i){case"cover":U.value=C;break;case"profile":A.value=C;break;case"logo":L.value=C;break}await Oe(),a.value=!1,S.value=null},I=()=>{a.value=!1,S.value=null},D=()=>{switch(r.value){case"cover":return 16/9;case"profile":return 1;case"logo":return 1;default:return 1}};return(C,i)=>(m(),b(Y,null,[e("section",st,[U.value?(m(),b("div",ot,[e("img",{src:U.value,alt:"Cover Photo",class:"w-full h-full object-cover"},null,8,dt),i[5]||(i[5]=o()),i[6]||(i[6]=e("div",{class:"absolute inset-0 bg-black/10"},null,-1))])):j("",!0),i[9]||(i[9]=o()),e("button",{onClick:i[0]||(i[0]=y=>x.value=!0),class:"absolute left-4 top-4 rounded-full bg-background/90 backdrop-blur-sm hover:bg-background text-foreground text-xs px-3 py-2 transition-all shadow-lg hover:shadow-xl border border-border/50"},`\r
      ویرایش تصویر\r
    `),i[10]||(i[10]=o()),e("div",rt,[e("div",lt,[e("button",{onClick:i[1]||(i[1]=y=>x.value=!0),class:"w-24 h-24 rounded-full bg-card ring-4 ring-card border border-border grid place-items-center hover:bg-muted/20 transition-colors overflow-hidden"},[A.value?(m(),b("img",{key:0,src:A.value,alt:"Profile Photo",class:"w-full h-full object-cover rounded-full"},null,8,at)):(m(),b("svg",it,[...i[7]||(i[7]=[e("path",{fill:"currentColor",d:"M12 12a4 4 0 1 0-4-4a4 4 0 0 0 4 4Zm0 2c-4.67 0-8 2.33-8 5v1h16v-1c0-2.67-3.33-5-8-5Z"},null,-1)])]))]),i[8]||(i[8]=o()),e("button",{onClick:i[2]||(i[2]=y=>x.value=!0),class:"absolute bottom-0 -left-1 w-10 h-10 rounded-full bg-muted border-2 border-card grid place-items-center hover:bg-primary/80 transition-colors overflow-hidden"},[L.value?(m(),b("img",{key:0,src:L.value,alt:"Company Logo",class:"w-full h-full object-cover rounded-full"},null,8,nt)):(m(),b("span",ut,"لوگو"))])])])]),i[17]||(i[17]=o()),i[18]||(i[18]=e("div",{class:"h-16"},null,-1)),i[19]||(i[19]=o()),k(Ie,{modelValue:x.value,"onUpdate:modelValue":i[4]||(i[4]=y=>x.value=y),size:"auto",closable:!1},{default:Z(()=>[e("div",ct,[e("button",{onClick:B,class:"w-full mb-6 p-6 rounded-2xl bg-card border border-border hover:bg-muted transition-colors flex flex-col items-center justify-center gap-3"},[...i[11]||(i[11]=[e("div",{class:"w-12 h-12 rounded-xl bg-primary flex items-center justify-center"},[e("svg",{viewBox:"0 0 24 24",class:"w-6 h-6 text-primary-foreground"},[e("path",{fill:"currentColor",d:"M5 21q-.825 0-1.413-.588T3 19V5q0-.825.588-1.413T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.588 1.413T19 21H5Zm1-4h12l-3.75-5-3 4L9 13l-3 4Z"})])],-1),o(),e("span",{class:"text-foreground font-medium text-base"},"افزودن عکس کاور",-1)])]),i[15]||(i[15]=o()),e("div",{class:"grid grid-cols-2 gap-4 mb-6"},[e("button",{onClick:N,class:"p-6 rounded-2xl bg-card border border-border hover:bg-muted transition-colors flex flex-col items-center justify-center gap-3"},[...i[12]||(i[12]=[e("div",{class:"w-10 h-10 rounded-full bg-primary flex items-center justify-center"},[e("svg",{viewBox:"0 0 24 24",class:"w-5 h-5 text-primary-foreground"},[e("path",{fill:"currentColor",d:"M12 12a4 4 0 1 0-4-4a4 4 0 0 0 4 4Zm0 2c-4.67 0-8 2.33-8 5v1h16v-1c0-2.67-3.33-5-8-5Z"})])],-1),o(),e("span",{class:"text-foreground font-medium text-sm"},"افزودن پروفایل",-1)])]),i[14]||(i[14]=o()),e("button",{onClick:T,class:"p-6 rounded-2xl bg-card border border-border hover:bg-muted transition-colors flex flex-col items-center justify-center gap-3"},[...i[13]||(i[13]=[e("div",{class:"w-10 h-10 rounded-full border-2 border-primary flex items-center justify-center"},[e("svg",{viewBox:"0 0 24 24",class:"w-4 h-4 text-primary"},[e("path",{fill:"currentColor",d:"M11 11V6h2v5h5v2h-5v5h-2v-5H6v-2z"})])],-1),o(),e("span",{class:"text-foreground font-medium text-sm"},"افزودن لوگو",-1)])])]),i[16]||(i[16]=o()),e("button",{onClick:i[3]||(i[3]=y=>x.value=!1),class:"w-full p-4 rounded-2xl bg-muted border border-border text-foreground font-semibold text-base transition-colors hover:bg-muted/80"},`\r
        انصراف\r
      `)])]),_:1},8,["modelValue"]),i[20]||(i[20]=o()),k(De,{show:a.value,"image-file":S.value||void 0,"aspect-ratio":D(),"field-name":r.value,onClose:I,onCropped:d},null,8,["show","image-file","aspect-ratio","field-name"])],64))}}),ft={class:"space-y-3"},vt={class:"space-y-4"},pt={class:"grid grid-cols-1"},gt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},bt={class:"grid grid-cols-1"},xt={class:"bg-card border border-border p-6 rounded-xl space-y-6"},wt={class:"space-y-3"},ht={class:"pt-4 border-t border-border/50"},yt={__name:"TabAbout",emits:["open-preview"],setup(G,{emit:M}){const x=$e(),a=g(""),S=g(""),r=ne(),{$axios:U}=J();g(!1);const A=g(!1),L=g(!1),B=g(!1),N=g(""),T=g("ti-alert-triangle"),u=(h,l="ti-lock")=>{N.value=h,T.value=l,B.value=!0,setTimeout(()=>B.value=!1,3e3)};K(()=>x.query,h=>{h.id&&(a.value=h.id,S.value=h.slug||"")},{immediate:!0});async function d(){const h=new CustomEvent("manual-save",{detail:{source:"about-form"}});window.dispatchEvent(h);const l=new FormData;l.append("cardName",r.cardName||""),l.append("name",r.name||""),l.append("location",r.location||""),l.append("job",r.job||""),l.append("company",r.company||""),l.append("bio",r.bio||""),l.append("saveContact",r.saveContact||""),l.append("themeColor",JSON.stringify(r.themeColor||{})),l.append("iconColor",JSON.stringify(r.iconColor||{})),l.append("matchThemeColor",r.matchThemeColor?1:0),l.append("layoutMode",r.layout||"");try{const v=await U.post(`v1/cards/${a.value}/update`,l,{headers:{"X-HTTP-Method-Override":"PUT"}});v.data.success?(await I(a.value),u(v.data.message,"ti-check")):u(v.data.message,"ti-alert-triangle")}catch(v){if(v.response){const X=v.response.status;u(v.response.data.message,"ti-alert-triangle")}else u("اتصال به سرور ممکن نیست.","ti-alert-triangle")}finally{L.value=!1}}async function I(h){const l=["profileImage","coverImage","logoImage"],v=new FormData;v.append("modelType","card"),v.append("modelId",h||"");function X(R,z){const H=atob(R.split(",")[1]),ee=new ArrayBuffer(H.length),re=new Uint8Array(ee);for(let W=0;W<H.length;W++)re[W]=H.charCodeAt(W);return new Blob([ee],{type:z})}let O=!1;for(const R of l){const z=r[R];if(z){if(typeof z=="string"&&z.startsWith("data:")){const H=X(z,"image/png");v.append(R,H,`${R}.png`),O=!0;continue}if(z instanceof File||z instanceof Blob){v.append(R,z),O=!0;continue}typeof z=="string"&&(z.startsWith("http")||z.startsWith("/storage/"))}}if(O)try{(await U.post(`file-manager/${h}/upload`,v)).data.success?u("تصاویر با موفقیت آپلود شدند","ti-image"):u("آپلود تصاویر با خطا مواجه شد","ti-alert-triangle")}catch{u("خطا در آپلود تصاویر","ti-alert-triangle")}}function D(){A.value=!1}function C(h){r.cardName=h,A.value=!1}g(!1);const i={right:"راست‌چین",left:"چپ‌چین",center:"وسط‌چین",portrait:"پرتره"};P(()=>i[r.layout]),P(()=>typeof r.cardName=="string"&&r.cardName.trim()!==""?r.cardName:"نام کارت را وارد کنید"),P(()=>r.matchThemeColor??!1);const y=_e(),V=Ze();return qe(async()=>{const h=a.value;if(!h)return;await V.fetchLinks(h),r.links=V.links,await y.fetchCard(h);const l=y.activeCard?.fields;Array.isArray(l)&&(r.fields=l),(!Array.isArray(r.fields)||r.fields.length===0)&&(r.fields=structuredClone(We))}),ke(()=>{window.addEventListener("manual-save",h=>{h.detail?.source==="header-save"&&d()})}),Ce(()=>{window.removeEventListener("manual-save",h=>{h.detail?.source==="header-save"&&d()})}),(h,l)=>(m(),b(Y,null,[e("div",ft,[k(mt),l[18]||(l[18]=o()),e("div",vt,[e("div",pt,[k(_,{label:"نام کامل",modelValue:c(r).name,"onUpdate:modelValue":l[0]||(l[0]=v=>c(r).name=v),placeholder:"نام و نام خانوادگی",maxlength:40,error:c(r).name&&c(r).name.length>40?"حداکثر ۴۰ کاراکتر مجاز است":""},null,8,["modelValue","error"])]),l[9]||(l[9]=o()),e("div",gt,[k(_,{label:"سمت شغلی",modelValue:c(r).job,"onUpdate:modelValue":l[1]||(l[1]=v=>c(r).job=v),placeholder:"عنوان شغلی",maxlength:30,error:c(r).job&&c(r).job.length>30?"حداکثر ۳۰ کاراکتر مجاز است":""},null,8,["modelValue","error"]),l[8]||(l[8]=o()),k(_,{label:"شرکت",modelValue:c(r).company,"onUpdate:modelValue":l[2]||(l[2]=v=>c(r).company=v),placeholder:"نام سازمان",maxlength:30,error:c(r).company&&c(r).company.length>30?"حداکثر ۳۰ کاراکتر مجاز است":""},null,8,["modelValue","error"])]),l[10]||(l[10]=o()),e("div",bt,[k(_,{label:"موقعیت جغرافیایی",modelValue:c(r).location,"onUpdate:modelValue":l[3]||(l[3]=v=>c(r).location=v),placeholder:"شهر، کشور",maxlength:30,error:c(r).location&&c(r).location.length>30?"حداکثر ۳۰ کاراکتر مجاز است":""},null,8,["modelValue","error"])])]),l[19]||(l[19]=o()),k(Ye,{label:"بیوگرافی",modelValue:c(r).bio,"onUpdate:modelValue":l[4]||(l[4]=v=>c(r).bio=v),placeholder:"درباره خود توضیح دهید...",maxlength:100,error:c(r).bio&&c(r).bio.length>100?"حداکثر 100 کاراکتر مجاز است":""},null,8,["modelValue","error"]),l[20]||(l[20]=o()),k(_,{label:"عنوان دکمه ذخیره مخاطب",modelValue:c(r).saveContact,"onUpdate:modelValue":l[5]||(l[5]=v=>c(r).saveContact=v),placeholder:"دکمه ذخیره مخاطب",maxlength:20,error:c(r).saveContact&&c(r).saveContact.length>20?"حداکثر ۲۰ کاراکتر مجاز است":""},null,8,["modelValue","error"]),l[21]||(l[21]=o()),e("div",null,[l[16]||(l[16]=e("h3",{class:"text-base font-medium text-foreground mb-3"},"رنگ‌بندی کارت",-1)),l[17]||(l[17]=o()),e("div",xt,[e("div",wt,[l[11]||(l[11]=e("h4",{class:"text-sm font-semibold text-foreground"},"رنگ اصلی",-1)),l[12]||(l[12]=o()),l[13]||(l[13]=e("p",{class:"text-xs text-muted-foreground"},"با انتخاب یک رنگ، هم پس‌زمینه و هم رنگ آیکون‌ها تنظیم می‌شود",-1)),l[14]||(l[14]=o()),k(Xe)]),l[15]||(l[15]=o()),e("div",ht,[k(Ke,{selected:c(r).iconColor,matchThemeColor:c(r).matchThemeColor,onUpdate:l[6]||(l[6]=v=>c(r).iconColor=v),"onUpdate:matchTheme":l[7]||(l[7]=v=>c(r).matchThemeColor=v)},null,8,["selected","matchThemeColor"])])])]),l[22]||(l[22]=o()),k(Qe,{isOpen:A.value,currentCardName:typeof c(r).cardName=="string"?c(r).cardName:"",onClose:D,onUpdate:C},null,8,["isOpen","currentCardName"])]),l[23]||(l[23]=o()),k(Le,{visible:B.value,message:N.value,icon:T.value},null,8,["visible","message","icon"])],64))}},kt={class:"flex items-center gap-2 text-sm text-muted-foreground"},Ct={class:"px-6"},$t={class:"md:hidden"},It={class:"flex gap-8 overflow-x-auto px-6 pb-6 pt-6 snap-x snap-mandatory",role:"radiogroup","aria-label":"گزینه‌های چیدمان"},Lt=["aria-checked"],Nt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Tt=["aria-checked"],jt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},St=["aria-checked"],Mt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},zt=["aria-checked"],Et={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Ut={class:"hidden md:block px-6 pb-6 pt-6"},At={class:"grid grid-cols-2 lg:grid-cols-4 gap-12 max-w-6xl mx-auto",role:"radiogroup","aria-label":"گزینه‌های چیدمان"},Bt=["aria-checked"],Vt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Ot=["aria-checked"],qt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Ft=["aria-checked"],Pt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Rt=["aria-checked"],Jt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Ht={class:"px-4 pb-4 pt-4 border-t border-border space-y-3"},Wt=ye({__name:"LayoutSelector",props:{modelValue:{}},emits:["update:modelValue","layout-changed","confirm"],setup(G,{emit:M}){const x=G,a=M,S=g(!1),r=g(x.modelValue??"right");K(()=>x.modelValue,u=>{u&&(r.value=u)});const U={right:"راست‌چین",left:"چپ‌چین",center:"وسط‌چین",portrait:"پورتریت"},A=P(()=>U[r.value]||"راست‌چین");function L(u){r.value=u,a("update:modelValue",de(u)),a("layout-changed",de(u))}function B(){S.value=!1,a("confirm",de(r.value))}function N(u){return["relative w-36 h-64 rounded-2xl border border-border overflow-hidden shadow-sm transition-colors",r.value===u?"ring-1 ring-foreground":"hover:border-muted-foreground/60"].join(" ")}function T(u){return["mt-1.5 inline-flex items-center justify-center w-6 h-6 rounded-full",r.value===u?"bg-foreground text-background":"border-2 border-muted"].join(" ")}return(u,d)=>(m(),b(Y,null,[e("div",{class:"w-full rounded-xl bg-card border border-border px-4 py-3 flex items-center justify-between hover:bg-muted transition-colors cursor-pointer",onClick:d[0]||(d[0]=I=>S.value=!0)},[d[12]||(d[12]=e("span",{class:"text-sm font-medium text-foreground"},"تغییر چیدمان",-1)),d[13]||(d[13]=o()),e("span",kt,[o(ie(A.value)+" ",1),d[11]||(d[11]=e("svg",{viewBox:"0 0 24 24",class:"w-5 h-5 rotate-180"},[e("path",{fill:"currentColor",d:"M9.3 6.3a1 1 0 0 1 1.4 0l5 5a1 1 0 0 1 0 1.4l-5 5a1 1 0 0 1-1.4-1.4L13.6 12 9.3 7.7a1 1 0 0 1 0-1.4Z"})],-1))])]),d[62]||(d[62]=o()),k(Ie,{modelValue:S.value,"onUpdate:modelValue":d[10]||(d[10]=I=>S.value=I),size:"auto",closable:!0,role:"dialog","aria-modal":"true",title:"چیدمان"},{default:Z(()=>[e("div",Ct,[e("div",$t,[e("div",It,[e("button",{onClick:d[1]||(d[1]=I=>L("right")),"aria-checked":r.value==="right",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:$(N("right"))},[...d[14]||(d[14]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 right-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -left-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-end gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),d[16]||(d[16]=o()),d[17]||(d[17]=e("p",{class:"text-xs mt-2 text-foreground"},"راست‌چین",-1)),d[18]||(d[18]=o()),e("span",{class:$(T("right"))},[r.value==="right"?(m(),b("svg",Nt,[...d[15]||(d[15]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,Lt),d[34]||(d[34]=o()),e("button",{onClick:d[2]||(d[2]=I=>L("left")),"aria-checked":r.value==="left",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:$(N("left"))},[...d[19]||(d[19]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-start gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),d[21]||(d[21]=o()),d[22]||(d[22]=e("p",{class:"text-xs mt-2 text-foreground"},"چپ‌چین",-1)),d[23]||(d[23]=o()),e("span",{class:$(T("left"))},[r.value==="left"?(m(),b("svg",jt,[...d[20]||(d[20]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,Tt),d[35]||(d[35]=o()),e("button",{onClick:d[3]||(d[3]=I=>L("center")),"aria-checked":r.value==="center",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:$(N("center"))},[...d[24]||(d[24]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-1/2 -translate-x-1/2"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-center gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),d[26]||(d[26]=o()),d[27]||(d[27]=e("p",{class:"text-xs mt-2 text-foreground"},"وسط‌چین",-1)),d[28]||(d[28]=o()),e("span",{class:$(T("center"))},[r.value==="center"?(m(),b("svg",Mt,[...d[25]||(d[25]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,St),d[36]||(d[36]=o()),e("button",{onClick:d[4]||(d[4]=I=>L("portrait")),"aria-checked":r.value==="portrait",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:$(N("portrait"))},[...d[29]||(d[29]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-20 bg-gradient-to-b from-muted to-card/90"},[e("div",{class:"absolute bottom-2 right-2"},[e("div",{class:"w-8 h-8 rounded-full bg-card border border-border flex items-center justify-center"},[e("i",{class:"ti ti-user text-xs text-muted-foreground"})])])]),o(),e("div",{class:"px-3 pt-4 pb-3"},[e("div",{class:"space-y-2 mb-4 text-center"},[e("div",{class:"mx-auto w-20 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"mx-auto w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"}),o(),e("div",{class:"space-y-2"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-20 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-16 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-18 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-14 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-16 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-18 h-1.5 bg-muted rounded"})])])])])],-1)])],2),d[31]||(d[31]=o()),d[32]||(d[32]=e("p",{class:"text-xs mt-2 text-foreground"},"پورتریت",-1)),d[33]||(d[33]=o()),e("span",{class:$(T("portrait"))},[r.value==="portrait"?(m(),b("svg",Et,[...d[30]||(d[30]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,zt)])]),d[60]||(d[60]=o()),e("div",Ut,[e("div",At,[e("button",{onClick:d[5]||(d[5]=I=>L("right")),"aria-checked":r.value==="right",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:$(N("right"))},[...d[37]||(d[37]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 right-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -left-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-end gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"w-28 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),d[39]||(d[39]=o()),d[40]||(d[40]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"راست‌چین",-1)),d[41]||(d[41]=o()),e("span",{class:$(T("right"))},[r.value==="right"?(m(),b("svg",Vt,[...d[38]||(d[38]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,Bt),d[57]||(d[57]=o()),e("button",{onClick:d[6]||(d[6]=I=>L("left")),"aria-checked":r.value==="left",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:$(N("left"))},[...d[42]||(d[42]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-start gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"w-28 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-4"})]),o(),e("div",{class:"px-3 pb-3 mt-auto space-y-3"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"w-24 h-1.5 bg-muted rounded"})]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"w-20 h-1.5 bg-muted rounded"})])])],-1)])],2),d[44]||(d[44]=o()),d[45]||(d[45]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"چپ‌چین",-1)),d[46]||(d[46]=o()),e("span",{class:$(T("left"))},[r.value==="left"?(m(),b("svg",qt,[...d[43]||(d[43]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,Ot),d[58]||(d[58]=o()),e("button",{onClick:d[7]||(d[7]=I=>L("center")),"aria-checked":r.value==="center",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:$(N("center"))},[...d[47]||(d[47]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-1/2 -translate-x-1/2"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-center gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"w-28 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),d[49]||(d[49]=o()),d[50]||(d[50]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"وسط‌چین",-1)),d[51]||(d[51]=o()),e("span",{class:$(T("center"))},[r.value==="center"?(m(),b("svg",Pt,[...d[48]||(d[48]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,Ft),d[59]||(d[59]=o()),e("button",{onClick:d[8]||(d[8]=I=>L("portrait")),"aria-checked":r.value==="portrait",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:$(N("portrait"))},[...d[52]||(d[52]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-20 bg-gradient-to-b from-muted to-card/90"},[e("div",{class:"absolute bottom-2 right-2"},[e("div",{class:"w-8 h-8 rounded-full bg-card border border-border flex items-center justify-center"},[e("i",{class:"ti ti-user text-xs text-muted-foreground"})])])]),o(),e("div",{class:"px-3 pt-4 pb-3"},[e("div",{class:"space-y-3 mb-6 text-center"},[e("div",{class:"mx-auto w-20 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"mx-auto w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"mx-auto w-24 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-6"}),o(),e("div",{class:"space-y-3"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-20 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-24 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-18 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-22 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-16 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-20 h-1.5 bg-muted rounded"})])])])])],-1)])],2),d[54]||(d[54]=o()),d[55]||(d[55]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"پورتریت",-1)),d[56]||(d[56]=o()),e("span",{class:$(T("portrait"))},[r.value==="portrait"?(m(),b("svg",Jt,[...d[53]||(d[53]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):j("",!0)],2)],8,Rt)])])]),d[61]||(d[61]=o()),e("div",Ht,[e("button",{onClick:d[9]||(d[9]=I=>B()),class:"w-full py-3 bg-foreground/80 text-background rounded-xl font-semibold hover:bg-foreground transition-colors"},`\r
        تایید چیدمان\r
      `)])]),_:1},8,["modelValue"])],64))}}),Zt={class:"flex flex-col"},Yt={class:"fixed top-0 left-0 right-0 w-full bg-background/95 backdrop-blur-lg border-b border-border z-[100] block lg:hidden"},Xt={class:"flex items-center justify-between w-full p-4"},Kt={class:"flex items-center gap-2"},Qt={key:0,class:"w-full grid grid-cols-1 lg:grid-cols-6 gap-4 lg:pt-6 pb-24 lg:pb-6 animate-pulse"},Gt={key:1,class:"w-full grid grid-cols-1 lg:grid-cols-6 gap-4 lg:pt-6 pb-24 lg:pb-6"},Dt={class:"lg:col-span-4 min-h-0 px-1 lg:px-0"},_t={class:"mb-6"},es={class:"bg-card p-4 sm:p-6 rounded-xl mb-6 border border-border mt-8"},ts={class:"flex items-center justify-between"},ss={class:"relative inline-flex items-center cursor-pointer"},os={key:0,class:"space-y-3 mb-6 mt-8"},ds={class:"flex items-center gap-3"},rs={class:"w-10 h-10 rounded-lg bg-muted flex items-center justify-center"},ls=["src"],as={class:"font-medium text-foreground"},is={class:"flex items-center gap-2"},ns=["onClick"],us=["onClick"],cs={class:"bg-card mt-4 rounded-xl p-6 border border-border hover:shadow-md transition-shadow"},ms={class:"hidden lg:block mt-8"},fs={class:"flex justify-end"},vs=["disabled"],ps={class:"lg:col-span-2 space-y-4 sticky z-0 top-16 h-fit w-full hidden lg:block"},gs={class:"flex justify-center"},bs={class:"relative",style:{width:"390px",height:"844px"}},xs={class:"absolute inset-0 rounded-[40px] border-4 border-gray-800 bg-black shadow-xl"},ws={class:"absolute inset-2 rounded-[32px] overflow-hidden bg-white"},hs=["src"],ys={class:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-lg border-t border-border p-4 z-40 lg:hidden"},ks={class:"max-w-4xl mx-auto flex gap-3"},Cs=["disabled"],$s={key:0,class:"fixed inset-0 z-[9999] lg:hidden bg-white"},Is={class:"fixed top-0 left-0 right-0 z-10 bg-white border-b border-gray-200 safe-area-top"},Ls={class:"flex items-center justify-between px-4 py-3"},Ns={class:"pt-14 h-full w-full bg-white"},Ts=["src"],js={class:"bg-background rounded-none lg:rounded-2xl w-full h-full lg:max-w-md lg:h-auto lg:max-h-[90vh] overflow-y-auto overflow-x-hidden lg:shadow-2xl border-0 lg:border border-border"},Ss={class:"flex items-center justify-between p-4 border-b border-border bg-background sticky top-0 z-10"},Ms={class:"text-base font-semibold text-foreground"},zs={class:"flex items-center gap-2"},Es=["href"],Us={class:"flex-1"},As={__name:"index",props:{cardId:String,cardSlug:String},setup(G){const M=G,x=Je(),a=ne(),S=$e(),r=g(!0),U=g(!1),{getIconComponent:A,getSafeIcon:L}=He(),B=g(!1),N=g(""),T=g("ti-alert-triangle"),u=(s,t="ti-check")=>{N.value=s,T.value=t,B.value=!0,setTimeout(()=>B.value=!1,3e3)},d=P(()=>M.cardId||S.params.cardId||S.query.id||S.params.id||x.selectedCardId||null),I=P(()=>{if(x.value.iconColor?.background&&x.value.iconColor.background!=="transparent")return x.value.iconColor.background}),D=P(()=>!!(x.value.iconColor?.background&&x.value.iconColor.background!=="transparent")),C=g(!1);g(!1);const i=g(!1),y=g(null),V=g(-1),h=g(a.layout||"right");K(()=>a.layout,s=>{s&&s!==h.value&&(h.value=s)},{immediate:!0});function l(s){a.links||(a.links=[]);const t={...s};(!t.description||t.description.trim()===""||t.description==="description")&&delete t.description;const f=a.normalizeLink?a.normalizeLink(t):{...t,id:t.id||Date.now()+"_"+Math.random(),title:t.title||t.name||"",enabled:t.enabled!==void 0?t.enabled:!0};v(f),u("لینک با موفقیت اضافه شد","ti-check"),C.value=!1}async function v(s){if(!d.value){console.warn("No cardId available for creating link");return}try{const f=J().$axios,n={action:s.action||"",baseUrl:s.baseUrl||"",enabled:s.enabled!==void 0?s.enabled:!0,icon:s.icon?JSON.stringify(s.icon):null,id:s.id||`${Date.now()}_${Math.random().toString(36).slice(2)}`,name:s.name||"",title:s.title||"",type:s.type||"link",value:s.value||"",username:s.username||"",placeholder:s.placeholder?JSON.stringify(s.placeholder):null,showDescription:s.showDescription||!1,fullName:s.fullName||"",phoneNumber:s.phoneNumber||"",phoneRequired:s.phoneRequired||"",rewards:s.rewards||"",segments:s.segments||"",prizes:s.prizes||"",difficulty:s.difficulty||"",submitButtonText:s.submitButtonText||"",thankYouMessage:s.thankYouMessage||"",avatar:s.avatar||"",align:s.align||"",options:s.options||"",fileName:s.fileName||"",fileType:s.fileType||"",accountHolder:s.accountHolder||"",accountNumber:s.accountNumber||"",bankName:s.bankName||"",cardNumber:s.cardNumber||"",customBank:s.customBank||"",ibanNumber:s.ibanNumber||"",showBankDropdown:s.showBankDropdown||"",highlight:s.highlight||!1,access:s.access||"",address:s.address||"",days:s.days||"",mode:s.mode||"",latitude:s.latitude||"",longitude:s.longitude||"",zoom:s.zoom||"",fields:s.fields||"",selectedItems:s.selectedItems||""};s.description&&s.description.trim()&&s.description.trim()!==""&&(n.description=s.description.trim()),s.customIcon&&s.customIcon.trim()&&(n.customIcon=s.customIcon),console.log("Creating new link:",n);const w=await f.post(`v1/cards/${d.value}/links`,{link:JSON.stringify(n)});if(w.data.success){console.log("Link created successfully:",w.data.data);const p=a.normalizeLink?a.normalizeLink(w.data.data):w.data.data;a.links.push(p),q()}else throw new Error(w.data.message||"خطا در ایجاد لینک")}catch(t){console.error("Error creating link:",t),u("خطا در ایجاد لینک","ti-alert-triangle")}}function X(s,t){const f={map:"linkumap",bank:"card",bankcard:"card"};let n=s.icon;if(typeof s.icon=="string")try{n=JSON.parse(s.icon)}catch{const F=s.action?.toLowerCase(),E=f[F]||F;n=E?{type:"component",name:E,path:E}:null}if(!n&&s.action){const p=s.action.toLowerCase(),F=f[p]||p;n={type:"component",name:F,path:F}}const w={...s,icon:n,type:s.type||(s.action?.includes("block")?"block":"link"),action:s.action?.toLowerCase()||"basiclink",username:s.baseUrl&&s.value?.startsWith(s.baseUrl)?s.value.replace(s.baseUrl,""):s.username||""};w.title||(w.title=s.name||"بدون عنوان"),w.value||(w.value=""),y.value=w,V.value=t,i.value=!0}function O(){i.value=!1,y.value=null,V.value=-1}function R(){if(!y.value)return"ویرایش محتوا";const s={basiclink:"ویرایش لینک",email:"ویرایش ایمیل",phone:"ویرایش تلفن",whatsapp:"ویرایش واتساپ",telegram:"ویرایش تلگرام",instagram:"ویرایش اینستاگرام",twitter:"ویرایش توییتر",youtube:"ویرایش یوتیوب",linkedin:"ویرایش لینکدین",map:"ویرایش نقشه",text:"ویرایش متن",faq:"ویرایش سوالات متداول",divider:"ویرایش جداکننده",contact:"ویرایش فرم تماس",payment:"ویرایش پرداخت",file:"ویرایش فایل"},t=y.value.action?.toLowerCase();return s[t]||"ویرایش محتوا"}function z(s){const t={call:"تماس",number:"پیامک",email:"ایمیل",whatsapp:"واتساپ",telegram:"تلگرام",instagram:"اینستاگرام",linkedin:"لینکدین",twitter:"توییتر",youtube:"یوتیوب",tiktok:"تیک‌تاک",facebook:"فیسبوک",snapchat:"اسنپ‌چت",threads:"تردز",twitch:"توییچ",rubika:"روبیکا",bale:"بله",eitaa:"ایتا",igap:"آی‌گپ",discord:"دیسکورد",map:"نقشه",address:"آدرس",poll:"نظرسنجی",questionbox:"جعبه سوال",expandabletext:"متن بازشونده",textsection:"بخش متنی",file:"فایل",bankcard:"کارت بانکی",workhours:"ساعات کاری",contactcard:"کارت تماس",embeddedvideo:"ویدیو",customlink:"لینک سفارشی",luckydice:"تاس شانس",luckywheel:"گردونه شانس",luckyegg:"تخم مرغ شانس",builder:"فرم‌ساز",spotify:"اسپاتیفای",soundcloud:"ساندکلود",aparat:"آپارات",virgool:"ویرگول"},f=s.action?.toLowerCase();if(s.title&&s.title.trim()){const n=s.title.trim();if(!/^\+?[\d\s-]{8,20}$/.test(n)&&!/^[\d]+$/.test(n))return n}return s.name&&s.name.trim()?s.name.trim():f&&t[f]?t[f]:"بدون عنوان"}function H(s){if(!s)return null;const t=["bankcard","workhours","embeddedvideo","file","poll","textsection","questionbox","expandabletext","builder","luckydice","luckywheel","luckyegg","contactcard"];if(s.action&&t.includes(s.action.toLowerCase()))return null;if(s.baseUrl&&s.username)return s.baseUrl+s.username;if(s.username&&s.action){const n={telegram:"https://t.me/",instagram:"https://instagram.com/",twitter:"https://x.com/",youtube:"https://youtube.com/",linkedin:"https://linkedin.com/in/",tiktok:"https://www.tiktok.com/@",whatsapp:"https://wa.me/",facebook:"https://facebook.com/",threads:"https://www.threads.net/@",snapchat:"https://snapchat.com/add/",twitch:"https://twitch.tv/",rubika:"https://rubika.ir/",bale:"https://ble.ir/",eitaa:"https://eitaa.com/"}[s.action.toLowerCase()];if(n)return n+s.username}return s.value&&(s.value.startsWith("http")||s.value.startsWith("mailto:")||s.value.startsWith("tel:"))?s.value:null}function ee(s){if(!s||!s.action)return he;const t=s.action.toLowerCase();if(Object.prototype.hasOwnProperty.call(oe,t))return oe[t];const f=Object.keys(oe).find(n=>n.toLowerCase()===t);return f?oe[f]:he}async function re(s){const t={...s};if(t.baseUrl&&t.username&&(t.value=t.baseUrl+t.username),!!t.id)try{const n=J().$axios,w={backgroundImage:t.backgroundImage??"",phoneRequired:t.phoneRequired??"",rewards:t.rewards??"",segments:t.segments??"",prizes:t.prizes??"",difficulty:t.difficulty??"",submitButtonText:t.submitButtonText??"",thankYouMessage:t.thankYouMessage??"",avatar:t.avatar??"",align:t.align??"",options:t.options??"",fileName:t.fileName??"",fileType:t.fileType??"",accountHolder:t.accountHolder??"",accountNumber:t.accountNumber??"",bankName:t.bankName??"",cardNumber:t.cardNumber??"",customBank:t.customBank??"",ibanNumber:t.ibanNumber??"",showBankDropdown:t.showBankDropdown??"",highlight:t.highlight??!1,access:t.access??"",address:t.address??"",days:t.days??"",mode:t.mode??"",latitude:t.latitude??"",longitude:t.longitude??"",zoom:t.zoom??"",action:t.action??"",fields:t.fields??"",baseUrl:t.baseUrl??"",customIcon:t.customIcon??"",description:t.description??"",enabled:t.enabled,icon:t.icon?typeof t.icon=="string"?t.icon:JSON.stringify(t.icon):t.action?JSON.stringify({type:"component",name:t.action}):null,id:t.id,name:t.name,username:t.username??"",selectedItems:t.selectedItems??"",placeholder:t.placeholder?JSON.stringify(t.placeholder):null,showDescription:t.showDescription??!1,title:t.title,type:t.type,value:t.value??""},p=await n.put(`v1/cards/${d.value}/links/${t.id}/update`,{link:JSON.stringify(w)});if(p.data?.success){const F=a.links.findIndex(E=>E.id===t.id);if(F!==-1){const E=p.data.data||{};if(typeof E.icon=="string")try{E.icon=JSON.parse(E.icon)}catch{E.icon=t.icon}E.icon||(E.icon=t.icon),a.links[F]={...t,...E},a.links=[...a.links]}i.value=!1,y.value=null,V.value=-1,q(),u(p.data.message||"لینک با موفقیت ویرایش شد","ti-check")}else u(p.data.message||"خطا در ویرایش لینک","ti-alert-triangle")}catch(f){f.response?u(f.response.data.message||"خطا در ویرایش لینک","ti-alert-triangle"):u("مشکلی در ارتباط با سرور وجود دارد","ti-alert-triangle")}}function W(s){if(a.links&&a.links.length>s){const t=a.links[s];t.id&&d.value?Ne(t.id,s):(a.links.splice(s,1),q(),u("لینک حذف شد","ti-check"))}}async function Ne(s,t){if(!d.value||!s){console.warn("No cardId or linkId available for deletion"),a.links&&a.links.length>t&&(a.links.splice(t,1),q(),u("لینک حذف شد","ti-check"));return}try{const n=J().$axios;console.log("Deleting link:",s),(await n.delete(`v1/cards/${d.value}/links/${s}/delete`)).data.success?(console.log("Link deleted successfully"),a.links&&a.links.length>t&&a.links.splice(t,1),q(),u("لینک حذف شد","ti-check")):(a.links&&a.links.length>t&&a.links.splice(t,1),q(),u("لینک حذف شد","ti-check"))}catch(f){console.error("Error deleting link:",f),a.links&&a.links.length>t&&a.links.splice(t,1),q(),u("لینک حذف شد","ti-check")}}function Te(s){U.value=!1,s.oldIndex!==s.newIndex&&(je(),q(),u("ترتیب لینک‌ها تغییر کرد","ti-arrows-move"))}async function je(){if(!(!d.value||!a.links||a.links.length===0))try{const t=J().$axios,f=a.links.map(w=>w.hash);console.log("Saving links order by hash:",f);const n=await t.post(`v1/cards/${d.value}/links/reorder`,{hashOrder:f});if(n.data.success)console.log("Links order saved successfully");else throw new Error(n.data.message||"خطا در ذخیره ترتیب لینک‌ها")}catch(s){console.error("Error saving links order:",s),Me()}}function ue(s){const t=s.icon||null;return t&&typeof t=="object"?A(t):null}function ce(s){return L(s)}function Se(s){return{call:"phone",number:"message",email:"mail",telegram:"brand-telegram",whatsapp:"brand-whatsapp",eitaa:"brand-telegram",contactcard:"id-badge-2",address:"map-pin",facetime:"video",map:"map",instagram:"brand-instagram",facebook:"brand-facebook",tiktok:"brand-tiktok",twitter:"brand-twitter",x:"brand-x",linkedin:"brand-linkedin",youtube:"brand-youtube",aparat:"video",discord:"brand-discord",snapchat:"brand-snapchat",pinterest:"brand-pinterest",threads:"brand-threads",clubhouse:"microphone",twitch:"brand-twitch",rubika:"message-circle",bale:"message-circle",igap:"message-circle",medium:"brand-medium",virgool:"article",website:"world",app_link:"apps",github:"brand-github",booksy:"calendar",calendly:"calendar-event",card:"credit-card",chili:"chili",etsy:"shopping-bag",reviews:"star",review:"star",square:"square",yelp:"star",divar:"home",snapp:"car",nshan:"map",neshan:"map",balad:"map-pin",figma:"brand-figma",googlemeet:"video",teams:"brand-teams",zoom:"video",trustpilot:"star",zillow:"home",cashapp:"currency-dollar",paypal:"brand-paypal",zelle:"currency-dollar",remit:"currency-dollar",reymit:"currency-dollar",zarinpal:"credit-card",trustwallet:"wallet",customlink:"external-link",dropdown:"chevron-down",embeddedvideo:"player-play",featured:"star",featuredlink:"star",file:"file",textsection:"file-text","text-section":"file-text",poll:"chart-bar",questionbox:"help-circle",hoobe:"music",linktree:"tree",opensea_color:"palette",podcasts:"microphone",poshmark:"shopping-bag",spotify:"brand-spotify",youtube_music:"music",apple_music:"music",luckyegg:"egg",luckydice:"dice",luckywheel:"wheel",form:"forms"}[s.action]||"link"}async function Me(){if(!d.value){console.warn("No cardId available for saving links");return}try{const t=J().$axios,f=new FormData,n=a.links?a.links.map(p=>{const F={...p,id:p.id||Date.now()+"_"+Math.random(),title:p.title||p.name||"",action:p.action||"customlink",url:p.url||"",enabled:p.enabled!==void 0?p.enabled:!0,icon:p.icon||null,customIcon:p.customIcon||null,isListMode:p.isListMode!==void 0?p.isListMode:!0};return p.description&&p.description.trim()&&p.description.trim()!==""&&(F.description=p.description.trim()),F}):[];f.append("linksDataList",JSON.stringify(n)),console.log("Saving links to server:",n);const w=await t.post(`v1/cards/${d.value}/update`,f,{headers:{"X-HTTP-Method-Override":"PUT"}});if(w.data.success)console.log("Links saved successfully"),q();else throw new Error(w.data.message||"خطا در ذخیره لینک‌ها")}catch(s){console.error("Error saving links:",s),u("خطا در ذخیره لینک‌ها","ti-alert-triangle")}}function ze(s){}async function Ee(s){try{if(x.value&&(x.value.layout=s),a.layout=s,M.cardId){const t=new FormData;t.append("layoutMode",s),a.themeColor&&t.append("themeColor",JSON.stringify(a.themeColor)),a.iconColor&&t.append("iconColor",JSON.stringify(a.iconColor));const w=await J().$axios.post(`v1/cards/${M.cardId}/update`,t,{headers:{"X-HTTP-Method-Override":"PUT"}});if(w.data.success)u("چیدمان با موفقیت ذخیره شد","ti-check");else throw new Error(w.data.message||"خطا در ذخیره چیدمان")}else u("چیدمان تغییر کرد","ti-check")}catch{u("خطا در ذخیره چیدمان","ti-alert-triangle")}}function Ue(){if(y.value){O();return}window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0?window.location.href="/dashboard":window.history.length>2?window.history.back():window.location.href="/dashboard"}function Ae(){console.log("goToLeadCapture clicked!"),window.location.href="/profile/lead-capture"}const Q=g(!1),me=()=>{Q.value=!0;const s=new CustomEvent("manual-save",{detail:{source:"header-save"}});window.dispatchEvent(s),setTimeout(()=>{Q.value=!1,u("تغییرات با موفقیت ذخیره شد","ti-check")},2e3)},{$axios:Bs}=J(),te=g(null),fe=g(0),se=g(!1),Be=g(!0),ve=g(!1),pe=P(()=>{if(typeof window>"u")return"about:blank";const s=new URLSearchParams;s.set("t",Date.now().toString()),s.set("cardId",String(d.value)),s.set("isDefault","1");const t=M.cardSlug||"editCard";return`${window.location.origin}/preview/${t}?${s.toString()}`}),ge=()=>{Be.value=!1},q=()=>{if(!(!ve.value||!te.value?.contentWindow))try{const s=de(a.$state);te.value.contentWindow.postMessage({type:"FORM_DATA_UPDATE",data:JSON.parse(JSON.stringify(s))},window.location.origin)}catch{}},be=s=>{s.origin===window.location.origin&&s.data?.type==="IFRAME_READY"&&(ve.value=!0,q())};return ke(async()=>{{window.addEventListener("message",be);const s=d.value;if(s)try{await a.setAboutFrom(s)}catch(t){console.error("Error loading card:",t)}else if(x.cards&&x.cards.length>0){const t=x.defaultCard||x.cards[0];t?.id&&await a.setAboutFrom(t.id)}setTimeout(()=>{r.value=!1},300)}}),K(()=>a.$state,()=>{q()},{deep:!0}),K(()=>a.cards,s=>{a.setAboutFrom(String(d.value))},{immediate:!0}),K(()=>a.links,s=>{x.value&&(x.value.links=s||[])},{deep:!0,immediate:!0}),K(()=>a.isLeadCaptureEnabled,async(s,t)=>{if(console.log("Lead capture watch triggered:",{newValue:s,oldValue:t,cardId:d.value}),s===t){console.log("No change in lead capture value, skipping");return}if(d.value)try{const n=J().$axios;console.log("Saving lead capture mode:",s,"for card:",d.value);const w=new FormData;w.append("leadCaptureMode",s?"1":"0");const p=await n.post(`v1/cards/${d.value}/update`,w,{headers:{"X-HTTP-Method-Override":"PUT"}});if(p.data.success)console.log("فرم لید با موفقیت ذخیره شد:",s),u(s?"فرم لید فعال شد":"فرم لید غیرفعال شد","ti-check");else throw new Error(p.data.message||"خطا در ذخیره فرم لید")}catch(f){console.error("Error saving lead capture setting:",f),u("خطا در ذخیره تنظیمات فرم","ti-alert-triangle"),setTimeout(()=>{a.isLeadCaptureEnabled=t},100)}else console.warn("No cardId available for saving lead capture setting"),u("خطا: شناسه کارت موجود نیست","ti-alert-triangle"),setTimeout(()=>{a.isLeadCaptureEnabled=t},100)}),Ce(()=>{window.removeEventListener("message",be)}),(s,t)=>{const f=Ve;return m(),b(Y,null,[e("div",Zt,[e("div",Yt,[e("div",Xt,[e("div",{class:"flex items-center gap-3"},[e("button",{onClick:Ue,class:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-accent transition-colors"},[...t[11]||(t[11]=[e("i",{class:"ti ti-arrow-right text-xl text-foreground"},null,-1)])]),t[12]||(t[12]=o()),t[13]||(t[13]=e("h1",{class:"text-lg font-semibold text-foreground"},"ویرایش پروفایل",-1))]),t[15]||(t[15]=o()),e("div",Kt,[e("button",{onClick:xe(Ae,["stop"]),type:"button",class:"bg-primary text-primary-foreground px-3 py-2 rounded-xl flex items-center gap-2 relative z-[101]"},[...t[14]||(t[14]=[e("i",{class:"ti ti-message text-base"},null,-1),o(),e("span",{class:"text-sm font-medium"},"فرم ارتباط",-1)])])])])]),t[70]||(t[70]=o()),r.value?(m(),b("div",Qt,[...t[16]||(t[16]=[ae('<div class="lg:col-span-4 min-h-0 px-1 lg:px-0 space-y-6" data-v-596fdd1c><div class="bg-card p-4 rounded-xl border border-border" data-v-596fdd1c><div class="h-5 w-32 bg-muted rounded mb-3" data-v-596fdd1c></div> <div class="flex gap-3" data-v-596fdd1c><div class="h-16 flex-1 bg-muted rounded-xl" data-v-596fdd1c></div> <div class="h-16 flex-1 bg-muted rounded-xl" data-v-596fdd1c></div> <div class="h-16 flex-1 bg-muted rounded-xl" data-v-596fdd1c></div></div></div> <div class="bg-card p-4 sm:p-6 rounded-xl border border-border space-y-4" data-v-596fdd1c><div class="flex items-center gap-4" data-v-596fdd1c><div class="w-20 h-20 bg-muted rounded-full" data-v-596fdd1c></div> <div class="flex-1 space-y-2" data-v-596fdd1c><div class="h-5 w-3/4 bg-muted rounded" data-v-596fdd1c></div> <div class="h-4 w-1/2 bg-muted rounded" data-v-596fdd1c></div></div></div> <div class="space-y-3" data-v-596fdd1c><div class="h-10 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="h-10 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="h-20 bg-muted rounded-lg" data-v-596fdd1c></div></div></div> <div class="bg-card p-4 sm:p-6 rounded-xl border border-border" data-v-596fdd1c><div class="flex items-center justify-between" data-v-596fdd1c><div class="space-y-2" data-v-596fdd1c><div class="h-5 w-40 bg-muted rounded" data-v-596fdd1c></div> <div class="h-4 w-56 bg-muted rounded" data-v-596fdd1c></div></div> <div class="w-11 h-6 bg-muted rounded-full" data-v-596fdd1c></div></div></div> <div class="space-y-3" data-v-596fdd1c><div class="h-6 w-36 bg-muted rounded" data-v-596fdd1c></div> <div class="space-y-2" data-v-596fdd1c><div class="bg-card border border-border rounded-xl p-4 flex items-center justify-between" data-v-596fdd1c><div class="flex items-center gap-3" data-v-596fdd1c><div class="w-6 h-8 bg-muted rounded" data-v-596fdd1c></div> <div class="w-10 h-10 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="h-5 w-32 bg-muted rounded" data-v-596fdd1c></div></div> <div class="flex gap-2" data-v-596fdd1c><div class="w-8 h-8 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="w-8 h-8 bg-muted rounded-lg" data-v-596fdd1c></div></div></div> <div class="bg-card border border-border rounded-xl p-4 flex items-center justify-between" data-v-596fdd1c><div class="flex items-center gap-3" data-v-596fdd1c><div class="w-6 h-8 bg-muted rounded" data-v-596fdd1c></div> <div class="w-10 h-10 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="h-5 w-28 bg-muted rounded" data-v-596fdd1c></div></div> <div class="flex gap-2" data-v-596fdd1c><div class="w-8 h-8 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="w-8 h-8 bg-muted rounded-lg" data-v-596fdd1c></div></div></div> <div class="bg-card border border-border rounded-xl p-4 flex items-center justify-between" data-v-596fdd1c><div class="flex items-center gap-3" data-v-596fdd1c><div class="w-6 h-8 bg-muted rounded" data-v-596fdd1c></div> <div class="w-10 h-10 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="h-5 w-36 bg-muted rounded" data-v-596fdd1c></div></div> <div class="flex gap-2" data-v-596fdd1c><div class="w-8 h-8 bg-muted rounded-lg" data-v-596fdd1c></div> <div class="w-8 h-8 bg-muted rounded-lg" data-v-596fdd1c></div></div></div></div></div> <div class="bg-card rounded-xl p-6 border border-border" data-v-596fdd1c><div class="flex gap-4 mb-6" data-v-596fdd1c><div class="w-12 h-12 bg-muted rounded-xl" data-v-596fdd1c></div> <div class="flex-1 space-y-2" data-v-596fdd1c><div class="h-5 w-28 bg-muted rounded" data-v-596fdd1c></div> <div class="h-4 w-full bg-muted rounded" data-v-596fdd1c></div></div></div> <div class="h-12 bg-muted rounded-xl" data-v-596fdd1c></div></div></div> <div class="lg:col-span-2 hidden lg:block" data-v-596fdd1c><div class="sticky top-6" data-v-596fdd1c><div class="bg-card rounded-2xl border border-border p-4 space-y-4" data-v-596fdd1c><div class="h-6 w-24 bg-muted rounded mx-auto" data-v-596fdd1c></div> <div class="aspect-[9/16] bg-muted rounded-xl" data-v-596fdd1c></div></div></div></div>',3)])])):(m(),b("div",Gt,[e("div",Dt,[e("div",_t,[k(Wt,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=n=>h.value=n),onLayoutChanged:ze,onConfirm:Ee},null,8,["modelValue"])]),t[38]||(t[38]=o()),k(yt,{cardId:d.value,form:c(x).value,"onUpdate:form":t[1]||(t[1]=n=>c(x).value=n),onOpenPreview:t[2]||(t[2]=n=>se.value=!0),class:"bg-card p-4 sm:p-6 rounded-xl mb-6 border border-border"},null,8,["cardId","form"]),t[39]||(t[39]=o()),e("div",es,[e("div",ts,[t[19]||(t[19]=e("div",null,[e("h3",{class:"text-base font-semibold text-foreground mb-1"},"فرم دریافت اطلاعات"),o(),e("p",{class:"text-sm text-muted-foreground"},"فعال‌سازی فرم برای جمع‌آوری اطلاعات بازدیدکنندگان")],-1)),t[20]||(t[20]=o()),e("label",ss,[Fe(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=n=>c(a).isLeadCaptureEnabled=n),class:"sr-only peer"},null,512),[[Pe,c(a).isLeadCaptureEnabled]]),t[17]||(t[17]=o()),t[18]||(t[18]=e("div",{class:"w-11 h-6 bg-muted peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-card after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"},null,-1))])])]),t[40]||(t[40]=o()),c(a).links&&c(a).links.length>0?(m(),b("div",os,[t[28]||(t[28]=e("h3",{class:"text-lg font-semibold text-foreground"},"محتوای اضافه شده",-1)),t[29]||(t[29]=o()),k(c(et),{modelValue:c(a).links,"onUpdate:modelValue":t[4]||(t[4]=n=>c(a).links=n),animation:200,"ghost-class":"ghost-item","chosen-class":"chosen-item","drag-class":"drag-item","item-key":"id",handle:".drag-handle",class:"space-y-2",onEnd:Te},{item:Z(({element:n,index:w})=>[e("div",{class:$(["bg-card border border-border rounded-xl p-4 flex items-center justify-between hover:bg-muted/20 transition-all duration-200 group",{"shadow-lg scale-[1.02]":U.value}])},[e("div",ds,[t[21]||(t[21]=e("div",{class:"drag-handle cursor-grab active:cursor-grabbing transition-opacity p-2 -m-2 touch-none"},[e("i",{class:"ti ti-grip-vertical text-muted-foreground text-xl"})],-1)),t[22]||(t[22]=o()),e("div",rs,[ue(n)?(m(),le(we(ue(n)),{key:0,size:20,color:I.value,filled:D.value},null,8,["color","filled"])):ce(n)?(m(),b("img",{key:1,src:ce(n),class:"w-5 h-5 object-contain",alt:"icon"},null,8,ls)):(m(),b("i",{key:2,class:$(`ti ti-${Se(n)} text-muted-foreground`)},null,2))]),t[23]||(t[23]=o()),e("div",null,[e("p",as,ie(z(n)),1)])]),t[27]||(t[27]=o()),e("div",is,[e("button",{onClick:p=>X(n,w),class:"w-8 h-8 rounded-lg bg-muted hover:bg-muted-foreground/20 flex items-center justify-center transition-colors"},[...t[24]||(t[24]=[e("i",{class:"ti ti-edit text-sm text-muted-foreground"},null,-1)])],8,ns),t[26]||(t[26]=o()),e("button",{onClick:p=>W(w),class:"w-8 h-8 rounded-lg bg-destructive/10 hover:bg-destructive/20 flex items-center justify-center transition-colors"},[...t[25]||(t[25]=[e("i",{class:"ti ti-trash text-sm text-destructive"},null,-1)])],8,us)])],2)]),_:1},8,["modelValue"])])):j("",!0),t[41]||(t[41]=o()),e("div",cs,[t[31]||(t[31]=ae(`<div class="flex gap-4 mb-6" data-v-596fdd1c><div class="w-12 h-12 bg-muted/40 rounded-xl flex items-center justify-center border-2 border-dashed border-border/60 hover:border-primary/50 hover:bg-primary/5 transition-colors" data-v-596fdd1c><i class="ti ti-plus text-muted-foreground text-xl" data-v-596fdd1c></i></div> <div class="flex-1" data-v-596fdd1c><h3 class="text-base font-semibold text-foreground mb-2" data-v-596fdd1c>افزودن محتوا</h3> <p class="text-sm text-muted-foreground leading-relaxed" data-v-596fdd1c>\r
                اطلاعات تماس، شبکه‌های اجتماعی، لینک‌ها و محتوای دیگر را به کارت خود اضافه کنید\r
              </p></div></div> `,2)),e("button",{onClick:t[5]||(t[5]=n=>C.value=!0),class:"w-full bg-primary text-primary-foreground px-6 py-3.5 rounded-xl text-sm font-medium transition-all duration-200 flex items-center justify-center gap-3 hover:bg-primary/90 hover:shadow-lg transform hover:-translate-y-0.5"},[...t[30]||(t[30]=[e("i",{class:"ti ti-plus text-lg"},null,-1),o(),e("span",null,"افزودن محتوا",-1),o(),e("i",{class:"ti ti-arrow-left text-sm"},null,-1)])])]),t[42]||(t[42]=o()),e("div",ms,[e("div",fs,[e("button",{onClick:me,disabled:Q.value,class:"bg-primary text-primary-foreground px-8 py-3.5 rounded-xl text-sm font-semibold transition-all duration-200 flex items-center justify-center gap-2 hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-md"},[Q.value?(m(),b(Y,{key:0},[t[32]||(t[32]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o(),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),t[33]||(t[33]=o()),t[34]||(t[34]=e("span",{class:"text-sm font-medium"},"در حال ذخیره...",-1))],64)):(m(),b(Y,{key:1},[t[35]||(t[35]=e("i",{class:"ti ti-device-floppy text-lg"},null,-1)),t[36]||(t[36]=o()),t[37]||(t[37]=e("span",{class:"text-sm font-medium"},"ذخیره تغییرات",-1))],64))],8,vs)])])]),t[46]||(t[46]=o()),e("div",ps,[e("div",gs,[e("div",bs,[e("div",xs,[t[45]||(t[45]=ae('<div class="absolute top-[15%] -left-[5px] w-[4px] h-5 bg-slate-700 rounded-xl" data-v-596fdd1c></div> <div class="absolute top-[25%] -left-[5px] w-[4px] h-10 bg-slate-700 rounded-xl" data-v-596fdd1c></div> <div class="absolute top-[35%] -left-[5px] w-[4px] h-10 bg-slate-700 rounded-xl" data-v-596fdd1c></div> <div class="absolute top-[35%] -right-[5px] w-[4px] h-16 bg-slate-700 rounded-xl" data-v-596fdd1c></div> <div class="absolute top-3 left-1/2 -translate-x-1/2 w-16 h-5 bg-black rounded-xl z-20" data-v-596fdd1c></div> ',10)),e("div",ws,[k(f,null,{fallback:Z(()=>[...t[43]||(t[43]=[e("div",{class:"w-full h-full bg-gray-100 rounded-[28px] flex items-center justify-center"},[e("div",{class:"text-gray-500"},"در حال بارگذاری...")],-1)])]),default:Z(()=>[(m(),b("iframe",{ref_key:"iframeRef",ref:te,key:`iframe-${fe.value}`,src:pe.value,class:"w-full h-full border-0 rounded-[28px] overflow-hidden",sandbox:"allow-scripts allow-forms allow-same-origin allow-popups",loading:"lazy",onLoad:ge},null,40,hs)),t[44]||(t[44]=o())]),_:1})])])])])])])),t[71]||(t[71]=o()),e("div",ys,[e("div",ks,[e("button",{onClick:t[6]||(t[6]=n=>se.value=!0),class:"flex-1 bg-muted text-foreground px-6 py-3 rounded-xl text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 hover:bg-muted/80"},[...t[47]||(t[47]=[e("i",{class:"ti ti-eye text-lg"},null,-1),o(),e("span",null,"پیش‌نمایش",-1)])]),t[54]||(t[54]=o()),e("button",{onClick:me,disabled:Q.value,class:"flex-2 bg-primary text-primary-foreground px-6 py-3 rounded-xl text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed"},[Q.value?(m(),b(Y,{key:0},[t[48]||(t[48]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o(),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),t[49]||(t[49]=o()),t[50]||(t[50]=e("span",{class:"text-sm font-medium"},"در حال ذخیره...",-1))],64)):(m(),b(Y,{key:1},[t[51]||(t[51]=e("i",{class:"ti ti-device-floppy text-lg"},null,-1)),t[52]||(t[52]=o()),t[53]||(t[53]=e("span",{class:"text-sm font-medium"},"ذخیره تغییرات",-1))],64))],8,Cs)])]),t[72]||(t[72]=o()),k(Re,{"enter-active-class":"transform transition ease-in-out duration-300","enter-from-class":"translate-y-full","enter-to-class":"translate-y-0","leave-active-class":"transform transition ease-in-out duration-300","leave-from-class":"translate-y-0","leave-to-class":"translate-y-full"},{default:Z(()=>[se.value?(m(),b("div",$s,[e("div",Is,[e("div",Ls,[e("button",{onClick:t[7]||(t[7]=n=>se.value=!1),class:"flex items-center gap-2 text-gray-700 hover:text-gray-900 transition-colors"},[...t[55]||(t[55]=[e("i",{class:"ti ti-arrow-right text-xl"},null,-1),o(),e("span",{class:"text-sm font-medium"},"بازگشت",-1)])]),t[56]||(t[56]=o()),t[57]||(t[57]=e("h2",{class:"text-base font-semibold text-gray-800"},"پیش‌نمایش",-1)),t[58]||(t[58]=o()),t[59]||(t[59]=e("div",{class:"w-16"},null,-1))])]),t[62]||(t[62]=o()),e("div",Ns,[k(f,null,{fallback:Z(()=>[...t[60]||(t[60]=[e("div",{class:"w-full h-full bg-white flex items-center justify-center"},[e("div",{class:"text-gray-500"},"در حال بارگذاری...")],-1)])]),default:Z(()=>[(m(),b("iframe",{ref_key:"iframeRef",ref:te,key:`iframe-mobile-${fe.value}`,src:pe.value,class:"w-full h-full border-0 bg-white",sandbox:"allow-scripts allow-forms allow-same-origin allow-popups",loading:"lazy",onLoad:ge},null,40,Ts)),t[61]||(t[61]=o())]),_:1})])])):j("",!0)]),_:1}),t[73]||(t[73]=o()),C.value?(m(),le(Ge,{key:2,cardId:d.value,onClose:t[8]||(t[8]=n=>C.value=!1),onAddLink:l},null,8,["cardId"])):j("",!0),t[74]||(t[74]=o()),i.value?(m(),b("div",{key:3,class:"fixed inset-0 bg-black/50 backdrop-blur flex items-center justify-center z-[60] p-0 lg:p-4",onClick:xe(O,["self"])},[e("div",js,[e("div",Ss,[e("button",{class:"text-muted-foreground hover:text-foreground flex items-center gap-2 transition-colors",onClick:O},[...t[63]||(t[63]=[e("i",{class:"ti ti-arrow-right text-lg"},null,-1),o(),e("span",{class:"text-sm font-medium"},"برگشت",-1)])]),t[67]||(t[67]=o()),e("h3",Ms,ie(R()),1),t[68]||(t[68]=o()),e("div",zs,[y.value&&H(y.value)?(m(),b("a",{key:0,href:H(y.value),target:"_blank",class:"w-9 h-9 flex items-center justify-center rounded-lg hover:bg-muted text-muted-foreground hover:text-foreground transition-colors",title:"مشاهده لینک"},[...t[64]||(t[64]=[e("i",{class:"ti ti-external-link text-lg"},null,-1)])],8,Es)):j("",!0),t[66]||(t[66]=o()),y.value?(m(),b("button",{key:1,type:"button",class:"w-9 h-9 flex items-center justify-center rounded-lg hover:bg-destructive/10 text-destructive hover:text-destructive/80 transition-colors",title:"حذف",onClick:t[9]||(t[9]=()=>{W(V.value),O()})},[...t[65]||(t[65]=[e("i",{class:"ti ti-trash text-lg"},null,-1)])])):j("",!0)])]),t[69]||(t[69]=o()),e("div",Us,[y.value?(m(),le(we(ee(y.value)),{key:0,link:y.value,cardId:d.value,onCancel:O,onBack:O,onSubmit:re,onDelete:t[10]||(t[10]=()=>{W(V.value),O()})},null,40,["link","cardId"])):j("",!0)])])])):j("",!0)]),t[75]||(t[75]=o()),k(Le,{visible:B.value,message:N.value,icon:T.value},null,8,["visible","message","icon"])],64)}}},Qs=tt(As,[["__scopeId","data-v-596fdd1c"]]);export{Qs as E};
