import{j as c}from"#entry";import{m as i}from"./Dmv2tsM1.js";import"./CE1G-McA.js";i.loadPersian({dialect:"persian-modern"});const h=c("stats",{state:()=>({stats:[],links:[],dateRange:["",""]}),getters:{filteredStats(e){const[o,n]=e.dateRange;return!o||!n?e.stats:e.stats.filter(s=>{const r=i(s.date,"YYYY-MM-DD");return r.isSameOrAfter(o)&&r.isSameOrBefore(n)})},statsCards(e){const n=this.filteredStats.reduce((s,r)=>(s[r.key]||(s[r.key]=[]),s[r.key].push(r),s),{});return Object.entries(n).map(([s,r])=>{const l=r.at(-1);let t=l.trend&&l.trend.length>0?l.trend:r.map(a=>typeof a.value=="string"?parseInt(a.value):Number(a.value)).slice(-7);return(!t||t.length===0)&&(t=Array.from({length:7},()=>Math.floor(Math.random()*50)+20)),{key:s,label:l.label,value:l.value,trend:t,tooltip:l.tooltip,date:l.date}})},getLinks(e){const[o,n]=e.dateRange;return!o||!n?e.links:e.links.filter(s=>{const r=i(s.date,"YYYY-MM-DD");return r.isSameOrAfter(o)&&r.isSameOrBefore(n)})}},actions:{setRange(e){this.dateRange=e},generateMockData(e,o,n){const s=i().format("YYYY-MM-DD");this.stats=[],this.links=[],Object.keys(e).length===0&&(e[s]=0),Object.keys(o).length===0&&(o[s]=0);const r=[{key:"pops",label:"بازدید",tooltip:"تعداد بازدید کلی"},{key:"linkTaps",label:"کلیک لینک",tooltip:"کلیک روی لینک‌ها"},{key:"connections",label:"اتصالات جدید",tooltip:"کاربران جدید"},{key:"ctr",label:"نرخ کلیک‌پذیری",tooltip:"نسبت کلیک به بازدید"},{key:"mapView",label:"مشاهده روی نقشه (بزودی)",tooltip:"نمایش روی نقشه"},{key:"ranking",label:"رتبه بندی (بزودی)",tooltip:"رتبه جستجو"}];Array.from(new Set([...Object.keys(o),...Object.keys(e)])).sort().forEach(t=>{r.forEach((a,u)=>{const d=(()=>{if(a.key==="linkTaps")return e[t]??0;if(a.key==="pops")return o[t]??0;if(a.key==="ctr"){const f=e[t]??0,p=o[t]??0;return p===0?"0%":`${Math.floor(f/p*100)}%`}else return 0})();this.stats.push({key:a.key,label:a.label,value:d,trend:[],tooltip:a.tooltip,date:t})})}),n.forEach(t=>{const a=t.displayName||t.title||t.name||t.label||"بدون نام";this.links.push({customIcon:t.customIcon,icon:t.icon,label:a,sub:t.sub||t.description||"",clicks:t.clicks||0,date:i().format("YYYY-MM-DD")})})},generateTodaySample(){const e=i().format("YYYY-MM-DD");this.stats=[{key:"pops",label:"بازدید",value:120,trend:[40,55,70],tooltip:"تعداد بازدید امروز",date:e},{key:"linkTaps",label:"کلیک لینک",value:45,trend:[15,25,35],tooltip:"کلیک‌های امروز",date:e}]}}});export{h as useStatsStore};
