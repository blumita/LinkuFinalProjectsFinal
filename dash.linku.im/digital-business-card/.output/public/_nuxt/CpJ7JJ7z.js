import{_ as Fe}from"./Cuk9nQEh.js";import{k as Ce,r as g,c as F,b,i as m,P as Z,f as e,e as o,y as C,d as N,E as W,M as qe,G as $e,a as J,J as K,al as Pe,o as Ie,L as Le,h as u,t as ue,O as I,am as le,C as de,aa as Re,Y as ie,g as ne,S as Je,ac as He,R as ye,T as We}from"#entry";import{a as Ze,u as Ye}from"./CqqU26cq.js";import{u as ce,d as Ke}from"./DyClqVU4.js";import{u as Xe,_,a as Ge,b as Qe,c as De,C as _e,d as et,e as ke,E as re}from"./BY1RLUXL.js";import{_ as Ne}from"./Bv-RA7Kk.js";import{I as tt}from"./CtQ5b3W8.js";import{I as Te}from"./DJY3EWAx.js";import{u as st}from"./BD1tHKkX.js";import{useUserStore as ot}from"./0dA2cnp7.js";import{d as rt}from"./BQ8DQ5F8.js";import{_ as lt}from"./DlAUqK2U.js";const at={class:"relative rounded-xl bg-card border border-border h-36 hover:shadow-md transition-shadow"},dt={key:0,class:"absolute inset-0 w-full h-full"},it=["src"],nt={class:"absolute -bottom-10 left-1/2 transform -translate-x-1/2"},ut={class:"relative"},ct=["src"],mt={key:1,viewBox:"0 0 24 24",class:"w-10 h-10 text-muted-foreground"},ft=["src"],vt={key:1,class:"text-xs font-bold text-muted-foreground"},pt={class:"p-6"},gt=Ce({__name:"CoverAvatarSection",setup(Q){const U=ce(),w=g(!1),d=g(!1),j=g(null),l=g("cover"),V=F({get:()=>U.safeCoverImage||"",set:S=>{U.coverImage=S}}),M=F({get:()=>U.safeProfileImage||"",set:S=>{U.profileImage=S}}),T=F({get:()=>U.safeLogoImage||"",set:S=>{U.logoImage=S}}),R=()=>{w.value=!1,y("cover")},z=()=>{w.value=!1,y("profile")},L=()=>{w.value=!1,y("logo")},y=S=>{l.value=S;const i=document.createElement("input");i.type="file",i.accept="image/*",i.onchange=E=>{const q=E.target.files?.[0];q&&(j.value=q,d.value=!0)},i.click()},r=async(S,i)=>{switch(i){case"cover":V.value=S;break;case"profile":M.value=S;break;case"logo":T.value=S;break}await qe(),d.value=!1,j.value=null},c=()=>{d.value=!1,j.value=null},k=()=>{switch(l.value){case"cover":return 16/9;case"profile":return 1;case"logo":return 1;default:return 1}};return(S,i)=>(m(),b(Z,null,[e("section",at,[V.value?(m(),b("div",dt,[e("img",{src:V.value,alt:"Cover Photo",class:"w-full h-full object-cover"},null,8,it),i[5]||(i[5]=o()),i[6]||(i[6]=e("div",{class:"absolute inset-0 bg-black/10"},null,-1))])):N("",!0),i[9]||(i[9]=o()),e("button",{onClick:i[0]||(i[0]=E=>w.value=!0),class:"absolute left-4 top-4 rounded-full bg-background/90 backdrop-blur-sm hover:bg-background text-foreground text-xs px-3 py-2 transition-all shadow-lg hover:shadow-xl border border-border/50"},`\r
      ویرایش تصویر\r
    `),i[10]||(i[10]=o()),e("div",nt,[e("div",ut,[e("button",{onClick:i[1]||(i[1]=E=>w.value=!0),class:"w-24 h-24 rounded-full bg-card ring-4 ring-card border border-border grid place-items-center hover:bg-muted/20 transition-colors overflow-hidden"},[M.value?(m(),b("img",{key:0,src:M.value,alt:"Profile Photo",class:"w-full h-full object-cover rounded-full"},null,8,ct)):(m(),b("svg",mt,[...i[7]||(i[7]=[e("path",{fill:"currentColor",d:"M12 12a4 4 0 1 0-4-4a4 4 0 0 0 4 4Zm0 2c-4.67 0-8 2.33-8 5v1h16v-1c0-2.67-3.33-5-8-5Z"},null,-1)])]))]),i[8]||(i[8]=o()),e("button",{onClick:i[2]||(i[2]=E=>w.value=!0),class:"absolute bottom-0 -left-1 w-10 h-10 rounded-full bg-muted border-2 border-card grid place-items-center hover:bg-primary/80 transition-colors overflow-hidden"},[T.value?(m(),b("img",{key:0,src:T.value,alt:"Company Logo",class:"w-full h-full object-cover rounded-full"},null,8,ft)):(m(),b("span",vt,"لوگو"))])])])]),i[17]||(i[17]=o()),i[18]||(i[18]=e("div",{class:"h-16"},null,-1)),i[19]||(i[19]=o()),C(Ne,{modelValue:w.value,"onUpdate:modelValue":i[4]||(i[4]=E=>w.value=E),size:"auto",closable:!1},{default:W(()=>[e("div",pt,[e("button",{onClick:R,class:"w-full mb-6 p-6 rounded-2xl bg-card border border-border hover:bg-muted transition-colors flex flex-col items-center justify-center gap-3"},[...i[11]||(i[11]=[e("div",{class:"w-12 h-12 rounded-xl bg-primary flex items-center justify-center"},[e("svg",{viewBox:"0 0 24 24",class:"w-6 h-6 text-primary-foreground"},[e("path",{fill:"currentColor",d:"M5 21q-.825 0-1.413-.588T3 19V5q0-.825.588-1.413T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.588 1.413T19 21H5Zm1-4h12l-3.75-5-3 4L9 13l-3 4Z"})])],-1),o(),e("span",{class:"text-foreground font-medium text-base"},"افزودن عکس کاور",-1)])]),i[15]||(i[15]=o()),e("div",{class:"grid grid-cols-2 gap-4 mb-6"},[e("button",{onClick:z,class:"p-6 rounded-2xl bg-card border border-border hover:bg-muted transition-colors flex flex-col items-center justify-center gap-3"},[...i[12]||(i[12]=[e("div",{class:"w-10 h-10 rounded-full bg-primary flex items-center justify-center"},[e("svg",{viewBox:"0 0 24 24",class:"w-5 h-5 text-primary-foreground"},[e("path",{fill:"currentColor",d:"M12 12a4 4 0 1 0-4-4a4 4 0 0 0 4 4Zm0 2c-4.67 0-8 2.33-8 5v1h16v-1c0-2.67-3.33-5-8-5Z"})])],-1),o(),e("span",{class:"text-foreground font-medium text-sm"},"افزودن پروفایل",-1)])]),i[14]||(i[14]=o()),e("button",{onClick:L,class:"p-6 rounded-2xl bg-card border border-border hover:bg-muted transition-colors flex flex-col items-center justify-center gap-3"},[...i[13]||(i[13]=[e("div",{class:"w-10 h-10 rounded-full border-2 border-primary flex items-center justify-center"},[e("svg",{viewBox:"0 0 24 24",class:"w-4 h-4 text-primary"},[e("path",{fill:"currentColor",d:"M11 11V6h2v5h5v2h-5v5h-2v-5H6v-2z"})])],-1),o(),e("span",{class:"text-foreground font-medium text-sm"},"افزودن لوگو",-1)])])]),i[16]||(i[16]=o()),e("button",{onClick:i[3]||(i[3]=E=>w.value=!1),class:"w-full p-4 rounded-2xl bg-muted border border-border text-foreground font-semibold text-base transition-colors hover:bg-muted/80"},`\r
        انصراف\r
      `)])]),_:1},8,["modelValue"]),i[20]||(i[20]=o()),C(tt,{show:d.value,"image-file":j.value||void 0,"aspect-ratio":k(),"field-name":l.value,onClose:c,onCropped:r},null,8,["show","image-file","aspect-ratio","field-name"])],64))}}),bt={class:"space-y-3"},xt={class:"space-y-4"},wt={class:"grid grid-cols-1"},ht={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},yt={class:"grid grid-cols-1"},kt={class:"bg-card border border-border p-6 rounded-xl space-y-6"},Ct={class:"space-y-3"},$t={class:"pt-4 border-t border-border/50"},It={__name:"TabAbout",emits:["open-preview"],setup(Q,{emit:U}){const w=$e(),d=g(""),j=g(""),l=ce(),{$axios:V}=J();g(!1);const M=g(!1),T=g(!1),R=g(!1),z=g(""),L=g("ti-alert-triangle"),y=(f,a="ti-lock")=>{z.value=f,L.value=a,R.value=!0,setTimeout(()=>R.value=!1,3e3)};K(()=>w.query,f=>{f.id&&(d.value=f.id,j.value=f.slug||"")},{immediate:!0});async function r(){const f=new CustomEvent("manual-save",{detail:{source:"about-form"}});window.dispatchEvent(f);const a=new FormData;a.append("cardName",l.cardName||""),a.append("name",l.name||""),a.append("location",l.location||""),a.append("job",l.job||""),a.append("company",l.company||""),a.append("bio",l.bio||""),a.append("saveContact",l.saveContact||""),a.append("themeColor",JSON.stringify(l.themeColor||{})),a.append("iconColor",JSON.stringify(l.iconColor||{})),a.append("matchThemeColor",l.matchThemeColor?1:0),a.append("layoutMode",l.layout||"");try{const v=await V.post(`v1/cards/${d.value}/update`,a,{headers:{"X-HTTP-Method-Override":"PUT"}});v.data.success?(await c(d.value),await ot().fetchUser(),y(v.data.message,"ti-check")):y(v.data.message,"ti-alert-triangle")}catch(v){if(v.response){const H=v.response.status;y(v.response.data.message,"ti-alert-triangle")}else y("اتصال به سرور ممکن نیست.","ti-alert-triangle")}finally{T.value=!1}}async function c(f){const a=["profileImage","coverImage","logoImage"],v=new FormData;v.append("modelType","card"),v.append("modelId",f||"");function H(P,$){const Y=atob(P.split(",")[1]),ee=new ArrayBuffer(Y.length),te=new Uint8Array(ee);for(let X=0;X<Y.length;X++)te[X]=Y.charCodeAt(X);return new Blob([ee],{type:$})}let D=!1;for(const P of a){const $=l[P];if($){if(typeof $=="string"&&$.startsWith("data:")){const Y=H($,"image/png");v.append(P,Y,`${P}.png`),D=!0;continue}if($ instanceof File||$ instanceof Blob){v.append(P,$),D=!0;continue}typeof $=="string"&&($.startsWith("http")||$.startsWith("/storage/"))}}if(D)try{(await V.post(`file-manager/${f}/upload`,v)).data.success?y("تصاویر با موفقیت آپلود شدند","ti-image"):y("آپلود تصاویر با خطا مواجه شد","ti-alert-triangle")}catch{y("خطا در آپلود تصاویر","ti-alert-triangle")}}function k(){M.value=!1}function S(f){l.cardName=f,M.value=!1}g(!1);const i={right:"راست‌چین",left:"چپ‌چین",center:"وسط‌چین",portrait:"پرتره"};F(()=>i[l.layout]),F(()=>typeof l.cardName=="string"&&l.cardName.trim()!==""?l.cardName:"نام کارت را وارد کنید"),F(()=>l.matchThemeColor??!1);const E=st(),q=Xe();return Pe(async()=>{const f=d.value;if(!f)return;await q.fetchLinks(f),l.links=q.links,await E.fetchCard(f);const a=E.activeCard?.fields;Array.isArray(a)&&(l.fields=a),(!Array.isArray(l.fields)||l.fields.length===0)&&(l.fields=structuredClone(Ke))}),Ie(()=>{window.addEventListener("manual-save",f=>{f.detail?.source==="header-save"&&r()})}),Le(()=>{window.removeEventListener("manual-save",f=>{f.detail?.source==="header-save"&&r()})}),(f,a)=>(m(),b(Z,null,[e("div",bt,[C(gt),a[18]||(a[18]=o()),e("div",xt,[e("div",wt,[C(_,{label:"نام کامل",modelValue:u(l).name,"onUpdate:modelValue":a[0]||(a[0]=v=>u(l).name=v),placeholder:"نام و نام خانوادگی",maxlength:40,error:u(l).name&&u(l).name.length>40?"حداکثر ۴۰ کاراکتر مجاز است":""},null,8,["modelValue","error"])]),a[9]||(a[9]=o()),e("div",ht,[C(_,{label:"سمت شغلی",modelValue:u(l).job,"onUpdate:modelValue":a[1]||(a[1]=v=>u(l).job=v),placeholder:"عنوان شغلی",maxlength:30,error:u(l).job&&u(l).job.length>30?"حداکثر ۳۰ کاراکتر مجاز است":""},null,8,["modelValue","error"]),a[8]||(a[8]=o()),C(_,{label:"شرکت",modelValue:u(l).company,"onUpdate:modelValue":a[2]||(a[2]=v=>u(l).company=v),placeholder:"نام سازمان",maxlength:30,error:u(l).company&&u(l).company.length>30?"حداکثر ۳۰ کاراکتر مجاز است":""},null,8,["modelValue","error"])]),a[10]||(a[10]=o()),e("div",yt,[C(_,{label:"موقعیت جغرافیایی",modelValue:u(l).location,"onUpdate:modelValue":a[3]||(a[3]=v=>u(l).location=v),placeholder:"شهر، کشور",maxlength:30,error:u(l).location&&u(l).location.length>30?"حداکثر ۳۰ کاراکتر مجاز است":""},null,8,["modelValue","error"])])]),a[19]||(a[19]=o()),C(Ge,{label:"بیوگرافی",modelValue:u(l).bio,"onUpdate:modelValue":a[4]||(a[4]=v=>u(l).bio=v),placeholder:"درباره خود توضیح دهید... (تا 10 خط)",maxlength:500,rows:10,error:u(l).bio&&u(l).bio.length>500?"حداکثر 500 کاراکتر مجاز است":""},null,8,["modelValue","error"]),a[20]||(a[20]=o()),C(_,{label:"عنوان دکمه ذخیره مخاطب",modelValue:u(l).saveContact,"onUpdate:modelValue":a[5]||(a[5]=v=>u(l).saveContact=v),placeholder:"دکمه ذخیره مخاطب",maxlength:20,error:u(l).saveContact&&u(l).saveContact.length>20?"حداکثر ۲۰ کاراکتر مجاز است":""},null,8,["modelValue","error"]),a[21]||(a[21]=o()),e("div",null,[a[16]||(a[16]=e("h3",{class:"text-base font-medium text-foreground mb-3"},"رنگ‌بندی کارت",-1)),a[17]||(a[17]=o()),e("div",kt,[e("div",Ct,[a[11]||(a[11]=e("h4",{class:"text-sm font-semibold text-foreground"},"رنگ اصلی",-1)),a[12]||(a[12]=o()),a[13]||(a[13]=e("p",{class:"text-xs text-muted-foreground"},"با انتخاب یک رنگ، هم پس‌زمینه و هم رنگ آیکون‌ها تنظیم می‌شود",-1)),a[14]||(a[14]=o()),C(Qe)]),a[15]||(a[15]=o()),e("div",$t,[C(De,{selected:u(l).iconColor,matchThemeColor:u(l).matchThemeColor,onUpdate:a[6]||(a[6]=v=>u(l).iconColor=v),"onUpdate:matchTheme":a[7]||(a[7]=v=>u(l).matchThemeColor=v)},null,8,["selected","matchThemeColor"])])])]),a[22]||(a[22]=o()),C(_e,{isOpen:M.value,currentCardName:typeof u(l).cardName=="string"?u(l).cardName:"",onClose:k,onUpdate:S},null,8,["isOpen","currentCardName"])]),a[23]||(a[23]=o()),C(Te,{visible:R.value,message:z.value,icon:L.value},null,8,["visible","message","icon"])],64))}},Lt={class:"flex items-center gap-2 text-sm text-muted-foreground"},Nt={class:"px-6"},Tt={class:"md:hidden"},St={class:"flex gap-8 overflow-x-auto px-6 pb-6 pt-6 snap-x snap-mandatory",role:"radiogroup","aria-label":"گزینه‌های چیدمان"},jt=["aria-checked"],Mt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},zt=["aria-checked"],Et={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Ut=["aria-checked"],At={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Bt=["aria-checked"],Vt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Ot={class:"hidden md:block px-6 pb-6 pt-6"},Ft={class:"grid grid-cols-2 lg:grid-cols-4 gap-12 max-w-6xl mx-auto",role:"radiogroup","aria-label":"گزینه‌های چیدمان"},qt=["aria-checked"],Pt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Rt=["aria-checked"],Jt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Ht=["aria-checked"],Wt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Zt=["aria-checked"],Yt={key:0,viewBox:"0 0 24 24",class:"w-4 h-4"},Kt={class:"px-4 pb-4 pt-4 border-t border-border space-y-3"},Xt=Ce({__name:"LayoutSelector",props:{modelValue:{}},emits:["update:modelValue","layout-changed","confirm"],setup(Q,{emit:U}){const w=Q,d=U,j=g(!1),l=g(w.modelValue??"right");K(()=>w.modelValue,y=>{y&&(l.value=y)});const V={right:"راست‌چین",left:"چپ‌چین",center:"وسط‌چین",portrait:"پورتریت"},M=F(()=>V[l.value]||"راست‌چین");function T(y){l.value=y,d("update:modelValue",le(y)),d("layout-changed",le(y))}function R(){j.value=!1,d("confirm",le(l.value))}function z(y){return["relative w-36 h-64 rounded-2xl border border-border overflow-hidden shadow-sm transition-colors",l.value===y?"ring-1 ring-foreground":"hover:border-muted-foreground/60"].join(" ")}function L(y){return["mt-1.5 inline-flex items-center justify-center w-6 h-6 rounded-full",l.value===y?"bg-foreground text-background":"border-2 border-muted"].join(" ")}return(y,r)=>(m(),b(Z,null,[e("div",{class:"w-full rounded-xl bg-card border border-border px-4 py-3 flex items-center justify-between hover:bg-muted transition-colors cursor-pointer",onClick:r[0]||(r[0]=c=>j.value=!0)},[r[12]||(r[12]=e("span",{class:"text-sm font-medium text-foreground"},"تغییر چیدمان",-1)),r[13]||(r[13]=o()),e("span",Lt,[o(ue(M.value)+" ",1),r[11]||(r[11]=e("svg",{viewBox:"0 0 24 24",class:"w-5 h-5 rotate-180"},[e("path",{fill:"currentColor",d:"M9.3 6.3a1 1 0 0 1 1.4 0l5 5a1 1 0 0 1 0 1.4l-5 5a1 1 0 0 1-1.4-1.4L13.6 12 9.3 7.7a1 1 0 0 1 0-1.4Z"})],-1))])]),r[62]||(r[62]=o()),C(Ne,{modelValue:j.value,"onUpdate:modelValue":r[10]||(r[10]=c=>j.value=c),size:"auto",closable:!0,role:"dialog","aria-modal":"true",title:"چیدمان"},{default:W(()=>[e("div",Nt,[e("div",Tt,[e("div",St,[e("button",{onClick:r[1]||(r[1]=c=>T("right")),"aria-checked":l.value==="right",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:I(z("right"))},[...r[14]||(r[14]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 right-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -left-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-end gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),r[16]||(r[16]=o()),r[17]||(r[17]=e("p",{class:"text-xs mt-2 text-foreground"},"راست‌چین",-1)),r[18]||(r[18]=o()),e("span",{class:I(L("right"))},[l.value==="right"?(m(),b("svg",Mt,[...r[15]||(r[15]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,jt),r[34]||(r[34]=o()),e("button",{onClick:r[2]||(r[2]=c=>T("left")),"aria-checked":l.value==="left",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:I(z("left"))},[...r[19]||(r[19]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-start gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),r[21]||(r[21]=o()),r[22]||(r[22]=e("p",{class:"text-xs mt-2 text-foreground"},"چپ‌چین",-1)),r[23]||(r[23]=o()),e("span",{class:I(L("left"))},[l.value==="left"?(m(),b("svg",Et,[...r[20]||(r[20]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,zt),r[35]||(r[35]=o()),e("button",{onClick:r[3]||(r[3]=c=>T("center")),"aria-checked":l.value==="center",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:I(z("center"))},[...r[24]||(r[24]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-1/2 -translate-x-1/2"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-center gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),r[26]||(r[26]=o()),r[27]||(r[27]=e("p",{class:"text-xs mt-2 text-foreground"},"وسط‌چین",-1)),r[28]||(r[28]=o()),e("span",{class:I(L("center"))},[l.value==="center"?(m(),b("svg",At,[...r[25]||(r[25]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,Ut),r[36]||(r[36]=o()),e("button",{onClick:r[4]||(r[4]=c=>T("portrait")),"aria-checked":l.value==="portrait",role:"radio",class:"flex flex-col items-center flex-shrink-0 snap-start focus:outline-none"},[e("div",{class:I(z("portrait"))},[...r[29]||(r[29]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-20 bg-gradient-to-b from-muted to-card/90"},[e("div",{class:"absolute bottom-2 right-2"},[e("div",{class:"w-8 h-8 rounded-full bg-card border border-border flex items-center justify-center"},[e("i",{class:"ti ti-user text-xs text-muted-foreground"})])])]),o(),e("div",{class:"px-3 pt-4 pb-3"},[e("div",{class:"space-y-2 mb-4 text-center"},[e("div",{class:"mx-auto w-20 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"mx-auto w-16 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-6 bg-muted/40 rounded mb-4"}),o(),e("div",{class:"space-y-2"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-20 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-16 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-18 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-14 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-16 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-18 h-1.5 bg-muted rounded"})])])])])],-1)])],2),r[31]||(r[31]=o()),r[32]||(r[32]=e("p",{class:"text-xs mt-2 text-foreground"},"پورتریت",-1)),r[33]||(r[33]=o()),e("span",{class:I(L("portrait"))},[l.value==="portrait"?(m(),b("svg",Vt,[...r[30]||(r[30]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,Bt)])]),r[60]||(r[60]=o()),e("div",Ot,[e("div",Ft,[e("button",{onClick:r[5]||(r[5]=c=>T("right")),"aria-checked":l.value==="right",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:I(z("right"))},[...r[37]||(r[37]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 right-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -left-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-end gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"w-28 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),r[39]||(r[39]=o()),r[40]||(r[40]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"راست‌چین",-1)),r[41]||(r[41]=o()),e("span",{class:I(L("right"))},[l.value==="right"?(m(),b("svg",Pt,[...r[38]||(r[38]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,qt),r[57]||(r[57]=o()),e("button",{onClick:r[6]||(r[6]=c=>T("left")),"aria-checked":l.value==="left",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:I(z("left"))},[...r[42]||(r[42]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-3"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-start gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"w-28 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-4"})]),o(),e("div",{class:"px-3 pb-3 mt-auto space-y-3"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"w-24 h-1.5 bg-muted rounded"})]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"w-20 h-1.5 bg-muted rounded"})])])],-1)])],2),r[44]||(r[44]=o()),r[45]||(r[45]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"چپ‌چین",-1)),r[46]||(r[46]=o()),e("span",{class:I(L("left"))},[l.value==="left"?(m(),b("svg",Jt,[...r[43]||(r[43]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,Rt),r[58]||(r[58]=o()),e("button",{onClick:r[7]||(r[7]=c=>T("center")),"aria-checked":l.value==="center",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:I(z("center"))},[...r[47]||(r[47]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-24 bg-muted border-b border-border/40"},[e("div",{class:"absolute -bottom-6 left-1/2 -translate-x-1/2"},[e("div",{class:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm"},[e("i",{class:"ti ti-user text-xl text-muted-foreground"})]),o(),e("div",{class:"absolute -bottom-1 -right-2 w-7 h-7 rounded-full bg-muted border border-border"})])]),o(),e("div",{class:"px-3 pt-8 pb-3"},[e("div",{class:"flex flex-col items-center gap-2 mb-4"},[e("div",{class:"w-24 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"w-28 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-4"})]),o(),e("div",{class:"grid grid-cols-3 gap-2 px-3 pb-3 mt-auto"},[e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})]),o(),e("div",{class:"space-y-1"},[e("div",{class:"aspect-square bg-muted rounded-lg"}),e("div",{class:"h-1 bg-muted rounded"})])])],-1)])],2),r[49]||(r[49]=o()),r[50]||(r[50]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"وسط‌چین",-1)),r[51]||(r[51]=o()),e("span",{class:I(L("center"))},[l.value==="center"?(m(),b("svg",Wt,[...r[48]||(r[48]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,Ht),r[59]||(r[59]=o()),e("button",{onClick:r[8]||(r[8]=c=>T("portrait")),"aria-checked":l.value==="portrait",role:"radio",class:"flex flex-col items-center focus:outline-none"},[e("div",{class:I(z("portrait"))},[...r[52]||(r[52]=[e("div",{class:"w-full h-full bg-card flex flex-col"},[e("div",{class:"relative w-full h-20 bg-gradient-to-b from-muted to-card/90"},[e("div",{class:"absolute bottom-2 right-2"},[e("div",{class:"w-8 h-8 rounded-full bg-card border border-border flex items-center justify-center"},[e("i",{class:"ti ti-user text-xs text-muted-foreground"})])])]),o(),e("div",{class:"px-3 pt-4 pb-3"},[e("div",{class:"space-y-3 mb-6 text-center"},[e("div",{class:"mx-auto w-20 h-2.5 bg-muted/40 rounded"}),o(),e("div",{class:"mx-auto w-16 h-2 bg-muted rounded"}),o(),e("div",{class:"mx-auto w-24 h-2 bg-muted rounded"})]),o(),e("div",{class:"w-full h-8 bg-muted/40 rounded-full mb-6"}),o(),e("div",{class:"space-y-3"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-20 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-24 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-18 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-22 h-1.5 bg-muted rounded"})])]),o(),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-5 h-5 bg-muted rounded"}),o(),e("div",{class:"flex-1"},[e("div",{class:"w-16 h-1.5 bg-muted rounded mb-1"}),o(),e("div",{class:"w-20 h-1.5 bg-muted rounded"})])])])])],-1)])],2),r[54]||(r[54]=o()),r[55]||(r[55]=e("p",{class:"text-sm mt-3 text-foreground font-medium"},"پورتریت",-1)),r[56]||(r[56]=o()),e("span",{class:I(L("portrait"))},[l.value==="portrait"?(m(),b("svg",Yt,[...r[53]||(r[53]=[e("path",{fill:"currentColor",d:"M9 16.17 4.83 12 3.4 13.41 9 19 21 7 19.59 5.59z"},null,-1)])])):N("",!0)],2)],8,Zt)])])]),r[61]||(r[61]=o()),e("div",Kt,[e("button",{onClick:r[9]||(r[9]=c=>R()),class:"w-full py-3 bg-foreground/80 text-background rounded-xl font-semibold hover:bg-foreground transition-colors"},`\r
        تایید چیدمان\r
      `)])]),_:1},8,["modelValue"])],64))}}),Gt={class:"flex flex-col"},Qt={class:"fixed top-0 left-0 right-0 w-full bg-background/95 backdrop-blur-lg border-b border-border z-[100] block lg:hidden"},Dt={class:"flex items-center justify-between w-full p-4"},_t={class:"flex items-center gap-2"},es=["title"],ts=["onKeydown"],ss={key:0,class:"w-full grid grid-cols-1 lg:grid-cols-6 gap-4 lg:pt-6 pb-24 lg:pb-6 animate-pulse"},os={key:1,class:"w-full grid grid-cols-1 lg:grid-cols-6 gap-4 lg:pt-6 pb-24 lg:pb-6"},rs={class:"lg:col-span-4 min-h-0 px-1 lg:px-0"},ls={class:"mb-6"},as={class:"bg-card p-4 sm:p-6 rounded-xl mb-6 border border-border mt-8"},ds={class:"flex items-center justify-between"},is={class:"relative inline-flex items-center cursor-pointer"},ns={key:0,class:"space-y-3 mb-6 mt-8"},us={class:"flex items-center gap-3"},cs={class:"w-10 h-10 rounded-lg bg-muted flex items-center justify-center"},ms=["src"],fs={class:"font-medium text-foreground"},vs={class:"flex items-center gap-2"},ps=["onClick"],gs=["onClick"],bs={class:"bg-card mt-4 rounded-xl p-6 border border-border hover:shadow-md transition-shadow"},xs={class:"hidden lg:block mt-8"},ws={class:"flex justify-end"},hs=["disabled"],ys={class:"lg:col-span-2 space-y-4 sticky z-0 top-16 h-fit w-full hidden lg:block"},ks={class:"flex justify-center"},Cs={class:"relative",style:{width:"390px",height:"844px"}},$s={class:"absolute inset-0 rounded-[40px] border-4 border-gray-800 bg-black shadow-xl"},Is={class:"absolute inset-2 rounded-[32px] overflow-hidden bg-white"},Ls=["src"],Ns={class:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-lg border-t border-border p-4 z-40 lg:hidden"},Ts={class:"max-w-4xl mx-auto flex gap-3"},Ss=["disabled"],js={key:0,class:"fixed inset-0 z-[9999] lg:hidden bg-white"},Ms={class:"fixed top-0 left-0 right-0 z-10 bg-white border-b border-gray-200 safe-area-top"},zs={class:"flex items-center justify-between px-4 py-3"},Es={class:"pt-14 h-full w-full bg-white"},Us=["src"],As={class:"bg-background rounded-none lg:rounded-2xl w-full h-full lg:max-w-md lg:h-auto lg:max-h-[90vh] overflow-y-auto overflow-x-hidden lg:shadow-2xl border-0 lg:border border-border"},Bs={class:"flex items-center justify-between p-4 border-b border-border bg-background sticky top-0 z-10"},Vs={class:"text-base font-semibold text-foreground"},Os={class:"flex items-center gap-2"},Fs=["href"],qs={class:"flex-1"},Ps={__name:"index",props:{cardId:String,cardSlug:String},setup(Q){const U=Q,w=Ze(),d=ce(),j=$e(),l=g(!0),V=g(!1),M=g(!1),T=()=>{M.value=!M.value,B()},{getIconComponent:R,getSafeIcon:z}=Ye(),L=g(!1),y=g(""),r=g("ti-alert-triangle"),c=(s,t="ti-check")=>{y.value=s,r.value=t,L.value=!0,setTimeout(()=>L.value=!1,3e3)},k=F(()=>U.cardId||j.params.cardId||j.query.id||j.params.id||w.selectedCardId||null),S=F(()=>{if(w.value.iconColor?.background&&w.value.iconColor.background!=="transparent")return w.value.iconColor.background}),i=F(()=>!!(w.value.iconColor?.background&&w.value.iconColor.background!=="transparent")),E=g(!1);g(!1);const q=g(!1),f=g(null),a=g(-1),v=g(d.layout||"right");K(()=>d.layout,s=>{s&&s!==v.value&&(v.value=s)},{immediate:!0});function H(s){d.links||(d.links=[]);const t={...s};(!t.description||t.description.trim()===""||t.description==="description")&&delete t.description;const p=d.normalizeLink?d.normalizeLink(t):{...t,id:t.id||Date.now()+"_"+Math.random(),title:t.title||t.name||"",enabled:t.enabled!==void 0?t.enabled:!0};D(p),c("لینک با موفقیت اضافه شد","ti-check"),E.value=!1}async function D(s){if(!k.value){console.warn("No cardId available for creating link");return}try{const p=J().$axios,n={action:s.action||"",baseUrl:s.baseUrl||"",enabled:s.enabled!==void 0?s.enabled:!0,icon:s.icon?JSON.stringify(s.icon):null,id:s.id||`${Date.now()}_${Math.random().toString(36).slice(2)}`,name:s.name||"",title:s.title||"",type:s.type||"link",value:s.value||"",username:s.username||"",placeholder:s.placeholder?JSON.stringify(s.placeholder):null,showDescription:s.showDescription||!1,fullName:s.fullName||"",phoneNumber:s.phoneNumber||"",phoneRequired:s.phoneRequired||"",rewards:s.rewards||"",segments:s.segments||"",prizes:s.prizes||"",difficulty:s.difficulty||"",submitButtonText:s.submitButtonText||"",thankYouMessage:s.thankYouMessage||"",avatar:s.avatar||"",align:s.align||"",options:s.options||"",fileName:s.fileName||"",fileType:s.fileType||"",accountHolder:s.accountHolder||"",accountNumber:s.accountNumber||"",bankName:s.bankName||"",cardNumber:s.cardNumber||"",customBank:s.customBank||"",ibanNumber:s.ibanNumber||"",showBankDropdown:s.showBankDropdown||"",highlight:s.highlight||!1,access:s.access||"",address:s.address||"",days:s.days||"",mode:s.mode||"",latitude:s.latitude||"",longitude:s.longitude||"",zoom:s.zoom||"",fields:s.fields||"",selectedItems:s.selectedItems||""};s.description&&s.description.trim()&&s.description.trim()!==""&&(n.description=s.description.trim()),s.customIcon&&s.customIcon.trim()&&(n.customIcon=s.customIcon),console.log("Creating new link:",n);const h=await p.post(`v1/cards/${k.value}/links`,{link:JSON.stringify(n)});if(h.data.success){console.log("Link created successfully:",h.data.data);const x=d.normalizeLink?d.normalizeLink(h.data.data):h.data.data;d.links.push(x),B()}else throw new Error(h.data.message||"خطا در ایجاد لینک")}catch(t){console.error("Error creating link:",t),c("خطا در ایجاد لینک","ti-alert-triangle")}}function P(s,t){const p={map:"linkumap",bank:"card",bankcard:"card"};let n=s.icon;if(typeof s.icon=="string")try{n=JSON.parse(s.icon)}catch{const O=s.action?.toLowerCase(),A=p[O]||O;n=A?{type:"component",name:A,path:A}:null}if(!n&&s.action){const x=s.action.toLowerCase(),O=p[x]||x;n={type:"component",name:O,path:O}}const h={...s,icon:n,type:s.type||(s.action?.includes("block")?"block":"link"),action:s.action?.toLowerCase()||"basiclink",username:s.baseUrl&&s.value?.startsWith(s.baseUrl)?s.value.replace(s.baseUrl,""):s.username||""};h.title||(h.title=s.name||"بدون عنوان"),h.value||(h.value=""),f.value=h,a.value=t,q.value=!0}function $(){q.value=!1,f.value=null,a.value=-1}function Y(){if(!f.value)return"ویرایش محتوا";const s={basiclink:"ویرایش لینک",email:"ویرایش ایمیل",phone:"ویرایش تلفن",whatsapp:"ویرایش واتساپ",telegram:"ویرایش تلگرام",instagram:"ویرایش اینستاگرام",twitter:"ویرایش توییتر",youtube:"ویرایش یوتیوب",linkedin:"ویرایش لینکدین",map:"ویرایش نقشه",text:"ویرایش متن",faq:"ویرایش سوالات متداول",divider:"ویرایش جداکننده",contact:"ویرایش فرم تماس",payment:"ویرایش پرداخت",file:"ویرایش فایل"},t=f.value.action?.toLowerCase();return s[t]||"ویرایش محتوا"}function ee(s){const t={call:"تماس",number:"پیامک",email:"ایمیل",whatsapp:"واتساپ",telegram:"تلگرام",instagram:"اینستاگرام",linkedin:"لینکدین",twitter:"توییتر",youtube:"یوتیوب",tiktok:"تیک‌تاک",facebook:"فیسبوک",snapchat:"اسنپ‌چت",threads:"تردز",twitch:"توییچ",rubika:"روبیکا",bale:"بله",eitaa:"ایتا",igap:"آی‌گپ",discord:"دیسکورد",map:"نقشه",address:"آدرس",poll:"نظرسنجی",questionbox:"جعبه سوال",expandabletext:"متن بازشونده",textsection:"بخش متنی",file:"فایل",bankcard:"کارت بانکی",workhours:"ساعات کاری",contactcard:"کارت تماس",embeddedvideo:"ویدیو",customlink:"لینک سفارشی",luckydice:"تاس شانس",luckywheel:"گردونه شانس",luckyegg:"تخم مرغ شانس",builder:"فرم‌ساز",spotify:"اسپاتیفای",soundcloud:"ساندکلود",aparat:"آپارات",virgool:"ویرگول"},p=s.action?.toLowerCase();if(s.title&&s.title.trim()){const n=s.title.trim();if(!/^\+?[\d\s-]{8,20}$/.test(n)&&!/^[\d]+$/.test(n))return n}return s.name&&s.name.trim()?s.name.trim():p&&t[p]?t[p]:"بدون عنوان"}function te(s){if(!s)return null;const t=["bankcard","workhours","embeddedvideo","file","poll","textsection","questionbox","expandabletext","builder","luckydice","luckywheel","luckyegg","contactcard"];if(s.action&&t.includes(s.action.toLowerCase()))return null;if(s.baseUrl&&s.username)return s.baseUrl+s.username;if(s.username&&s.action){const n={telegram:"https://t.me/",instagram:"https://instagram.com/",twitter:"https://x.com/",youtube:"https://youtube.com/",linkedin:"https://linkedin.com/in/",tiktok:"https://www.tiktok.com/@",whatsapp:"https://wa.me/",facebook:"https://facebook.com/",threads:"https://www.threads.net/@",snapchat:"https://snapchat.com/add/",twitch:"https://twitch.tv/",rubika:"https://rubika.ir/",bale:"https://ble.ir/",eitaa:"https://eitaa.com/"}[s.action.toLowerCase()];if(n)return n+s.username}return s.value&&(s.value.startsWith("http")||s.value.startsWith("mailto:")||s.value.startsWith("tel:"))?s.value:null}function X(s){if(!s||!s.action)return ke;const t=s.action.toLowerCase();if(Object.prototype.hasOwnProperty.call(re,t))return re[t];const p=Object.keys(re).find(n=>n.toLowerCase()===t);return p?re[p]:ke}async function Se(s){const t={...s};if(t.baseUrl&&t.username&&(t.value=t.baseUrl+t.username),!!t.id)try{const n=J().$axios,h={backgroundImage:t.backgroundImage??"",phoneRequired:t.phoneRequired??"",rewards:t.rewards??"",segments:t.segments??"",prizes:t.prizes??"",difficulty:t.difficulty??"",submitButtonText:t.submitButtonText??"",thankYouMessage:t.thankYouMessage??"",avatar:t.avatar??"",align:t.align??"",options:t.options??"",fileName:t.fileName??"",fileType:t.fileType??"",accountHolder:t.accountHolder??"",accountNumber:t.accountNumber??"",bankName:t.bankName??"",cardNumber:t.cardNumber??"",customBank:t.customBank??"",ibanNumber:t.ibanNumber??"",showBankDropdown:t.showBankDropdown??"",highlight:t.highlight??!1,access:t.access??"",address:t.address??"",days:t.days??"",mode:t.mode??"",latitude:t.latitude??"",longitude:t.longitude??"",zoom:t.zoom??"",action:t.action??"",fields:t.fields??"",baseUrl:t.baseUrl??"",customIcon:t.customIcon??"",description:t.description??"",enabled:t.enabled,icon:t.icon?typeof t.icon=="string"?t.icon:JSON.stringify(t.icon):t.action?JSON.stringify({type:"component",name:t.action}):null,id:t.id,name:t.name,username:t.username??"",selectedItems:t.selectedItems??"",placeholder:t.placeholder?JSON.stringify(t.placeholder):null,showDescription:t.showDescription??!1,title:t.title,type:t.type,value:t.value??""},x=await n.put(`v1/cards/${k.value}/links/${t.id}/update`,{link:JSON.stringify(h)});if(x.data?.success){const O=d.links.findIndex(A=>A.id===t.id);if(O!==-1){const A=x.data.data||{};if(typeof A.icon=="string")try{A.icon=JSON.parse(A.icon)}catch{A.icon=t.icon}A.icon||(A.icon=t.icon),d.links[O]={...t,...A},d.links=[...d.links]}q.value=!1,f.value=null,a.value=-1,B(),c(x.data.message||"لینک با موفقیت ویرایش شد","ti-check")}else c(x.data.message||"خطا در ویرایش لینک","ti-alert-triangle")}catch(p){p.response?c(p.response.data.message||"خطا در ویرایش لینک","ti-alert-triangle"):c("مشکلی در ارتباط با سرور وجود دارد","ti-alert-triangle")}}function ae(s){if(d.links&&d.links.length>s){const t=d.links[s];t.id&&k.value?je(t.id,s):(d.links.splice(s,1),B(),c("لینک حذف شد","ti-check"))}}async function je(s,t){if(!k.value||!s){console.warn("No cardId or linkId available for deletion"),d.links&&d.links.length>t&&(d.links.splice(t,1),B(),c("لینک حذف شد","ti-check"));return}try{const n=J().$axios;console.log("Deleting link:",s),(await n.delete(`v1/cards/${k.value}/links/${s}/delete`)).data.success?(console.log("Link deleted successfully"),d.links&&d.links.length>t&&d.links.splice(t,1),B(),c("لینک حذف شد","ti-check")):(d.links&&d.links.length>t&&d.links.splice(t,1),B(),c("لینک حذف شد","ti-check"))}catch(p){console.error("Error deleting link:",p),d.links&&d.links.length>t&&d.links.splice(t,1),B(),c("لینک حذف شد","ti-check")}}function Me(s){V.value=!1,s.oldIndex!==s.newIndex&&(ze(),B(),c("ترتیب لینک‌ها تغییر کرد","ti-arrows-move"))}async function ze(){if(!(!k.value||!d.links||d.links.length===0))try{const t=J().$axios,p=d.links.map(h=>h.hash);console.log("Saving links order by hash:",p);const n=await t.post(`v1/cards/${k.value}/links/reorder`,{hashOrder:p});if(n.data.success)console.log("Links order saved successfully");else throw new Error(n.data.message||"خطا در ذخیره ترتیب لینک‌ها")}catch(s){console.error("Error saving links order:",s),Ue()}}function me(s){const t=s.icon||null;return t&&typeof t=="object"?R(t):null}function fe(s){return z(s)}function Ee(s){return{call:"phone",number:"message",email:"mail",telegram:"brand-telegram",whatsapp:"brand-whatsapp",eitaa:"brand-telegram",contactcard:"id-badge-2",address:"map-pin",facetime:"video",map:"map",instagram:"brand-instagram",facebook:"brand-facebook",tiktok:"brand-tiktok",twitter:"brand-twitter",x:"brand-x",linkedin:"brand-linkedin",youtube:"brand-youtube",aparat:"video",discord:"brand-discord",snapchat:"brand-snapchat",pinterest:"brand-pinterest",threads:"brand-threads",clubhouse:"microphone",twitch:"brand-twitch",rubika:"message-circle",bale:"message-circle",igap:"message-circle",medium:"brand-medium",virgool:"article",website:"world",app_link:"apps",github:"brand-github",booksy:"calendar",calendly:"calendar-event",card:"credit-card",chili:"chili",etsy:"shopping-bag",reviews:"star",review:"star",square:"square",yelp:"star",divar:"home",snapp:"car",nshan:"map",neshan:"map",balad:"map-pin",figma:"brand-figma",googlemeet:"video",teams:"brand-teams",zoom:"video",trustpilot:"star",zillow:"home",cashapp:"currency-dollar",paypal:"brand-paypal",zelle:"currency-dollar",remit:"currency-dollar",reymit:"currency-dollar",zarinpal:"credit-card",trustwallet:"wallet",customlink:"external-link",dropdown:"chevron-down",embeddedvideo:"player-play",featured:"star",featuredlink:"star",file:"file",textsection:"file-text","text-section":"file-text",poll:"chart-bar",questionbox:"help-circle",hoobe:"music",linktree:"tree",opensea_color:"palette",podcasts:"microphone",poshmark:"shopping-bag",spotify:"brand-spotify",youtube_music:"music",apple_music:"music",luckyegg:"egg",luckydice:"dice",luckywheel:"wheel",form:"forms"}[s.action]||"link"}async function Ue(){if(!k.value){console.warn("No cardId available for saving links");return}try{const t=J().$axios,p=new FormData,n=d.links?d.links.map(x=>{const O={...x,id:x.id||Date.now()+"_"+Math.random(),title:x.title||x.name||"",action:x.action||"customlink",url:x.url||"",enabled:x.enabled!==void 0?x.enabled:!0,icon:x.icon||null,customIcon:x.customIcon||null,isListMode:x.isListMode!==void 0?x.isListMode:!0};return x.description&&x.description.trim()&&x.description.trim()!==""&&(O.description=x.description.trim()),O}):[];p.append("linksDataList",JSON.stringify(n)),console.log("Saving links to server:",n);const h=await t.post(`v1/cards/${k.value}/update`,p,{headers:{"X-HTTP-Method-Override":"PUT"}});if(h.data.success)console.log("Links saved successfully"),B();else throw new Error(h.data.message||"خطا در ذخیره لینک‌ها")}catch(s){console.error("Error saving links:",s),c("خطا در ذخیره لینک‌ها","ti-alert-triangle")}}function Ae(s){}async function Be(s){try{if(w.value&&(w.value.layout=s),d.layout=s,U.cardId){const t=new FormData;t.append("layoutMode",s),d.themeColor&&t.append("themeColor",JSON.stringify(d.themeColor)),d.iconColor&&t.append("iconColor",JSON.stringify(d.iconColor));const h=await J().$axios.post(`v1/cards/${U.cardId}/update`,t,{headers:{"X-HTTP-Method-Override":"PUT"}});if(h.data.success)c("چیدمان با موفقیت ذخیره شد","ti-check");else throw new Error(h.data.message||"خطا در ذخیره چیدمان")}else c("چیدمان تغییر کرد","ti-check")}catch{c("خطا در ذخیره چیدمان","ti-alert-triangle")}}function Ve(){if(f.value){$();return}window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0?window.location.href="/dashboard":window.history.length>2?window.history.back():window.location.href="/dashboard"}function ve(){console.log("goToLeadCapture clicked!"),window.location.href="/profile/lead-capture"}const G=g(!1),pe=()=>{G.value=!0;const s=new CustomEvent("manual-save",{detail:{source:"header-save"}});window.dispatchEvent(s),setTimeout(()=>{G.value=!1,c("تغییرات با موفقیت ذخیره شد","ti-check")},2e3)},{$axios:Rs}=J(),se=g(null),ge=g(0),oe=g(!1),Oe=g(!0),be=g(!1),xe=F(()=>{if(typeof window>"u")return"about:blank";const s=new URLSearchParams;s.set("t",Date.now().toString()),s.set("cardId",String(k.value)),s.set("isDefault","1");const t=U.cardSlug||"editCard";return`${window.location.origin}/preview/${t}?${s.toString()}`}),we=()=>{Oe.value=!1},B=()=>{if(!(!be.value||!se.value?.contentWindow))try{const s=le(d.$state),t=JSON.parse(JSON.stringify(s));t.showLeadFormPreview=M.value,se.value.contentWindow.postMessage({type:"FORM_DATA_UPDATE",data:t},window.location.origin)}catch{}},he=s=>{s.origin===window.location.origin&&s.data?.type==="IFRAME_READY"&&(be.value=!0,B())};return Ie(async()=>{{window.addEventListener("message",he);const s=k.value;if(s)try{await d.setAboutFrom(s)}catch(t){console.error("Error loading card:",t)}else if(w.cards&&w.cards.length>0){const t=w.defaultCard||w.cards[0];t?.id&&await d.setAboutFrom(t.id)}setTimeout(()=>{l.value=!1},300)}}),K(()=>d.$state,()=>{B()},{deep:!0}),K(()=>d.cards,s=>{d.setAboutFrom(String(k.value))},{immediate:!0}),K(()=>d.links,s=>{w.value&&(w.value.links=s||[])},{deep:!0,immediate:!0}),K(()=>d.isLeadCaptureEnabled,async(s,t)=>{if(console.log("Lead capture watch triggered:",{newValue:s,oldValue:t,cardId:k.value}),s===t){console.log("No change in lead capture value, skipping");return}if(k.value)try{const n=J().$axios;console.log("Saving lead capture mode:",s,"for card:",k.value);const h=new FormData;h.append("leadCaptureMode",s?"1":"0");const x=await n.post(`v1/cards/${k.value}/update`,h,{headers:{"X-HTTP-Method-Override":"PUT"}});if(x.data.success)console.log("فرم لید با موفقیت ذخیره شد:",s),c(s?"فرم لید فعال شد":"فرم لید غیرفعال شد","ti-check");else throw new Error(x.data.message||"خطا در ذخیره فرم لید")}catch(p){console.error("Error saving lead capture setting:",p),c("خطا در ذخیره تنظیمات فرم","ti-alert-triangle"),setTimeout(()=>{d.isLeadCaptureEnabled=t},100)}else console.warn("No cardId available for saving lead capture setting"),c("خطا: شناسه کارت موجود نیست","ti-alert-triangle"),setTimeout(()=>{d.isLeadCaptureEnabled=t},100)}),Le(()=>{window.removeEventListener("message",he)}),(s,t)=>{const p=Fe;return m(),b(Z,null,[e("div",Gt,[e("div",Qt,[e("div",Dt,[e("div",{class:"flex items-center gap-3"},[e("button",{onClick:Ve,class:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-accent transition-colors"},[...t[11]||(t[11]=[e("i",{class:"ti ti-arrow-right text-xl text-foreground"},null,-1)])]),t[12]||(t[12]=o()),t[13]||(t[13]=e("h1",{class:"text-lg font-semibold text-foreground"},"ویرایش پروفایل",-1))]),t[16]||(t[16]=o()),e("div",_t,[u(d).isLeadCaptureEnabled?(m(),b("button",{key:0,onClick:T,type:"button",class:"bg-accent hover:bg-accent/80 text-accent-foreground px-3 py-2 rounded-xl flex items-center gap-2",title:M.value?"پنهان کردن فرم":"نمایش پیش‌نمایش فرم"},[e("i",{class:I([M.value?"ti ti-eye-off":"ti ti-eye","text-base"])},null,2)],8,es)):N("",!0),t[15]||(t[15]=o()),e("button",{onClick:ie(ve,["prevent","stop"]),onKeydown:Re(ie(ve,["prevent","stop"]),["enter"]),type:"button",tabindex:"-1",class:"bg-primary text-primary-foreground px-3 py-2 rounded-xl flex items-center gap-2 relative z-[101]"},[...t[14]||(t[14]=[e("i",{class:"ti ti-message text-base"},null,-1),o(),e("span",{class:"text-sm font-medium"},"فرم ارتباط",-1)])],40,ts)])])]),t[71]||(t[71]=o()),l.value?(m(),b("div",ss,[...t[17]||(t[17]=[ne('<div class="lg:col-span-4 min-h-0 px-1 lg:px-0 space-y-6" data-v-0f3499c7><div class="bg-card p-4 rounded-xl border border-border" data-v-0f3499c7><div class="h-5 w-32 bg-muted rounded mb-3" data-v-0f3499c7></div> <div class="flex gap-3" data-v-0f3499c7><div class="h-16 flex-1 bg-muted rounded-xl" data-v-0f3499c7></div> <div class="h-16 flex-1 bg-muted rounded-xl" data-v-0f3499c7></div> <div class="h-16 flex-1 bg-muted rounded-xl" data-v-0f3499c7></div></div></div> <div class="bg-card p-4 sm:p-6 rounded-xl border border-border space-y-4" data-v-0f3499c7><div class="flex items-center gap-4" data-v-0f3499c7><div class="w-20 h-20 bg-muted rounded-full" data-v-0f3499c7></div> <div class="flex-1 space-y-2" data-v-0f3499c7><div class="h-5 w-3/4 bg-muted rounded" data-v-0f3499c7></div> <div class="h-4 w-1/2 bg-muted rounded" data-v-0f3499c7></div></div></div> <div class="space-y-3" data-v-0f3499c7><div class="h-10 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="h-10 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="h-20 bg-muted rounded-lg" data-v-0f3499c7></div></div></div> <div class="bg-card p-4 sm:p-6 rounded-xl border border-border" data-v-0f3499c7><div class="flex items-center justify-between" data-v-0f3499c7><div class="space-y-2" data-v-0f3499c7><div class="h-5 w-40 bg-muted rounded" data-v-0f3499c7></div> <div class="h-4 w-56 bg-muted rounded" data-v-0f3499c7></div></div> <div class="w-11 h-6 bg-muted rounded-full" data-v-0f3499c7></div></div></div> <div class="space-y-3" data-v-0f3499c7><div class="h-6 w-36 bg-muted rounded" data-v-0f3499c7></div> <div class="space-y-2" data-v-0f3499c7><div class="bg-card border border-border rounded-xl p-4 flex items-center justify-between" data-v-0f3499c7><div class="flex items-center gap-3" data-v-0f3499c7><div class="w-6 h-8 bg-muted rounded" data-v-0f3499c7></div> <div class="w-10 h-10 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="h-5 w-32 bg-muted rounded" data-v-0f3499c7></div></div> <div class="flex gap-2" data-v-0f3499c7><div class="w-8 h-8 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="w-8 h-8 bg-muted rounded-lg" data-v-0f3499c7></div></div></div> <div class="bg-card border border-border rounded-xl p-4 flex items-center justify-between" data-v-0f3499c7><div class="flex items-center gap-3" data-v-0f3499c7><div class="w-6 h-8 bg-muted rounded" data-v-0f3499c7></div> <div class="w-10 h-10 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="h-5 w-28 bg-muted rounded" data-v-0f3499c7></div></div> <div class="flex gap-2" data-v-0f3499c7><div class="w-8 h-8 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="w-8 h-8 bg-muted rounded-lg" data-v-0f3499c7></div></div></div> <div class="bg-card border border-border rounded-xl p-4 flex items-center justify-between" data-v-0f3499c7><div class="flex items-center gap-3" data-v-0f3499c7><div class="w-6 h-8 bg-muted rounded" data-v-0f3499c7></div> <div class="w-10 h-10 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="h-5 w-36 bg-muted rounded" data-v-0f3499c7></div></div> <div class="flex gap-2" data-v-0f3499c7><div class="w-8 h-8 bg-muted rounded-lg" data-v-0f3499c7></div> <div class="w-8 h-8 bg-muted rounded-lg" data-v-0f3499c7></div></div></div></div></div> <div class="bg-card rounded-xl p-6 border border-border" data-v-0f3499c7><div class="flex gap-4 mb-6" data-v-0f3499c7><div class="w-12 h-12 bg-muted rounded-xl" data-v-0f3499c7></div> <div class="flex-1 space-y-2" data-v-0f3499c7><div class="h-5 w-28 bg-muted rounded" data-v-0f3499c7></div> <div class="h-4 w-full bg-muted rounded" data-v-0f3499c7></div></div></div> <div class="h-12 bg-muted rounded-xl" data-v-0f3499c7></div></div></div> <div class="lg:col-span-2 hidden lg:block" data-v-0f3499c7><div class="sticky top-6" data-v-0f3499c7><div class="bg-card rounded-2xl border border-border p-4 space-y-4" data-v-0f3499c7><div class="h-6 w-24 bg-muted rounded mx-auto" data-v-0f3499c7></div> <div class="aspect-[9/16] bg-muted rounded-xl" data-v-0f3499c7></div></div></div></div>',3)])])):(m(),b("div",os,[e("div",rs,[e("div",ls,[C(Xt,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=n=>v.value=n),onLayoutChanged:Ae,onConfirm:Be},null,8,["modelValue"])]),t[39]||(t[39]=o()),C(It,{cardId:k.value,form:u(w).value,"onUpdate:form":t[1]||(t[1]=n=>u(w).value=n),onOpenPreview:t[2]||(t[2]=n=>oe.value=!0),class:"bg-card p-4 sm:p-6 rounded-xl mb-6 border border-border"},null,8,["cardId","form"]),t[40]||(t[40]=o()),e("div",as,[e("div",ds,[t[20]||(t[20]=e("div",null,[e("h3",{class:"text-base font-semibold text-foreground mb-1"},"فرم دریافت اطلاعات"),o(),e("p",{class:"text-sm text-muted-foreground"},"فعال‌سازی فرم برای جمع‌آوری اطلاعات بازدیدکنندگان")],-1)),t[21]||(t[21]=o()),e("label",is,[Je(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=n=>u(d).isLeadCaptureEnabled=n),class:"sr-only peer"},null,512),[[He,u(d).isLeadCaptureEnabled]]),t[18]||(t[18]=o()),t[19]||(t[19]=e("div",{class:"w-11 h-6 bg-muted peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-card after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"},null,-1))])])]),t[41]||(t[41]=o()),u(d).links&&u(d).links.length>0?(m(),b("div",ns,[t[29]||(t[29]=e("h3",{class:"text-lg font-semibold text-foreground"},"محتوای اضافه شده",-1)),t[30]||(t[30]=o()),C(u(rt),{modelValue:u(d).links,"onUpdate:modelValue":t[4]||(t[4]=n=>u(d).links=n),animation:200,"ghost-class":"ghost-item","chosen-class":"chosen-item","drag-class":"drag-item","item-key":"id",handle:".drag-handle",class:"space-y-2",onEnd:Me},{item:W(({element:n,index:h})=>[e("div",{class:I(["bg-card border border-border rounded-xl p-4 flex items-center justify-between hover:bg-muted/20 transition-all duration-200 group",{"shadow-lg scale-[1.02]":V.value}])},[e("div",us,[t[22]||(t[22]=e("div",{class:"drag-handle cursor-grab active:cursor-grabbing transition-opacity p-2 -m-2 touch-none"},[e("i",{class:"ti ti-grip-vertical text-muted-foreground text-xl"})],-1)),t[23]||(t[23]=o()),e("div",cs,[me(n)?(m(),de(ye(me(n)),{key:0,size:20,color:S.value,filled:i.value},null,8,["color","filled"])):fe(n)?(m(),b("img",{key:1,src:fe(n),class:"w-5 h-5 object-contain",alt:"icon"},null,8,ms)):(m(),b("i",{key:2,class:I(`ti ti-${Ee(n)} text-muted-foreground`)},null,2))]),t[24]||(t[24]=o()),e("div",null,[e("p",fs,ue(ee(n)),1)])]),t[28]||(t[28]=o()),e("div",vs,[e("button",{onClick:x=>P(n,h),class:"w-8 h-8 rounded-lg bg-muted hover:bg-muted-foreground/20 flex items-center justify-center transition-colors"},[...t[25]||(t[25]=[e("i",{class:"ti ti-edit text-sm text-muted-foreground"},null,-1)])],8,ps),t[27]||(t[27]=o()),e("button",{onClick:x=>ae(h),class:"w-8 h-8 rounded-lg bg-destructive/10 hover:bg-destructive/20 flex items-center justify-center transition-colors"},[...t[26]||(t[26]=[e("i",{class:"ti ti-trash text-sm text-destructive"},null,-1)])],8,gs)])],2)]),_:1},8,["modelValue"])])):N("",!0),t[42]||(t[42]=o()),e("div",bs,[t[32]||(t[32]=ne(`<div class="flex gap-4 mb-6" data-v-0f3499c7><div class="w-12 h-12 bg-muted/40 rounded-xl flex items-center justify-center border-2 border-dashed border-border/60 hover:border-primary/50 hover:bg-primary/5 transition-colors" data-v-0f3499c7><i class="ti ti-plus text-muted-foreground text-xl" data-v-0f3499c7></i></div> <div class="flex-1" data-v-0f3499c7><h3 class="text-base font-semibold text-foreground mb-2" data-v-0f3499c7>افزودن محتوا</h3> <p class="text-sm text-muted-foreground leading-relaxed" data-v-0f3499c7>\r
                اطلاعات تماس، شبکه‌های اجتماعی، لینک‌ها و محتوای دیگر را به کارت خود اضافه کنید\r
              </p></div></div> `,2)),e("button",{onClick:t[5]||(t[5]=n=>E.value=!0),class:"w-full bg-primary text-primary-foreground px-6 py-3.5 rounded-xl text-sm font-medium transition-all duration-200 flex items-center justify-center gap-3 hover:bg-primary/90 hover:shadow-lg transform hover:-translate-y-0.5"},[...t[31]||(t[31]=[e("i",{class:"ti ti-plus text-lg"},null,-1),o(),e("span",null,"افزودن محتوا",-1),o(),e("i",{class:"ti ti-arrow-left text-sm"},null,-1)])])]),t[43]||(t[43]=o()),e("div",xs,[e("div",ws,[e("button",{onClick:pe,disabled:G.value,class:"bg-primary text-primary-foreground px-8 py-3.5 rounded-xl text-sm font-semibold transition-all duration-200 flex items-center justify-center gap-2 hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-md"},[G.value?(m(),b(Z,{key:0},[t[33]||(t[33]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o(),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),t[34]||(t[34]=o()),t[35]||(t[35]=e("span",{class:"text-sm font-medium"},"در حال ذخیره...",-1))],64)):(m(),b(Z,{key:1},[t[36]||(t[36]=e("i",{class:"ti ti-device-floppy text-lg"},null,-1)),t[37]||(t[37]=o()),t[38]||(t[38]=e("span",{class:"text-sm font-medium"},"ذخیره تغییرات",-1))],64))],8,hs)])])]),t[47]||(t[47]=o()),e("div",ys,[e("div",ks,[e("div",Cs,[e("div",$s,[t[46]||(t[46]=ne('<div class="absolute top-[15%] -left-[5px] w-[4px] h-5 bg-slate-700 rounded-xl" data-v-0f3499c7></div> <div class="absolute top-[25%] -left-[5px] w-[4px] h-10 bg-slate-700 rounded-xl" data-v-0f3499c7></div> <div class="absolute top-[35%] -left-[5px] w-[4px] h-10 bg-slate-700 rounded-xl" data-v-0f3499c7></div> <div class="absolute top-[35%] -right-[5px] w-[4px] h-16 bg-slate-700 rounded-xl" data-v-0f3499c7></div> <div class="absolute top-3 left-1/2 -translate-x-1/2 w-16 h-5 bg-black rounded-xl z-20" data-v-0f3499c7></div> ',10)),e("div",Is,[C(p,null,{fallback:W(()=>[...t[44]||(t[44]=[e("div",{class:"w-full h-full bg-gray-100 rounded-[28px] flex items-center justify-center"},[e("div",{class:"text-gray-500"},"در حال بارگذاری...")],-1)])]),default:W(()=>[(m(),b("iframe",{ref_key:"iframeRef",ref:se,key:`iframe-${ge.value}`,src:xe.value,class:"w-full h-full border-0 rounded-[28px] overflow-hidden",sandbox:"allow-scripts allow-forms allow-same-origin allow-popups",loading:"lazy",onLoad:we},null,40,Ls)),t[45]||(t[45]=o())]),_:1})])])])])])])),t[72]||(t[72]=o()),e("div",Ns,[e("div",Ts,[e("button",{onClick:t[6]||(t[6]=n=>oe.value=!0),class:"flex-1 bg-muted text-foreground px-6 py-3 rounded-xl text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 hover:bg-muted/80"},[...t[48]||(t[48]=[e("i",{class:"ti ti-eye text-lg"},null,-1),o(),e("span",null,"پیش‌نمایش",-1)])]),t[55]||(t[55]=o()),e("button",{onClick:pe,disabled:G.value,class:"flex-2 bg-primary text-primary-foreground px-6 py-3 rounded-xl text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed"},[G.value?(m(),b(Z,{key:0},[t[49]||(t[49]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o(),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),t[50]||(t[50]=o()),t[51]||(t[51]=e("span",{class:"text-sm font-medium"},"در حال ذخیره...",-1))],64)):(m(),b(Z,{key:1},[t[52]||(t[52]=e("i",{class:"ti ti-device-floppy text-lg"},null,-1)),t[53]||(t[53]=o()),t[54]||(t[54]=e("span",{class:"text-sm font-medium"},"ذخیره تغییرات",-1))],64))],8,Ss)])]),t[73]||(t[73]=o()),C(We,{"enter-active-class":"transform transition ease-in-out duration-300","enter-from-class":"translate-y-full","enter-to-class":"translate-y-0","leave-active-class":"transform transition ease-in-out duration-300","leave-from-class":"translate-y-0","leave-to-class":"translate-y-full"},{default:W(()=>[oe.value?(m(),b("div",js,[e("div",Ms,[e("div",zs,[e("button",{onClick:t[7]||(t[7]=n=>oe.value=!1),class:"flex items-center gap-2 text-gray-700 hover:text-gray-900 transition-colors"},[...t[56]||(t[56]=[e("i",{class:"ti ti-arrow-right text-xl"},null,-1),o(),e("span",{class:"text-sm font-medium"},"بازگشت",-1)])]),t[57]||(t[57]=o()),t[58]||(t[58]=e("h2",{class:"text-base font-semibold text-gray-800"},"پیش‌نمایش",-1)),t[59]||(t[59]=o()),t[60]||(t[60]=e("div",{class:"w-16"},null,-1))])]),t[63]||(t[63]=o()),e("div",Es,[C(p,null,{fallback:W(()=>[...t[61]||(t[61]=[e("div",{class:"w-full h-full bg-white flex items-center justify-center"},[e("div",{class:"text-gray-500"},"در حال بارگذاری...")],-1)])]),default:W(()=>[(m(),b("iframe",{ref_key:"iframeRef",ref:se,key:`iframe-mobile-${ge.value}`,src:xe.value,class:"w-full h-full border-0 bg-white",sandbox:"allow-scripts allow-forms allow-same-origin allow-popups",loading:"lazy",onLoad:we},null,40,Us)),t[62]||(t[62]=o())]),_:1})])])):N("",!0)]),_:1}),t[74]||(t[74]=o()),E.value?(m(),de(et,{key:2,cardId:k.value,onClose:t[8]||(t[8]=n=>E.value=!1),onAddLink:H},null,8,["cardId"])):N("",!0),t[75]||(t[75]=o()),q.value?(m(),b("div",{key:3,class:"fixed inset-0 bg-black/50 backdrop-blur flex items-center justify-center z-[60] p-0 lg:p-4",onClick:ie($,["self"])},[e("div",As,[e("div",Bs,[e("button",{class:"text-muted-foreground hover:text-foreground flex items-center gap-2 transition-colors",onClick:$},[...t[64]||(t[64]=[e("i",{class:"ti ti-arrow-right text-lg"},null,-1),o(),e("span",{class:"text-sm font-medium"},"برگشت",-1)])]),t[68]||(t[68]=o()),e("h3",Vs,ue(Y()),1),t[69]||(t[69]=o()),e("div",Os,[f.value&&te(f.value)?(m(),b("a",{key:0,href:te(f.value),target:"_blank",class:"w-9 h-9 flex items-center justify-center rounded-lg hover:bg-muted text-muted-foreground hover:text-foreground transition-colors",title:"مشاهده لینک"},[...t[65]||(t[65]=[e("i",{class:"ti ti-external-link text-lg"},null,-1)])],8,Fs)):N("",!0),t[67]||(t[67]=o()),f.value?(m(),b("button",{key:1,type:"button",class:"w-9 h-9 flex items-center justify-center rounded-lg hover:bg-destructive/10 text-destructive hover:text-destructive/80 transition-colors",title:"حذف",onClick:t[9]||(t[9]=()=>{ae(a.value),$()})},[...t[66]||(t[66]=[e("i",{class:"ti ti-trash text-lg"},null,-1)])])):N("",!0)])]),t[70]||(t[70]=o()),e("div",qs,[f.value?(m(),de(ye(X(f.value)),{key:0,link:f.value,cardId:k.value,onCancel:$,onBack:$,onSubmit:Se,onDelete:t[10]||(t[10]=()=>{ae(a.value),$()})},null,40,["link","cardId"])):N("",!0)])])])):N("",!0)]),t[76]||(t[76]=o()),C(Te,{visible:L.value,message:y.value,icon:r.value},null,8,["visible","message","icon"])],64)}}},so=lt(Ps,[["__scopeId","data-v-0f3499c7"]]);export{so as E};
