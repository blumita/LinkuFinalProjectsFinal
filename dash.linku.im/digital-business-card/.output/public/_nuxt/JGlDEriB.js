import{k as z,r as C,c as f,o as B,b as l,f as e,e as r,h as b,d as x,t as i,P as v,Q as y,i as n,n as T,O as u,N as F,Y as L}from"#entry";import{u as P}from"./S2fq3tuq.js";import{u as V}from"./DVjSPpAI.js";const E={class:"min-h-screen bg-background"},I={class:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-card border-b border-border"},A={class:"flex items-center justify-between px-4 h-16"},O={class:"hidden lg:block bg-card border-b border-border sticky top-0 z-40"},Q={class:"px-4 lg:px-6 py-6"},Y={class:"flex items-center justify-between"},q={class:"flex items-center gap-3"},G={key:0,class:"flex items-center gap-6 px-6 py-3 bg-muted rounded-xl"},H={class:"text-center"},J={class:"text-lg font-bold text-foreground"},K={class:"text-center"},U={class:"text-lg font-bold text-foreground"},W={class:"text-center"},X={class:"text-lg font-bold text-foreground"},Z={class:"lg:pt-0 pt-20 pb-24 lg:pb-8"},tt={class:"px-4 lg:px-6 py-6"},et={key:0,class:"space-y-6 animate-pulse"},st={class:"space-y-4"},rt={key:1},ot={class:"mb-6"},lt={class:"flex items-center gap-3 overflow-x-auto lg:overflow-visible pb-2 lg:justify-start"},nt=["onClick"],it={class:"space-y-4 lg:grid lg:grid-cols-2 xl:grid-cols-3 lg:gap-6 lg:space-y-0"},dt={key:0,class:"bg-card border border-border p-8 rounded-xl text-center"},at=["onClick"],ut={key:0,class:"relative w-full h-32 lg:h-40 overflow-hidden"},xt=["src","alt"],pt={class:"absolute top-3 right-3 bg-primary/95 backdrop-blur-sm text-white px-3 py-1.5 rounded-full text-xs font-bold shadow-lg"},mt={class:"p-5 lg:p-6"},gt={class:"flex items-start justify-between mb-3"},ft={class:"flex-1"},bt={class:"flex items-center gap-2 mb-2 flex-wrap"},vt={class:"font-medium text-foreground lg:text-base"},yt={class:"text-sm text-muted-foreground mb-4 line-clamp-2"},ct={key:0,class:"mb-4"},wt={class:"flex items-center justify-between mb-1.5"},kt={class:"text-xs font-medium text-primary"},Dt={class:"w-full bg-muted rounded-full h-2"},Ct={class:"flex items-center gap-4 text-xs text-muted-foreground mb-4 lg:mb-0"},Tt={key:0,class:"flex items-center gap-1.5"},jt={class:"flex items-center gap-1.5"},_t={class:"w-14 h-14 lg:w-16 lg:h-16 bg-gradient-to-br from-primary/10 to-primary/5 rounded-xl flex items-center justify-center border border-primary/20 overflow-hidden flex-shrink-0"},ht=["src","alt"],Nt={key:1,class:"ti ti-discount text-primary text-2xl lg:text-3xl"},Rt={class:"pt-3 mt-auto border-t border-border"},$t=["onClick","disabled"],Mt={key:0},St={key:1},zt={class:"font-mono"},Bt={key:1,class:"flex items-center justify-center gap-2 text-sm py-2.5 px-4 rounded-lg bg-muted text-muted-foreground"},Ft={class:"opacity-50 font-mono"},Lt={class:"mr-2 text-xs"},At=z({__name:"rewards",setup(Pt){const d=P(),c=V(),a=C(null),p=C("all"),j=[{label:"همه",value:"all"},{label:"فعال",value:"active"},{label:"استفاده شده",value:"used"},{label:"منقضی",value:"expired"}],w=f(()=>p.value==="all"?d.rewards:d.rewards.filter(o=>o.status===p.value)),_=f(()=>d.activeRewards.length),h=f(()=>d.usedRewards.length),N=f(()=>d.expiredRewards.length),R=o=>{if(!o)return"نامشخص";const t=new Date(o);return isNaN(t.getTime())?"نامشخص":new Intl.DateTimeFormat("fa-IR").format(t)},m=o=>{if(!o)return 0;const t=new Date,s=new Date(o);if(isNaN(s.getTime()))return 0;const g=s.getTime()-t.getTime();return Math.ceil(g/(1e3*3600*24))},$=o=>{const s=m(o);return s<=0?0:Math.max(0,Math.min(100,s/30*100))},k=o=>{switch(o){case"active":return"bg-green-500/10 text-green-500";case"expired":return"bg-red-500/10 text-red-500";case"used":return"bg-gray-500/10 text-gray-500";default:return"bg-secondary text-secondary"}},D=o=>{switch(o){case"active":return"فعال";case"expired":return"منقضی";case"used":return"استفاده شده";default:return"نامشخص"}},M=async o=>{a.value=o;try{if(navigator.clipboard)await navigator.clipboard.writeText(o);else{const t=document.createElement("textarea");t.value=o,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}c.success(`کد ${o} کپی شد`),setTimeout(()=>{a.value=null},1500)}catch{c.error("امکان کپی کردن کد تخفیف وجود ندارد"),a.value=null}},S=o=>{T(`/rewards/discount/${o}`)};return B(async()=>{await d.fetchRewards()}),(o,t)=>(n(),l("div",E,[e("div",I,[e("div",A,[e("button",{onClick:t[0]||(t[0]=s=>("navigateTo"in o?o.navigateTo:b(T))("/profile")),class:"p-2 hover:bg-muted rounded-lg transition-colors"},[...t[1]||(t[1]=[e("i",{class:"ti ti-arrow-right text-foreground text-xl"},null,-1)])]),t[2]||(t[2]=r()),t[3]||(t[3]=e("h1",{class:"text-lg font-bold text-foreground"},"تخفیفات و جوایز",-1)),t[4]||(t[4]=r()),t[5]||(t[5]=e("div",{class:"w-10"},null,-1))])]),t[48]||(t[48]=r()),e("div",O,[e("div",Q,[e("div",Y,[t[18]||(t[18]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground mb-1"},"تخفیفات و جوایز"),r(),e("p",{class:"text-sm text-muted-foreground"},"مدیریت کدهای تخفیف خود")],-1)),t[19]||(t[19]=r()),e("div",q,[b(d).isLoading?x("",!0):(n(),l("div",G,[e("div",H,[t[6]||(t[6]=e("p",{class:"text-xs text-muted-foreground mb-1"},"فعال",-1)),t[7]||(t[7]=r()),e("p",J,i(_.value),1)]),t[12]||(t[12]=r()),t[13]||(t[13]=e("div",{class:"w-px h-8 bg-border"},null,-1)),t[14]||(t[14]=r()),e("div",K,[t[8]||(t[8]=e("p",{class:"text-xs text-muted-foreground mb-1"},"استفاده شده",-1)),t[9]||(t[9]=r()),e("p",U,i(h.value),1)]),t[15]||(t[15]=r()),t[16]||(t[16]=e("div",{class:"w-px h-8 bg-border"},null,-1)),t[17]||(t[17]=r()),e("div",W,[t[10]||(t[10]=e("p",{class:"text-xs text-muted-foreground mb-1"},"منقضی",-1)),t[11]||(t[11]=r()),e("p",X,i(N.value),1)])]))])])])]),t[49]||(t[49]=r()),e("div",Z,[e("div",tt,[b(d).isLoading?(n(),l("div",et,[t[20]||(t[20]=e("div",{class:"bg-muted rounded-2xl p-6 h-32"},null,-1)),t[21]||(t[21]=r()),e("div",st,[(n(),l(v,null,y(4,s=>e("div",{key:s,class:"bg-card border border-border p-4 rounded-xl h-32"})),64))])])):(n(),l("div",rt,[e("div",ot,[e("div",lt,[(n(),l(v,null,y(j,s=>e("button",{key:s.value,onClick:g=>p.value=s.value,class:u(["flex-shrink-0 px-4 py-2.5 rounded-xl text-sm font-medium transition-all",p.value===s.value?"bg-primary text-primary-foreground shadow-sm":"bg-muted text-muted-foreground hover:bg-muted/80"])},i(s.label),11,nt)),64))])]),t[47]||(t[47]=r()),e("div",it,[w.value.length===0?(n(),l("div",dt,[...t[22]||(t[22]=[e("i",{class:"ti ti-discount-off text-muted-foreground text-4xl mb-4"},null,-1),r(),e("h4",{class:"font-medium text-foreground mb-2"},"هیچ تخفیفی یافت نشد",-1),r(),e("p",{class:"text-sm text-muted-foreground"},"در این دسته تخفیفی موجود نیست",-1)])])):(n(!0),l(v,{key:1},y(w.value,s=>(n(),l("div",{key:s.id,class:u(["bg-card border border-border rounded-xl transition-all flex flex-col overflow-hidden",s.status==="active"?"cursor-pointer hover:shadow-lg hover:border-primary/30":"opacity-60"]),onClick:g=>s.status==="active"?S(s.id):null},[s.banner?(n(),l("div",ut,[e("img",{src:s.banner,alt:s.title,class:"w-full h-full object-cover"},null,8,xt),t[24]||(t[24]=r()),t[25]||(t[25]=e("div",{class:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"},null,-1)),t[26]||(t[26]=r()),e("div",pt,[t[23]||(t[23]=e("i",{class:"ti ti-discount text-sm"},null,-1)),r(" "+i(s.value)+i(s.type==="percentage"?"%":" ریال"),1)]),t[27]||(t[27]=r()),e("span",{class:u(["absolute top-3 left-3 text-xs px-2.5 py-1 rounded-full font-medium backdrop-blur-sm",k(s.status)])},i(D(s.status)),3)])):x("",!0),t[46]||(t[46]=r()),e("div",mt,[e("div",gt,[e("div",ft,[e("div",bt,[e("h4",vt,i(s.title),1),t[28]||(t[28]=r()),s.banner?x("",!0):(n(),l("span",{key:0,class:u(["text-xs px-2.5 py-1 rounded-full font-medium",k(s.status)])},i(D(s.status)),3))]),t[35]||(t[35]=r()),e("p",yt,i(s.description),1),t[36]||(t[36]=r()),s.status==="active"&&m(s.expiryDate)<=7&&m(s.expiryDate)>0?(n(),l("div",ct,[e("div",wt,[t[29]||(t[29]=e("span",{class:"text-xs text-muted-foreground"},"زمان باقی‌مانده",-1)),t[30]||(t[30]=r()),e("span",kt,i(m(s.expiryDate))+` روز\r
                    `,1)]),t[31]||(t[31]=r()),e("div",Dt,[e("div",{class:"bg-primary h-2 rounded-full transition-all duration-300",style:F({width:`${$(s.expiryDate)}%`})},null,4)])])):x("",!0),t[37]||(t[37]=r()),e("div",Ct,[s.banner?x("",!0):(n(),l("span",Tt,[t[32]||(t[32]=e("i",{class:"ti ti-percentage"},null,-1)),r(" "+i(s.value)+i(s.type==="percentage"?"%":" ریال"),1)])),t[34]||(t[34]=r()),e("span",jt,[t[33]||(t[33]=e("i",{class:"ti ti-calendar"},null,-1)),r(" "+i(R(s.expiryDate)),1)])])]),t[38]||(t[38]=r()),e("div",_t,[s.image?(n(),l("img",{key:0,src:s.image,alt:s.title,class:"w-full h-full object-cover"},null,8,ht)):(n(),l("i",Nt))])]),t[45]||(t[45]=r()),e("div",Rt,[s.status==="active"?(n(),l("button",{key:0,onClick:L(g=>M(s.code),["stop"]),disabled:a.value===s.code,class:u(["w-full flex items-center justify-center gap-2 text-sm py-2.5 px-4 rounded-lg font-medium transition-all",a.value===s.code?"bg-green-500/10 text-green-500 border border-green-500/20":"bg-primary text-primary-foreground hover:opacity-90 hover:shadow-md"])},[e("i",{class:u([a.value===s.code?"ti ti-check":"ti ti-copy","text-base"])},null,2),t[41]||(t[41]=r()),a.value===s.code?(n(),l("span",Mt,`\r
                  کپی شد!\r
                `)):(n(),l("span",St,[e("span",zt,i(s.code),1),t[39]||(t[39]=r()),t[40]||(t[40]=e("span",{class:"mr-1"},"کپی کد",-1))]))],10,$t)):(n(),l("div",Bt,[t[42]||(t[42]=e("i",{class:"ti ti-copy text-base opacity-50"},null,-1)),t[43]||(t[43]=r()),e("span",Ft,i(s.code),1),t[44]||(t[44]=r()),e("span",Lt,i(s.status==="expired"?"(منقضی)":"(استفاده شده)"),1)]))])])],10,at))),128))])]))])])]))}});export{At as default};
